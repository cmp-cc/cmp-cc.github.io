<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="I am cmp-cc" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="I am cmp-cc">
<meta property="og:url" content="http://cmp-cc.github.io/page/6/index.html">
<meta property="og:site_name" content="I am cmp-cc">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="I am cmp-cc">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> I am cmp-cc </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?0fb6f1a75a76726c10a144a8257465e3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">I am cmp-cc</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">一直在打杂，从未被超越。</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/04/01/2014/MyBatis 入门/" itemprop="url">
                  MyBatis 入门
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-04-01T23:44:00+08:00" content="2014-04-01">
              2014-04-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-Web/" itemprop="url" rel="index">
                    <span itemprop="name">Java Web</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-Web/MyBatis/" itemprop="url" rel="index">
                    <span itemprop="name">MyBatis</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/04/01/2014/MyBatis 入门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/04/01/2014/MyBatis 入门/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Hibernate 太过于庞大，作为同样的持久化ORM 框架Mybatis 就显得非常小巧灵活。</p>
<p>MyBatis 同样是简单易用的。</p>
<p>Java数据库持久化层主要两个部分：</p>
<ul>
<li>将从数据库查询到的数据生成所需要的 Java 对象</li>
<li>将 Java 对象中的数据通过 SQL 持久化到数据库中。</li>
</ul>
<h2 id="为什么-选择MyBatis"><a href="#为什么-选择MyBatis" class="headerlink" title="为什么 选择MyBatis ?"></a>为什么 选择MyBatis ?</h2><h3 id="消除大量JDBC冗余代码"><a href="#消除大量JDBC冗余代码" class="headerlink" title="消除大量JDBC冗余代码"></a>消除大量JDBC冗余代码</h3><ul>
<li>无需关注重复性JDBC操作 (不再与connection，statement，resultSet 重复性对象打交道)，MyBatis 会处理这些底层工作<blockquote>
<p>创建 Connection 连接，创建一个 Statement 对象，设置输入参数，关闭资源</p>
</blockquote>
</li>
<li>需要配置数据库连接属性和 SQL 语句。 （POJO &lt;–&gt; SQL Table）<ul>
<li>Mybatis 准备需要被执行的 SQL statement 对象并且将 Java 对象作为输入数据传递给 statement 对象的任务</li>
<li>MyBatis 自动化了将从输入的 Java 对象中的属性设置成查询参数、从 SQL 结果集上生成 Java 对象</li>
</ul>
</li>
</ul>
<p><strong>实例说明</strong><br><strong>1. 在 SQL Mapper 映射配置文件中配置 SQL 语句，假定为 StudentMapper.xml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;int&quot; resultType=&quot;Student&quot;&gt;</span><br><span class="line">     SELECT STUD_ID AS studId, NAME, EMAIL, DOB FROM STUDENTS WHERE STUD_ID=#&#123;Id&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">     INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,DOB) VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;dob&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>
<p><strong>2. 创建一个 StudentMapper 接口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface StudentMapper &#123;</span><br><span class="line">           Student findStudentById(Integer id);</span><br><span class="line">           void insertStudent(Student student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>3. 在 Java 代码中，你可以使用如下代码触发 SQL 语句：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = getSqlSessionFactory().openSession();</span><br><span class="line">StudentMapper mapper = session.getMapper(StudentMapper.class);</span><br><span class="line"><span class="comment">// Select Student by Id</span></span><br><span class="line">Student student = mapper.selectStudentById(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//To insert a Student record</span></span><br><span class="line">mapper.insertStudent(student);</span><br></pre></td></tr></table></figure>
<p><strong>编码完成</strong></p>
<h3 id="低学习曲线"><a href="#低学习曲线" class="headerlink" title="低学习曲线"></a>低学习曲线</h3><p><strong>你需要熟悉Java 和 SQL 即可</strong></p>
<h3 id="能够很好地与传统数据库协同工作"><a href="#能够很好地与传统数据库协同工作" class="headerlink" title="能够很好地与传统数据库协同工作"></a>能够很好地与传统数据库协同工作</h3><p>Hibernate将 Java 对象静态地映射到数据库的表上<br>MyBatis 是将查询的结果与 Java 对象映射起来。你可以根据面相对象的模型创建 Java 域对象，执行传统数据库的查询，然后将结果映射到对应的 Java 对象上。</p>
<h3 id="接受-SQL"><a href="#接受-SQL" class="headerlink" title="接受 SQL"></a>接受 SQL</h3><p>Hibernate鼓励使用实体对象（Entity Objects）和在其底层自动产生 SQL 语句。这种<br>的 SQL 生成方式，我们有可能不能够利用到数据库的一些特有的特性。Hibernate 允许执行本地 SQL，但是这样会打破持<br>久层和数据库独立的原则。</p>
<p>MyBatis 框架接受 SQL 语句，而不是将其对开发人员隐藏起来。由于 MyBatis 不会产生任何的 SQL 语句，所以开发<br>人员就要准备 SQL 语句，这样就可以充分利用数据库特有的特性并且可以准备自定义的查询。另外，MyBatis 对存储过程<br>也提供了支持。</p>
<h3 id="与Spring-集成"><a href="#与Spring-集成" class="headerlink" title="与Spring 集成"></a>与Spring 集成</h3><p>MyBatis 提供了与 流行的依赖注入框架 Spring 和 Guice 的开包即用的集成支持，这将进一步简化 MyBatis 的使用</p>
<h3 id="与第三方缓存类库的集成支持"><a href="#与第三方缓存类库的集成支持" class="headerlink" title="与第三方缓存类库的集成支持"></a>与第三方缓存类库的集成支持</h3><p>MyBatis 有内建的 SqlSession 级别的缓存机制，用于缓存 Select 语句查询出来的结果。除此之外，MyBatis 提供<br>了与多种第三方缓存类库的集成支持，如 EHCache，OSCache，Hazelcast。</p>
<h3 id="良好的性能"><a href="#良好的性能" class="headerlink" title="良好的性能"></a>良好的性能</h3><ul>
<li>MyBatis 支持数据库连接池，消除了为每一个请求创建一个数据库连接的开销</li>
<li>MyBatis 提供了内建的缓存机制，在 SqlSession 级别提供了对 SQL 查询结果的缓存。即:如果你调用了相同的select 查询，MyBatis会将放在缓存的结果返回，而不会去再查询数据库。</li>
<li>MyBatis 框架并没有大量地使用代理机制2，因此对于其他的过度地使用代理的 ORM 框架而言，MyBatis 可以获得更<br>好的性能。</li>
</ul>
<p><strong>如果你的应用是以面向对象模型，并且向动态生成 SQL 语句，那么 MyBatis可能就不符合你的要求。另外，如果你想让你的应用有一个传递性的缓存机制的话（保存父对象时也应该保存关联的子对象），Hibernate 会更适合你。</strong></p>
<h2 id="Mybatis-入门"><a href="#Mybatis-入门" class="headerlink" title="Mybatis 入门"></a>Mybatis 入门</h2><ul>
<li>Mybatis 入门   <ul>
<li>新建表 STUDENTS，插入样本数据</li>
<li>新建一个 Maven 项目，pom.xml 添加相关依赖</li>
<li>新建建 MyBatisSqlSessionFactory 单例模式类</li>
<li>新建映射器 StudentMapper 接口和 StudentService 类</li>
<li>新建一个 JUnit 测试类来测试 StudentService</li>
</ul>
</li>
</ul>
<h3 id="新建表-STUDENTS，插入样本数据"><a href="#新建表-STUDENTS，插入样本数据" class="headerlink" title="新建表 STUDENTS，插入样本数据"></a>新建表 STUDENTS，插入样本数据</h3><p><strong>使用以下 SQL 脚本往 MySQL 数据库中创建 STUDENTS 表插入样本数据：</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> STUDENTS</span><br><span class="line">(</span><br><span class="line">stud_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">email <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">dob <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (stud_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=latin1;</span><br><span class="line"><span class="comment">/*Sample Data for the students table */</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stud_id,<span class="keyword">name</span>,email,dob)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>,<span class="string">'Student1'</span>,<span class="string">'student1@gmail.com'</span>,<span class="string">'1983-06-25'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stud_id,<span class="keyword">name</span>,email,dob)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">2</span>,<span class="string">'Student2'</span>,<span class="string">'student2@gmail.com'</span>,<span class="string">'1983-06-25'</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="新建一个-Maven-项目，pom-xml-添加相关依赖"><a href="#新建一个-Maven-项目，pom-xml-添加相关依赖" class="headerlink" title="新建一个 Maven 项目，pom.xml 添加相关依赖"></a>新建一个 Maven 项目，pom.xml 添加相关依赖</h3><ul>
<li>创建一个名为 mybatis-demo的Maven 项目</li>
<li><p>在 pom.xml 中添加以下依赖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;3.2.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;5.1.30&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.7.5&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.7.5&lt;/version&gt;</span><br><span class="line">	&lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.2.17&lt;/version&gt;</span><br><span class="line">	&lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;4.11&lt;/version&gt;</span><br><span class="line">	&lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 log4j.properties 文件，添加到 <code>src/main/resources</code> (classpath下) 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d [%-5p] %c - %m%n</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="新建-mybatis-config-xml-和映射器-StudentMapper-xml-配置文件"><a href="#新建-mybatis-config-xml-和映射器-StudentMapper-xml-配置文件" class="headerlink" title="新建 mybatis-config.xml 和映射器 StudentMapper.xml 配置文件"></a>新建 mybatis-config.xml 和映射器 StudentMapper.xml 配置文件</h3><ul>
<li><p><strong><code>mybatis-config.xml</code> 为MyBatis的主要配置文件，其中包括数据库连接信息、类型别名等,创建并添加classpath下</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">	&lt;typeAliases&gt;</span><br><span class="line">		&lt;typeAlias alias=&quot;Student&quot; type=&quot;org.freecode.domain.Student&quot; /&gt;</span><br><span class="line">	&lt;/typeAliases&gt;</span><br><span class="line">	&lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">		&lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">			&lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">			&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">				&lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;password&quot; value=&quot;123456&quot; /&gt;</span><br><span class="line">			&lt;/dataSource&gt;</span><br><span class="line">		&lt;/environment&gt;</span><br><span class="line">	&lt;/environments&gt;</span><br><span class="line">	&lt;mappers&gt;</span><br><span class="line">		&lt;mapper resource=&quot;or/freecode/mappers/StudentMapper.xml&quot; /&gt;</span><br><span class="line">	&lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><code>StudentMapper.xml</code> 实体映射SQL语句文件，并将其放入自定义mapper目录下。（org.freecode.mappers）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;org.freecode.mappers.StudentMapper&quot;&gt;</span><br><span class="line">	&lt;resultMap type=&quot;Student&quot; id=&quot;StudentResult&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;dob&quot; column=&quot;dob&quot; /&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">	&lt;select id=&quot;findAllStudents&quot; resultMap=&quot;StudentResult&quot;&gt;</span><br><span class="line">		SELECT * FROM STUDENTS</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;select id=&quot;findStudentById&quot; parameterType=&quot;int&quot; resultType=&quot;Student&quot;&gt;</span><br><span class="line">		SELECT STUD_ID AS STUDID, NAME, EMAIL, DOB</span><br><span class="line">		FROM STUDENTS WHERE STUD_ID=#&#123;Id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">		INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,DOB)</span><br><span class="line">		VALUES(#&#123;studId &#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;dob&#125;)</span><br><span class="line">	&lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="新建-MyBatisSqlSessionFactory-单例类"><a href="#新建-MyBatisSqlSessionFactory-单例类" class="headerlink" title="新建 MyBatisSqlSessionFactory 单例类"></a>新建 MyBatisSqlSessionFactory 单例类</h3><p><strong>新建 MyBatisSqlSessionFactory.java 类文件，实例化它，使其持有一个 SqlSessionFactory 单例对象：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.util;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line">public class MyBatisSqlSessionFactory &#123;</span><br><span class="line"></span><br><span class="line">	private static SqlSessionFactory sqlSessionFactory;</span><br><span class="line">	public static SqlSessionFactory getSqlSessionFactory()&#123;</span><br><span class="line">		if(sqlSessionFactory == null)&#123;</span><br><span class="line">			InputStream inputStream;</span><br><span class="line">			try&#123;</span><br><span class="line">				inputStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">				</span><br><span class="line">				sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">			&#125;catch(IOException e)&#123;</span><br><span class="line">				throw new RuntimeException(e.getCause());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return sqlSessionFactory;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public static SqlSession openSession()&#123;</span><br><span class="line">		return getSqlSessionFactory().openSession();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>上述的代码段中，我们创建了一个 SqlSessionFactory 对象，我们将使用它来获得 SqlSession 对象和执行映射的SQL 语句。</strong></p>
<h3 id="新建-StudentMapper-接口和-StudentService-类"><a href="#新建-StudentMapper-接口和-StudentService-类" class="headerlink" title="新建 StudentMapper 接口和 StudentService 类"></a>新建 StudentMapper 接口和 StudentService 类</h3><p>让我们创建一个 StudentMapper 接口，其定义的方法名和在 Mapper XML 配置文件定义的 SQL 映射语句名称相同；<br>在创建一个 StudentService.java 类，包含了一些业务操作的实现。</p>
<ul>
<li><p>首先，创建JavaBean Student.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.domain;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">public class Student &#123;</span><br><span class="line">	private Integer studId;</span><br><span class="line">	private String name;</span><br><span class="line">	private String email;</span><br><span class="line">	private Date dob;</span><br><span class="line">	public Integer getStudId() &#123;</span><br><span class="line">		return studId;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setStudId(Integer studId) &#123;</span><br><span class="line">		this.studId = studId;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getName() &#123;</span><br><span class="line">		return name;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setName(String name) &#123;</span><br><span class="line">		this.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getEmail() &#123;</span><br><span class="line">		return email;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setEmail(String email) &#123;</span><br><span class="line">		this.email = email;</span><br><span class="line">	&#125;</span><br><span class="line">	public Date getDob() &#123;</span><br><span class="line">		return dob;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setDob(Date dob) &#123;</span><br><span class="line">		this.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return &quot;Student [studId=&quot; + studId + &quot;, name=&quot; + name + &quot;, email=&quot;</span><br><span class="line">				+ email + &quot;, dob=&quot; + dob + &quot;]&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建映射器 Mapper 接口 StudentMapper.java 其方法签名和 StudentMapper.xml 中定义的 SQL 映射定义名相同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.mappers;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line">import org.freecode.domain.Student;</span><br><span class="line"></span><br><span class="line">public interface StudentMapper &#123;</span><br><span class="line">	List&lt;Student&gt; findAllStudents();</span><br><span class="line">	Student findStudentById(Integer id);</span><br><span class="line">	void insertStudent(Student student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 StudentService.java 实现对表 STUDENTS 的数据库操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.services;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.freecode.domain.Student;</span><br><span class="line">import org.freecode.mappers.StudentMapper;</span><br><span class="line">import org.freecode.util.MyBatisSqlSessionFactory;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class StudentService &#123;</span><br><span class="line">	private Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line">	</span><br><span class="line">	public List&lt;Student&gt; findAllStudents()&#123;</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		try&#123;</span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			return studentMapper.findAllStudents();</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			// 如果sqlSession 没有关闭， 数据库连接不会返回到连接池(pool)中</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public Student findStudentById(Integer studId)&#123;</span><br><span class="line">		logger.debug(&quot;Select Student By ID :&#123;&#125;&quot;,studId);</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		try&#123;</span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			return studentMapper.findStudentById(studId);</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public void createStudent(Student student)&#123;</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		try&#123;</span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			studentMapper.insertStudent(student);</span><br><span class="line">			sqlSession.commit();</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/**</span><br><span class="line">	 * 你也可以不通过Mapper接口执行映射的SQL语句,如下。（并不推荐）</span><br><span class="line">	 * @param studId</span><br><span class="line">	 * @return</span><br><span class="line">	 */</span><br><span class="line">	public Student findStudentById2(Integer studId)&#123;</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		try&#123;</span><br><span class="line">			return (Student)sqlSession.selectOne(&quot;org.freecode.mappers.StudentMapper.findStudentById&quot;,studId);</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="新建一个-JUnit-测试类来测试-StudentService"><a href="#新建一个-JUnit-测试类来测试-StudentService" class="headerlink" title="新建一个 JUnit 测试类来测试 StudentService"></a>新建一个 JUnit 测试类来测试 StudentService</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.services;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.freecode.domain.Student;</span><br><span class="line">import org.junit.AfterClass;</span><br><span class="line">import org.junit.Assert;</span><br><span class="line">import org.junit.BeforeClass;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">public class StudentServiceTest &#123;</span><br><span class="line"></span><br><span class="line">	private static StudentService studentService;</span><br><span class="line">	</span><br><span class="line">	@BeforeClass</span><br><span class="line">	public static void setup()&#123;</span><br><span class="line">		studentService = new StudentService();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@AfterClass</span><br><span class="line">	public static void teardown()&#123;</span><br><span class="line">		studentService = null;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testFindAllStudents()&#123;</span><br><span class="line">		List&lt;Student&gt; students = studentService.findAllStudents();</span><br><span class="line">		Assert.assertNotNull(students);</span><br><span class="line">		for (Student student : students)&#123;</span><br><span class="line">			System.out.println(student);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testFindStudentById()&#123;</span><br><span class="line">		Student student = studentService.findStudentById(3);</span><br><span class="line">		Assert.assertNotNull(student);</span><br><span class="line">		System.out.println(student);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testCreateStudent()&#123;</span><br><span class="line">		Student student = new Student();</span><br><span class="line">		int id = 3;</span><br><span class="line">		student.setStudId(id);</span><br><span class="line">		student.setName(&quot;student_&quot; + id);</span><br><span class="line">		student.setEmail(&quot;student_&quot; + id + &quot;gmail.com&quot;);</span><br><span class="line">		student.setDob(new Date());</span><br><span class="line">		studentService.createStudent(student);</span><br><span class="line">		Student newStudent = studentService.findStudentById(id);</span><br><span class="line">		Assert.assertNotNull(newStudent);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="它是怎么工作的？"><a href="#它是怎么工作的？" class="headerlink" title="它是怎么工作的？"></a>它是怎么工作的？</h3><ul>
<li>首先，我们配置了 MyBatis 最主要的配置文件-mybatis-config.xml,里面包含了 JDBC 连接参数；配置了映射器Mapper XML 配置文件文件，里面包含了 SQL 语句的映射。</li>
<li>我 们 使 用 mybatis-config.xml 内 的 信 息 创 建 了 SqlSessionFactory 对 象 。 每 个 数 据 库 环 境 应 该 就 一 个SqlSessionFactory 对象实例，所以我们使用了单例模式只创建一个 SqlSessionFactory 实例。</li>
<li>我们创建了一个映射器 Mapper 接口-StudentMapper，其定义的方法签名和在 StudentMapper.xml 中定义的完全一样（即映射器 Mapper 接口中的方法名跟 StudentMapper.xml 中的 id 的值相同）。注意 StudentMapper.xml 中namespace 的值被设置成 org.freecode.mappers.StudentMapper，是 StudentMapper 接口的完全限定名。这使我们可以使用接口来调用映射的 SQL 语句。</li>
<li>在 StudentService.java 中，我们在每一个方法中创建了一个新的 SqlSession，并在方法功能完成后关闭SqlSession。每一个线程应该有它自己的 SqlSession 实例。SqlSession 对象实例不是线程安全的，并且不被共享。所以 SqlSession 的作用域最好就是其所在方法的作用域。从 Web 应用程序角度上看，SqlSession 应该存在于 request 级别作用域上。</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/03/11/2014/Git 遇到的异常/" itemprop="url">
                  Git 遇到的异常
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-03-11T22:53:00+08:00" content="2014-03-11">
              2014-03-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Version-Control/" itemprop="url" rel="index">
                    <span itemprop="name">Version Control</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Version-Control/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/03/11/2014/Git 遇到的异常/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/03/11/2014/Git 遇到的异常/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>更新于 ：2015-12-14 17:50:00</strong></p>
<p><strong>总结 在使用Git 进行版本控制遇到错误及其相关解决方案，并持续更新</strong></p>
<h2 id="1-Everything-is-update"><a href="#1-Everything-is-update" class="headerlink" title="1.Everything is update"></a>1.Everything is update</h2><h3 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>git push origin master 的时候出现Everything is update</strong></p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>使用git commit -am “xxxx”</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git commit -am &quot;modify of part&quot;</span><br><span class="line">git origin master</span><br></pre></td></tr></table></figure></p>
<h2 id="2-Note-about-fast-forwards-rejected"><a href="#2-Note-about-fast-forwards-rejected" class="headerlink" title="2.Note about fast-forwards (! [rejected])"></a>2.Note about fast-forwards (! [rejected])</h2><h3 id="错误信息-1"><a href="#错误信息-1" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin hexo</span><br><span class="line">To git@github.com:cmp-cc/cmp-cc.github.io.git</span><br><span class="line"> ! [rejected]        hexo -&gt; hexo (fetch first)</span><br><span class="line">error: failed to push some refs to &apos;git@github.com:cmp-cc/cmp-cc.github.io.git&apos;</span><br><span class="line">hint: Updates were rejected because the remote contains work that you do</span><br><span class="line">hint: not have locally. This is usually caused by another repository pushing</span><br><span class="line">hint: to the same ref. You may want to first integrate the remote changes</span><br><span class="line">hint: (e.g., &apos;git pull ...&apos;) before pushing again.</span><br><span class="line">hint: See the &apos;Note about fast-forwards&apos; in &apos;git push --help&apos; for details.</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>一、使用强制push的方法 （不推荐）：</strong><br>这样会使远程修改丢失，一般是不可取的，尤其是多人协作开发的时候，单人协助无所谓。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master -f</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>二、老老实实的merge 分支。（推荐）</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git pull origin master</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>三、使用<code>git pull --rebase</code> 将本地与远程进行同步（等价于第二种）</strong><br><strong><code>git push --rebase</code> 的含义</strong></p>
<ul>
<li>把本地 repo. 从上次 pull 之后的变更暂存起來</li>
<li>恢复到上次 pull 时的状态</li>
<li>合并远端的变更到本地</li>
<li>最后再合并刚刚暂存下來的本地变更</li>
</ul>
<h2 id="3-push之后不能访问文件-文件状态为灰色"><a href="#3-push之后不能访问文件-文件状态为灰色" class="headerlink" title="3.push之后不能访问文件(文件状态为灰色)"></a>3.push之后不能访问文件(文件状态为灰色)</h2><h3 id="错误信息-2"><a href="#错误信息-2" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>如下，处于不可打开状态，如果你把整个项目clone下来，你会发现文件为空</strong></p>
<img src="/2014/03/11/2014/Git%20遇到的异常/4D44727A1CED48A6AF27443A6F1A36D7.png" alt="文件显示状态" title="文件显示状态">
<h3 id="解决方案-2"><a href="#解决方案-2" class="headerlink" title="解决方案"></a>解决方案</h3><p>你可能需要了解一下<code>git submodule</code>的使用,就知道问题所在了。(git项目中的子目录存在一个git仓库)</p>
<ul>
<li>将子目录中的<code>.git</code>目录删掉</li>
<li>删除子模块子目录</li>
<li>再执行<code>git push</code> 操作<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached ./themes/next</span><br><span class="line">git add --all</span><br><span class="line">git commit -m &quot;delete child module&quot;</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>可参考：<a href="http://stackoverflow.com/questions/19584255/what-does-a-grey-icon-in-remote-github-mean" target="_blank" rel="external">http://stackoverflow.com/questions/19584255/what-does-a-grey-icon-in-remote-github-mean</a></p>
<h2 id="pull没有更新（-See-git-pull-1-for-details-）"><a href="#pull没有更新（-See-git-pull-1-for-details-）" class="headerlink" title="pull没有更新（ See git-pull(1) for details ）"></a>pull没有更新（ See git-pull(1) for details ）</h2><h3 id="错误信息-3"><a href="#错误信息-3" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>这个算不上错误，问题是这样的：你有两个分支A 和 B。当前分支为B，你执行git pull 操作，他却pull了A而不是B</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ git pull</span><br><span class="line">remote: Counting objects: 174, done.</span><br><span class="line">remote: Compressing objects: 100% (95/95), done.</span><br><span class="line">remote: Total 174 (delta 61), reused 0 (delta 0), pack-reused 0</span><br><span class="line">Receiving objects: 100% (174/174), 251.93 KiB | 206.00 KiB/s, done.</span><br><span class="line">Resolving deltas: 100% (61/61), done.</span><br><span class="line">   69cc25b..1b24763  master     -&gt; origin/master</span><br><span class="line">There is no tracking information for the current branch.</span><br><span class="line">Please specify which branch you want to merge with.</span><br><span class="line">See git-pull(1) for details</span><br><span class="line"></span><br><span class="line">    git pull &lt;remote&gt; &lt;branch&gt;</span><br><span class="line"></span><br><span class="line">If you wish to set tracking information for this branch you can do so with:</span><br><span class="line"></span><br><span class="line">    git branch --set-upstream-to=origin/&lt;branch&gt; stream</span><br></pre></td></tr></table></figure></p>
<h3 id="解决方案-3"><a href="#解决方案-3" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>进行本地分支和远程分支关联</strong><br><code>git branch --set-upstream-to=origin/&lt;branch&gt; master</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch --set-upstream-to=origin/stream stream</span><br></pre></td></tr></table></figure></p>
<p>参考：<a href="http://www.tbdazhe.com/archives/238" target="_blank" rel="external">http://www.tbdazhe.com/archives/238</a></p>
<h2 id="Unlink-of-file-‘xxx’-failed-Should-I-try-again"><a href="#Unlink-of-file-‘xxx’-failed-Should-I-try-again" class="headerlink" title="Unlink of file ‘xxx’ failed. Should I try again?"></a>Unlink of file ‘xxx’ failed. Should I try again?</h2><h3 id="错误信息-4"><a href="#错误信息-4" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error: refusing to lose untracked file at &apos;stream/next/bower.json&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/_config.yml&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/README.md&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.jshintrc&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.javascript_ignore&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.hound.yml&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.gitignore&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.editorconfig&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.bowerrc&apos;</span><br><span class="line">Unlink of file &apos;stream/next&apos; failed. Should I try again? (y/n)</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-4"><a href="#解决方案-4" class="headerlink" title="解决方案"></a>解决方案</h3><p>出现这种问题，通常意味这有一个进程仍在使用特定的文件，急需要关闭其它程序，然后在尝试执行<code>git pull</code></p>
<p>参考：<a href="http://stackoverflow.com/questions/10181057/unlink-of-file-failed" target="_blank" rel="external">http://stackoverflow.com/questions/10181057/unlink-of-file-failed</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/12/2014/Spring 实例教程/" itemprop="url">
                  Spring 实例教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-01-12T13:53:00+08:00" content="2014-01-12">
              2014-01-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaWeb/" itemprop="url" rel="index">
                    <span itemprop="name">JavaWeb</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaWeb/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/01/12/2014/Spring 实例教程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/12/2014/Spring 实例教程/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="构建Spring-环境"><a href="#构建Spring-环境" class="headerlink" title="构建Spring 环境"></a>构建Spring 环境</h2><ul>
<li>引入依赖<ul>
<li>下载Spring，引入dist目录下所有Jar，附加commons-logging.jar 。</li>
<li>或者，使用Maven构建项目,如下<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  &lt;dependencies&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.2.5.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>spring-context 会将Spring 其他相关依赖引入</p>
<ul>
<li>创建beans.xml ,并引入相关的Shema<br><strong>不限定名称，也可以为:ApplicationContext.xml</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">  xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">  xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">  xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line">         http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span><br><span class="line">         http://www.springframework.org/schema/context</span><br><span class="line">         http://www.springframework.org/schema/context/spring-context-3.0.xsd</span><br><span class="line">         http://www.springframework.org/schema/aop</span><br><span class="line">         http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span><br><span class="line">         http://www.springframework.org/schema/tx </span><br><span class="line">         http://www.springframework.org/schema/tx/spring-tx-3.0.xsd&quot;&gt;</span><br><span class="line">&lt;/beas&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>一般情况下，Shema去官方文档里找（但是，如果你使用STS工具，可以直接创建Spring 配置文件。），如上是一个全貌，对于新的版本可能过时了。<br>如果你只使用Spring Bean 容器，你可能只需要引入<code>spring-beans-3.0.xsd</code></p>
</blockquote>
<ul>
<li><p>演示配置Bean 对象</p>
<ul>
<li><p>创建相关对象(如下一个Helloworl对象)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.model;</span><br><span class="line">public class HelloWorld &#123;</span><br><span class="line">    public String hello()&#123;</span><br><span class="line">    return &quot;HelloWorld !!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>beans.xml 配置Bean</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;hellWorld&quot; class=&quot;org.freecode.spring.model.HelloWorld&quot;&gt;&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如上Bean 对象，实际等同于<code>HelloWorld hellWorld = new HelloWorld()</code><br>只是创建于Spring Bean容器中，也就是说HelloWorld对象交给Spring进行管理。</p>
</blockquote>
</li>
<li><p>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.model;</span><br><span class="line"></span><br><span class="line">import org.junit.Test;</span><br><span class="line">import org.springframework.beans.factory.BeanFactory;</span><br><span class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line">public class HelloWorldTest &#123;</span><br><span class="line"></span><br><span class="line">    //1、创建Spring Bean 工厂 (Bean 容器)</span><br><span class="line">    private BeanFactory factory = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);</span><br><span class="line">    @Test</span><br><span class="line">    public void testHello() &#123;</span><br><span class="line">   </span><br><span class="line">      //2、通过Bean 工厂 获取相应的类对象</span><br><span class="line">      //getBean() 方法可以接受bean的id 或这对象class。 (都可以获取HelloWorld 对象)</span><br><span class="line">      HelloWorld helloWorld = factory.getBean(HelloWorld.class);</span><br><span class="line">      System.out.println(helloWorld.hello());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="ICO"><a href="#ICO" class="headerlink" title="ICO"></a>ICO</h2><p>ICO【依赖注入、控制反转】，使用ICO有两个步骤。</p>
<ul>
<li>1、<code>beans.xml</code>配置相关依赖注入对象（只有交给Spring管理的对象才能进行依赖注入，如上环境测试中的Bean。）</li>
<li>2、对依赖的类完成注入（我们有如下多种注入方式）<ul>
<li>2.1、<code>setter</code> 方法注入。通过<code>property</code>元素注入（每一个依赖注入对象必须创建<code>getter</code>和<code>setter</code>方法）</li>
<li>2.2、构造方法注入。通过<code>constructor-arg</code>元素注入</li>
<li>2.3、自动注入 （自动装配）。通过<code>autowire</code> 属性完成注入</li>
</ul>
</li>
</ul>
<h3 id="IOC-XML-实例"><a href="#IOC-XML-实例" class="headerlink" title="IOC XML 实例"></a>IOC XML 实例</h3><p><strong>在一个Web 项目中Service 层一般会依赖于DAO层对象，我们使用ICO完成，来演示这个实例</strong></p>
<h4 id="通过setter方法注入"><a href="#通过setter方法注入" class="headerlink" title="通过setter方法注入"></a>通过<code>setter</code>方法注入</h4><p>通过IOC XML <code>property</code>属性实现注入（通过setter方法）</p>
<ul>
<li><p>Model</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.model;</span><br><span class="line"></span><br><span class="line">public class User &#123;</span><br><span class="line">  private String id;</span><br><span class="line">  private String name;</span><br><span class="line">  private String age;</span><br><span class="line">  public String getId() &#123;</span><br><span class="line">    return id;</span><br><span class="line">  &#125;</span><br><span class="line">  public void setId(String id) &#123;</span><br><span class="line">    this.id = id;</span><br><span class="line">  &#125;</span><br><span class="line">  public String getName() &#123;</span><br><span class="line">    return name;</span><br><span class="line">  &#125;</span><br><span class="line">  public void setName(String name) &#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  public String getAge() &#123;</span><br><span class="line">    return age;</span><br><span class="line">  &#125;</span><br><span class="line">  public void setAge(String age) &#123;</span><br><span class="line">    this.age = age;</span><br><span class="line">  &#125;</span><br><span class="line">  @Override</span><br><span class="line">  public String toString() &#123;</span><br><span class="line">    return &quot;User [id=&quot; + id + &quot;, name=&quot; + name + &quot;, age=&quot; + age + &quot;]&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>DAO</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.dao;</span><br><span class="line"></span><br><span class="line">import org.freecode.spring.model.User;</span><br><span class="line"></span><br><span class="line">public interface IUserDao &#123;</span><br><span class="line">  // 由于只是一个演示IOC,只有一个演示方法</span><br><span class="line">  public void addUser(User user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>DAO 接口实现类</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.dao;</span><br><span class="line">import org.freecode.spring.model.User;</span><br><span class="line">public class UserDao implements IUserDao &#123;</span><br><span class="line">    public void addUser(User user) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>Service<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.service;</span><br><span class="line">import org.freecode.spring.model.User;</span><br><span class="line">public interface IUserService &#123;</span><br><span class="line">    public void addUser(User user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>Service 接口实现类，注意：1、我们依赖的为DAO接口。2、并创建依赖类的<code>getter</code>和<code>setter</code>方法</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.service;</span><br><span class="line">import org.freecode.spring.dao.IUserDao;</span><br><span class="line">import org.freecode.spring.model.User;</span><br><span class="line">public class UserService implements IUserService&#123;</span><br><span class="line">    private IUserDao userDao;</span><br><span class="line">    </span><br><span class="line">    public IUserDao getUserDao() &#123;</span><br><span class="line">        return userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void setUserDao(IUserDao userDao) &#123;</span><br><span class="line">        this.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    public void addUser(User user) &#123;</span><br><span class="line">        userDao.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>配置bean.xml 文件，通过<code>property</code>属性注入相关依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;userDao&quot; class=&quot;org.freecode.spring.dao.UserDao&quot;&gt;&lt;/bean&gt;</span><br><span class="line">     </span><br><span class="line">     &lt;bean id=&quot;userService&quot; class=&quot;org.freecode.spring.service.UserService&quot;&gt;</span><br><span class="line">         &lt;!-- 这里会将UserDao注入到userService中。(这就是所谓的依赖注入) --&gt;</span><br><span class="line">         &lt;!-- 实际是通过userService中setter(IUserDao userDao)方法完成注入。(知道为什么写getter、setter方法了把) --&gt;</span><br><span class="line">         &lt;!-- name属性为要注入的set后缀名称(setUserDao),ref属性为要注入的bean的 id --&gt;</span><br><span class="line">         &lt;property name=&quot;userDao&quot; ref=&quot;userDao&quot;&gt;&lt;/property&gt;</span><br><span class="line">     &lt;/bean&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试类（测试IOC）<br><strong>测试通过Spring 为UserService 注入 UserDAO是否成功</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.model;</span><br><span class="line">import java.util.UUID;</span><br><span class="line">import org.freecode.spring.service.IUserService;</span><br><span class="line">import org.freecode.spring.service.UserService;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import org.springframework.beans.factory.BeanFactory;</span><br><span class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line">public class SpringTest &#123;</span><br><span class="line">    private BeanFactory factory = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);</span><br><span class="line">    </span><br><span class="line">    @Test</span><br><span class="line">    public void testIOC()&#123;</span><br><span class="line">        IUserService userService = factory.getBean(&quot;userService&quot;,UserService.class);</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setId(UUID.randomUUID().toString());</span><br><span class="line">        user.setName(&quot;天王盖地虎&quot;);</span><br><span class="line">        user.setAge(&quot;21&quot;);</span><br><span class="line">        userService.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>控制台打印如下：表示注入成功了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User [id=00621890-01cf-4573-8610-7d737936459c, name=天王盖地虎, age=21]</span><br></pre></td></tr></table></figure></p>
<h4 id="通过构造函数注入"><a href="#通过构造函数注入" class="headerlink" title="通过构造函数注入"></a>通过构造函数注入</h4><p><strong>如下，将该改为使用构造函数完成如上注入。</strong></p>
<ul>
<li><p>修改 UserService  (不需要<code>getter</code>、<code>setter</code>方法了，需要一个构造函数)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    private IUserDao userDao;</span><br><span class="line">    </span><br><span class="line">    public UserService(IUserDao userDao) &#123;</span><br><span class="line">        super();</span><br><span class="line">        this.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">/* //通过property 完成注入,实际是通过setter方法注入</span><br><span class="line">   public void setUserDao(IUserDao userDao) &#123;</span><br><span class="line">        this.userDao = userDao;</span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">   public IUserDao getUserDao() &#123;</span><br><span class="line">        return userDao;</span><br><span class="line">    &#125;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改beans.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 如下使用使用构造方法完成注入，不常用，一般情况还是使用setter实现注入 --&gt;</span><br><span class="line">     &lt;bean id=&quot;userService&quot; class=&quot;org.freecode.spring.service.UserService&quot;&gt;</span><br><span class="line">         &lt;constructor-arg ref=&quot;userDao&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">     &lt;/bean&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行测试方法<code>testIOC</code>，验证结果</p>
</li>
</ul>
<h4 id="自动注入（自动装配）"><a href="#自动注入（自动装配）" class="headerlink" title="自动注入（自动装配）"></a>自动注入（自动装配）</h4><ul>
<li><p>需要实现<code>setter</code>方法、而不是构造函数。（也就是说自动注入使用setter方法后名称来完成注入）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">略</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改beans.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// byName 根据Class中的setter属性名称查找beans.xml中id名称，完成注入</span><br><span class="line">&lt;bean id=&quot;userService&quot; class=&quot;org.freecode.spring.service.UserService&quot; autowire=&quot;byName&quot;&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行测试方法</p>
</li>
<li><p><code>autowire</code>属性值</p>
<ul>
<li><code>default</code><br><strong>由上级标签<beans>的<code>default-autowire</code>属性决定，bean元素默认值</beans></strong></li>
<li>byName<br><strong>通过属性的名字的方式查找JavaBean依赖的对象并为其注入</strong><blockquote>
<p>Spring IoC容器会在配置文件中查找对应的<code>id/name</code>属性,然后使用Setter方法将其注入</p>
</blockquote>
</li>
<li>byType （一般不使用）<br><strong>通过属性的类型查找JavaBean依赖的对象并为其注入。</strong><blockquote>
<p>注意： 有个两个要注入的对象，实现了同一个接口。这时，根据实现接口注入两个不同对象，就会报错，Spring不知道怎么注入二个多态对象。</p>
</blockquote>
</li>
<li>constructor<br><strong>通byType一样，也是通过类型查找依赖对象。与byType的区别在于它不是使用Seter方法注入，而是使用构造子注入</strong></li>
<li>no<br><strong>不启用自动装配，beans元素默认值</strong></li>
</ul>
</li>
</ul>
<p><strong>使用Spring XML 配置IOC 选择问题</strong></p>
<ul>
<li>1、开发中不建议使用<code>autowire</code>属性完成自动注入。<br><strong>原因：虽然他可以减少配置，但是beans文件无法直观了解类的整体面貌，所以不建议使用<code>autowire</code></strong></li>
<li>2、常规开发中一般使用<code>property</code>注入，而不是构造方法注入。</li>
</ul>
<h3 id="依赖注入属性实例"><a href="#依赖注入属性实例" class="headerlink" title="依赖注入属性实例"></a>依赖注入属性实例</h3><p><strong>上一个实例，通过<code>ref</code> 引用一个类，将其注入，如果是具体的值呢？   使用<code>value</code>属性，完成具体值注入</strong></p>
<ul>
<li><p>注入一个默认的 User Model 属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;ser&quot; class=&quot;org.freecode.spring.model.User&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;id&quot; value=&quot;1&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;生命宛如，静静相拥的河&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;age&quot; value=&quot;21&quot;&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testUser()&#123;</span><br><span class="line">    User user = factory.getBean(&quot;user&quot;,User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>ok，<code>User [id=1, name=生命宛如，静静相拥的河, age=21]</code></p>
</blockquote>
<ul>
<li>其他<ul>
<li>可以注入一个List对象、Set对象类，过于简单，就略了。</li>
</ul>
</li>
</ul>
<h3 id="基于Annotation的注入实例"><a href="#基于Annotation的注入实例" class="headerlink" title="基于Annotation的注入实例"></a>基于Annotation的注入实例</h3><p>上面两个实例都是通过XML实现注入，Spring3.0以后支持注解注入，如下演示基于Annotation注入。</p>
<ul>
<li><p>修改第一个实例XML配置，如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;</span><br><span class="line">    &lt;!-- 开启使用注解配置 --&gt;</span><br><span class="line">    &lt;context:annotation-config /&gt;</span><br><span class="line">    &lt;!-- 告诉Spring 去哪写包找注入Bean --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;org.freecode.srping&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/beans&gt;</span><br><span class="line">&gt; Shema 中引入了`spring-context`</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过<code>@component</code>注解将类交给Spring管理<br>class 类中声明<code>@Compent</code> 等价于在Beans.xml 配置当前Bean对象（<code>&lt;bean id=&quot;userDao&quot; class=&quot;org...UserDao&quot;&gt;</code>）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Component(&quot;userDao&quot;)  </span><br><span class="line">public class UserDao implements IUserDao &#123;</span><br><span class="line">    public void addUser(User user) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>依赖注入<code>UserDao</code>到<code>UserService</code><br><strong>有如下三个注解可以完成依赖注入</strong></p>
<ul>
<li><code>@Autowired</code>，我们很熟悉，由Spring提供，默认<code>通过类型注入</code>。</li>
<li><code>@Resource</code>,由J2EE提供，需要引入<code>javax.annotation.Resource</code>包，默认<code>通过名称注入</code></li>
<li><code>@Inject</code>，JSR330中提供,需要引入<code>Inject</code>jar。（等价于Resource）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.service;</span><br><span class="line">import javax.annotation.Resource;</span><br><span class="line">import org.freecode.spring.dao.IUserDao;</span><br><span class="line">import org.freecode.spring.model.User;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">@Component(&quot;userService&quot;)</span><br><span class="line">public class UserService implements IUserService&#123;</span><br><span class="line">  </span><br><span class="line">   private IUserDao userDao;</span><br><span class="line">   // 使用Spring 依赖注入,它默认基于类型注入</span><br><span class="line">   @Autowired</span><br><span class="line">   public void setUserDao(IUserDao userDao) &#123;</span><br><span class="line">        this.userDao = userDao;</span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">   public IUserDao getUserDao() &#123;</span><br><span class="line">        return userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void addUser(User user) &#123;</span><br><span class="line">        userDao.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>执行测试方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">private BeanFactory factory = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void testIOC()&#123;</span><br><span class="line">    IUserService userService = factory.getBean(&quot;userService&quot;,UserService.class);</span><br><span class="line">    User user = new User();</span><br><span class="line">    user.setId(UUID.randomUUID().toString());</span><br><span class="line">    user.setName(&quot;天王盖地虎&quot;);</span><br><span class="line">    user.setAge(&quot;21&quot;);</span><br><span class="line">    userService.addUser(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>ok, 如此简单的完成了依赖注入</p>
<ul>
<li>使用<code>@Resouce</code> 注解完成注入<br><strong>我们不推荐使用<code>@Autowired</code>,而是使用<code>@Resouce</code></strong><ul>
<li>引入J2EE中的<code>javax.anntation.resource</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.annotation&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li><p>将<code>@Autowired</code> 改为 <code>@Resouce</code> 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   // 使用J2EE提供的依赖注入完成</span><br><span class="line">@Resource</span><br><span class="line">public void setUserDao(IUserDao userDao) &#123;</span><br><span class="line">     this.userDao = userDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>你可以将注入写在<code>setter方法</code>上、属性上和构造方法上。这里只是举了个<code>setter</code>的例子</p>
</blockquote>
</li>
<li>你可以测试了<h4 id="不推荐使用-Component完成所有Bean的创建"><a href="#不推荐使用-Component完成所有Bean的创建" class="headerlink" title="不推荐使用@Component完成所有Bean的创建"></a>不推荐使用<code>@Component</code>完成所有Bean的创建</h4>除了<code>@Component</code>注解以外，还有如下功能一样，名称不同的注入注解。<ul>
<li><code>@Componentt</code> 作用于<code>公共代码层</code>。</li>
<li><code>@Repository</code> 作用于<code>持久化层(DAO)</code></li>
<li><code>@Service</code> 作用于<code>业务层</code></li>
<li><code>@Controller</code> 作用于<code>MVC控制层</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>你可修改上一个实例的<code>@Component</code> 实际相符的注入类型，并完成测试。</p>
</blockquote>
<h3 id="scope-实例周期"><a href="#scope-实例周期" class="headerlink" title="scope 实例周期"></a><code>scope</code> 实例周期</h3><p>使用XML管理Bean 可以在Bean中配置<code>scope</code>属性。<br>或者，使用@Scope注解配置Bean的周期。<br>Bean 实例周期属性<code>scope</code>有四个属性。</p>
<ul>
<li><code>singleton</code><br><strong>单例模式，默认值</strong></li>
<li><code>prototype</code><br><strong>多例模式</strong></li>
<li><code>request</code></li>
<li><code>session</code><blockquote>
<p><code>scope</code>默认为单例默认。当一个对象的状态不会发生改变，使用单例。当实例对象的状态肯能改变，使用多例。<br>例如：DAO层和Service层一般都是单例，而Model 则为多例，Model中的属性状态一直在变化。Action 层则为多例（状态总是改变的）。</p>
</blockquote>
</li>
</ul>
<p><strong>注解scope</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@Scope(&quot;prototype&quot;)</span><br><span class="line">public class User &#123; </span><br><span class="line">....</span><br></pre></td></tr></table></figure></p>
<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><p>AOP 直意过来为：<code>面向方面编程</code>,更为正确的叫法为：<code>面向切面编程</code></p>
<h3 id="AOP-Annotation-实例"><a href="#AOP-Annotation-实例" class="headerlink" title="AOP Annotation 实例"></a>AOP Annotation 实例</h3><p><strong>这个实例是建立在IOC Annotation 的基础上</strong></p>
<ul>
<li><p>引入AOP依赖包，依赖如下（Spring使用的是第三方的切面库：`Aspect.jar）</p>
<ul>
<li><code>aopalliance.jar</code></li>
<li><code>aspectrt.jar</code></li>
<li><code>aspectjweaver.jar</code></li>
<li>或者使用Maven构建如下(其中<code>aopllicance</code>,<code>spring-context</code> 默认引入依赖)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;</span><br><span class="line">   &lt;version&gt;1.7.3&lt;/version&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;</span><br><span class="line">   &lt;version&gt;1.7.3&lt;/version&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>beans.xml 引入<code>spring-aop shema</code> (主要目的自动检索或代码补全)</p>
</li>
<li><p>开启注解AOP 自动代理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span><br><span class="line">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd&quot;&gt;</span><br><span class="line">    &lt;!-- 开启使用注解配置 --&gt;</span><br><span class="line">    &lt;context:annotation-config /&gt;</span><br><span class="line">    &lt;!-- 告诉Spring 去哪写包找注入Bean --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;org.freecode.spring&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- AOP.1、引入AOP Schema --&gt;</span><br><span class="line">    &lt;!-- AOP.2、开启AOP自动代理 --&gt;</span><br><span class="line">    &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个切面类。（代理对象）</p>
<ul>
<li>通过<code>@Aspect</code> 注解，申明为一个切面对象。</li>
<li>声明AOP切点。声明AOP 方法的位置。这里使用<code>@After</code>方法后执行。</li>
<li><p>声明<code>execution表达式</code>，表明当前的方法允许访问范围</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">    1、execution 表达式标示</span><br><span class="line">    2、必须是 public 范围的方法</span><br><span class="line">    3、* 不显示返回类型</span><br><span class="line">    4、作用范围 包名下的所有类，必须add开头</span><br><span class="line">    5、(..) 不限制输入类型</span><br><span class="line">execution(public * org.freecode.spring.dao.*.add*(..))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果有多个<code>execution</code> 表达式使用<code>||</code> 运算符即可。<br><strong>参照如下</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.aspect;</span><br><span class="line">import org.aspectj.lang.annotation.After;</span><br><span class="line">import org.aspectj.lang.annotation.Aspect;</span><br><span class="line">import org.aspectj.lang.annotation.Before;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">/**</span><br><span class="line"> *1、 @Component IOC注解,将当前对象交给Spring管理</span><br><span class="line"> *2、@Aspect 申明这是一个切面类。(也可以理解为代理对象)</span><br><span class="line"> */</span><br><span class="line">@Component(&quot;logAspect&quot;)</span><br><span class="line">@Aspect</span><br><span class="line">public class LogAspect &#123;</span><br><span class="line">    @After(&quot;execution(public * org.freecode.spring.dao.*.add*(..))&quot;)</span><br><span class="line">    public void startLog()&#123;</span><br><span class="line">        Logger.info(&quot;方法调用结束&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public static class Logger&#123;</span><br><span class="line">        </span><br><span class="line">        public static void info(String message)&#123;</span><br><span class="line">            System.out.println(message);</span><br><span class="line">        &#125;</span><br><span class="line">        public static void error(String message)&#123;</span><br><span class="line">            System.err.println(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
</li>
<li><p>执行测试<br><strong>结果如下，很简单吧！！</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User [id=d7ee1ecd-a50a-4c38-9358-52233d70af4e, name=天王盖地虎, age=21]</span><br><span class="line">方法调用结束</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="AOP-切点方法"><a href="#AOP-切点方法" class="headerlink" title="AOP 切点方法"></a>AOP 切点方法</h3><p>实例中，只是使用<code>@After</code>，在方法后执行。</p>
<ul>
<li>AOP 切点<ul>
<li><code>@After</code>  函数调用之前执行。</li>
<li><code>@Before</code> 函数调用之后执行。 </li>
<li><code>@Around</code>  函数调用过程执行。（用法如下）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Around(&quot;execution(public * org.freecode.spring.dao.*.add*(..))&quot;)</span><br><span class="line">public void AroundLog(ProceedingJoinPoint pjp) throws Throwable&#123;</span><br><span class="line">    Logger.info(&quot;方法执行开始&quot;);</span><br><span class="line">    pjp.proceed();</span><br><span class="line">    Logger.info(&quot;方法执行结束&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="AOP-XML-实例"><a href="#AOP-XML-实例" class="headerlink" title="AOP XML 实例"></a>AOP XML 实例</h3><p><strong>在IOC Annotation 的代码的基础上</strong></p>
<ul>
<li>引入依赖</li>
<li><p>创建一个切面类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.spring.aspect;</span><br><span class="line">import org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">@Component(&quot;logAspect&quot;)</span><br><span class="line">public class LogAspect &#123;</span><br><span class="line">    public void startLog()&#123;</span><br><span class="line">        Logger.info(&quot;进入日志管理&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void AroundLog(ProceedingJoinPoint pjp) throws Throwable&#123;</span><br><span class="line">        Logger.info(&quot;方法执行开始&quot;);</span><br><span class="line">        pjp.proceed();</span><br><span class="line">        Logger.info(&quot;方法执行结束&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void endLog()&#123;</span><br><span class="line">        Logger.info(&quot;结束日志管理&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    public static class Logger&#123;</span><br><span class="line">        </span><br><span class="line">        public static void info(String message)&#123;</span><br><span class="line">            System.out.println(message);</span><br><span class="line">        &#125;</span><br><span class="line">        public static void error(String message)&#123;</span><br><span class="line">            System.err.println(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Spring 配置文件配置切面类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-.0.xsd</span><br><span class="line">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd&quot;&gt;</span><br><span class="line">    &lt;!-- 开启使用注解配置 --&gt;</span><br><span class="line">    &lt;context:annotation-config /&gt;</span><br><span class="line">    &lt;!-- 告诉Spring 去哪写包找注入Bean --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;org.freecode.spring&quot; /&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- ===== 如下AOP 定义LogAspect实例 =====  --&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- AOP 配置 --&gt;</span><br><span class="line">    &lt;aop:config&gt;</span><br><span class="line">        &lt;!-- 定义切面类(1..N) --&gt;</span><br><span class="line">        &lt;aop:aspect id=&quot;logAspect&quot; ref=&quot;logAspect&quot;&gt;</span><br><span class="line">            &lt;!-- 定义 execution 表达式(1..N)--&gt;</span><br><span class="line">            &lt;aop:pointcut id=&quot;LogPointcut&quot; </span><br><span class="line">                    expression=&quot;execution(public * org.freecode.spring.dao.*.add*(..))&quot; /&gt;</span><br><span class="line">            </span><br><span class="line">            &lt;!-- 哪种切点类型，作用于logAspect哪个方法，并引入哪个execution表达式 --&gt;</span><br><span class="line">            &lt;aop:before method=&quot;startLog&quot; pointcut-ref=&quot;LogPointcut&quot;/&gt;</span><br><span class="line">            &lt;aop:around method=&quot;AroundLog&quot; pointcut-ref=&quot;LogPointcut&quot;/&gt;</span><br><span class="line">            &lt;aop:after method=&quot;endLog&quot; pointcut-ref=&quot;LogPointcut&quot;/&gt;</span><br><span class="line">        &lt;/aop:aspect&gt;</span><br><span class="line">    &lt;/aop:config&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行测试，测试结果如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">进入日志管理</span><br><span class="line">方法执行开始</span><br><span class="line">User [id=c5064ec5-bc49-4d88-8e8a-8d721807157b, name=天王盖地虎, age=21]</span><br><span class="line">方法执行结束</span><br><span class="line">结束日志管理</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><p>Spring 的路还有很长，IOC和AOP只是Spring最最基础的两大核心。<br>这就像天梯一样，满满爬。</p>
<ul>
<li>Spring 基于XML的IOC，用到人并不多，一般都是Annotation的。</li>
<li>Spring 基于XML的AOP，更加的清楚，很多人愿意使用，同样Annotation也蛮方便的，那就折中把~ 用哪一个看心情</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/03/2014/HTML5 语义化标签/" itemprop="url">
                  HTML5 语义化标签
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-01-03T16:43:00+08:00" content="2014-01-03">
              2014-01-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/HTML/" itemprop="url" rel="index">
                    <span itemprop="name">HTML</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/01/03/2014/HTML5 语义化标签/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/03/2014/HTML5 语义化标签/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间看了一本《HTML5 实战》 ，也只是为了关注一下HTML5的发展和趋势。</p>
<p>看的我头大，这本书只是做个了HTML5的介绍，算不上实战，很多例子含糊不清。</p>
<p>HTML5 中新的语义化标签，还是让我眼前一亮。</p>
<h2 id="HTML5-中的新特性"><a href="#HTML5-中的新特性" class="headerlink" title="HTML5 中的新特性"></a>HTML5 中的新特性</h2><p><strong>HTML5 中的核心特性，先记录一下,方便日后查阅</strong></p>
<ul>
<li>新的语义化标签</li>
<li>表单与表单API</li>
<li>Canvas API</li>
<li>拖放 API</li>
<li>地理位置 API</li>
<li>WEB存储 API</li>
<li>IndexedDB API</li>
<li>文件</li>
<li>通信API</li>
<li>WEB workers API</li>
<li>历史 API</li>
<li>脱机 API</li>
</ul>
<h2 id="HTML5-语义化标签"><a href="#HTML5-语义化标签" class="headerlink" title="HTML5 语义化标签"></a>HTML5 语义化标签</h2><h3 id="HTML-结构语义"><a href="#HTML-结构语义" class="headerlink" title="HTML 结构语义"></a>HTML 结构语义</h3><p><strong>HTML 整体结构所需的标签语义</strong></p>
<table>
<thead>
<tr>
<th>标签</th>
<th>语义</th>
</tr>
</thead>
<tbody>
<tr>
<td>header</td>
<td>这个元素表示一组介绍性的内容，适用于文档的不同节，他既可以包含节标题，也可以包含索引、搜索表单、logo等</td>
</tr>
<tr>
<td>nav</td>
<td>这个元素表示包含导航链接的节，如菜单或索引，并非所有的网页链接都要加<nav>元素中，只有主要的导航块才需要加到元素中。</nav></td>
</tr>
<tr>
<td>section</td>
<td>这个元素表示文档中的普通的节，通常，它可用于创建多个内容块（如：列） 从而对具有特定主题的内容进行分组，如图书的章</td>
</tr>
<tr>
<td>aside</td>
<td>这个元素表示与内容相关但不属于它的内容，如：引用，边侧栏，广告</td>
</tr>
<tr>
<td>footer</td>
<td>这个元素表示与父级元素相关的额外信息。</td>
</tr>
<tr>
<td>article</td>
<td>这个元素表示重要信息的独立部分–例如，报纸上或博客中的文章，<article>可以嵌套，也可以用于在相关项列表中显示一个</article></td>
</tr>
<tr>
<td>hgroup</td>
<td>如果有多级标题，请使用。</td>
</tr>
<tr>
<td>figure</td>
<td>这个元素表示主内容引用内容独立部分(图像，图表，视频)，这个信息可以从主内容删除，而不会影响其常规流。</td>
</tr>
<tr>
<td>figcaption</td>
<td>这个元素可以用于显示表题，或者与figure 一起用，例如： 图形的描述信息。</td>
</tr>
<tr>
<td>mark</td>
<td>这个元素可以突出显示特殊情况下的重要文字，或者是对应的用户输入。</td>
</tr>
<tr>
<td>small</td>
<td>这个元素表示边侧评论，如附属细则(负责声明，法律限制，版权)</td>
</tr>
<tr>
<td>cite</td>
<td>这个元素可以用于显示作品标题(图书、电影、诗歌)</td>
</tr>
<tr>
<td>address</td>
<td>显示article或者整个文档的合同信息，且应该位于footer中。</td>
</tr>
<tr>
<td>time</td>
<td>显示人和机器可读的日期和时间。 datetime属性，pubdate表示出版日期</td>
</tr>
</tbody>
</table>
<h3 id="HTML-文档语义"><a href="#HTML-文档语义" class="headerlink" title="HTML 文档语义"></a>HTML 文档语义</h3><p><strong>HTML 作用于文本标签语义</strong></p>
<table>
<thead>
<tr>
<th>标签</th>
<th>语义</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>定义日期或时间</td>
</tr>
<tr>
<td>em</td>
<td>强调</td>
</tr>
<tr>
<td>strong</td>
<td>重要</td>
</tr>
<tr>
<td>small</td>
<td>旁注</td>
</tr>
<tr>
<td>cite</td>
<td>作品引用 （标题）</td>
</tr>
<tr>
<td>q</td>
<td>引用</td>
</tr>
<tr>
<td>dfn</td>
<td>举例</td>
</tr>
<tr>
<td>abbr</td>
<td>缩写</td>
</tr>
<tr>
<td>code</td>
<td>计算机代码</td>
</tr>
<tr>
<td>var</td>
<td>变量</td>
</tr>
<tr>
<td>samp</td>
<td>计算机输出</td>
</tr>
<tr>
<td>kbd</td>
<td>用户输入</td>
</tr>
<tr>
<td>sub</td>
<td>下标</td>
</tr>
<tr>
<td>sup</td>
<td>上标</td>
</tr>
<tr>
<td>i</td>
<td>备选项 大部分用于发言、技术短语等情况。</td>
</tr>
<tr>
<td>b</td>
<td>关键字 表示在不增加额外重要性的同时将词或短语高亮显示</td>
</tr>
<tr>
<td>mart</td>
<td>高亮</td>
</tr>
<tr>
<td>ruby、rb、rt、rp</td>
<td>注释 [一种排版注释系统(位于横排文本上方的简短文字)]</td>
</tr>
<tr>
<td>bdi</td>
<td>文本方向间离</td>
</tr>
<tr>
<td>bdo</td>
<td>文本方向格式</td>
</tr>
<tr>
<td>span</td>
<td>其他</td>
</tr>
<tr>
<td>br</td>
<td>换行</td>
</tr>
<tr>
<td>wbr</td>
<td>可选折行 [长单词的破择号 (让浏览器决定是否换行)]</td>
</tr>
<tr>
<td>h1 ~ h6</td>
<td>一级标题 至 六级标题</td>
</tr>
<tr>
<td>figure、figcaption</td>
<td>figure 独立的流（图片、图像、图表）figcaption 标题</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/12/14/2013/贫血模型和充血模型/" itemprop="url">
                  贫血模型和充血模型
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-12-14T16:53:00+08:00" content="2013-12-14">
              2013-12-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming-Language/" itemprop="url" rel="index">
                    <span itemprop="name">Programming Language</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming-Language/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/12/14/2013/贫血模型和充血模型/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/12/14/2013/贫血模型和充血模型/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>大多数情况下，我忍不住赋予Model行为，但是我并不知道它是否合理，了解一下领域模型中的贫血模型和充血模型，无意中发现还有胀血模型和失血模型。 如下是自己的理解：</p>
<h2 id="模型-（Model）"><a href="#模型-（Model）" class="headerlink" title="模型 （Model）"></a>模型 （Model）</h2><ul>
<li>无论是贫血模型还是充血模型，他们都符合POJO （也可以认为JavaBean）。<br><strong>Model包含属性的<code>get</code>、<code>set</code>方法</strong></li>
<li>模型的本质充当数据容器（保存状态，传递状态）。<br><strong>模型是一种特殊的数据结构</strong></li>
</ul>
<h2 id="失血模型"><a href="#失血模型" class="headerlink" title="失血模型"></a>失血模型</h2><p><strong>失血模型就是POJO对象，模型仅仅包含数据的定义和getter/setter方法，业务逻辑和应用逻辑都放到服务层（Service）中。</strong> </p>
<p>层次表示：</p>
<blockquote>
<p>UI(视图层) -&gt; Control(控制层) -&gt; Service（服务层） -&gt; DAO （持久化层） -&gt;domain object （领域对象 Model ）</p>
</blockquote>
<ul>
<li>领域对象不具备任何行为（仅仅是一个POJO对象），所有的行为都在Service层。</li>
<li>领域对象的作用。<ul>
<li>充当数据容器。</li>
<li>对象关系映射（ORM）</li>
</ul>
</li>
<li>这种模型很容易理解和掌握。</li>
<li>优点<ul>
<li>层次结构清晰，单项依赖，易于维护。</li>
</ul>
</li>
<li>缺点<ul>
<li>Service 层挤压严重。（业务逻辑职责） </li>
<li>部分与数据操作相关的行为，必须通过Service层进行修改。</li>
</ul>
</li>
</ul>
<h2 id="贫血模型"><a href="#贫血模型" class="headerlink" title="贫血模型"></a>贫血模型</h2><p><strong>贫血模型中包含了一些业务逻辑，但不包含依赖持久层的业务逻辑。这部分依赖于持久层的业务逻辑将会放到服务层中。</strong></p>
<p>层次表示：</p>
<blockquote>
<p>UI(视图层) -&gt; Control(控制层) -&gt; Service（服务层） -&gt; DAO （持久化层） -&gt;domain object （Model）</p>
</blockquote>
<ul>
<li>继承失血模型特性</li>
<li>领域对象具备简单行为，如下特点。<ul>
<li>行为不具备持久化特性。（不与数据库打交道，也就是不依赖于DAO层）</li>
<li>具备与数据相关的业务行为。（部分Service行为 移至 Model）</li>
</ul>
</li>
<li>同样与失血模型同样的痛处<ul>
<li>系统越复杂，维护成本越高，Service层（业务逻辑）挤压严重。</li>
</ul>
</li>
</ul>
<h2 id="充血模型"><a href="#充血模型" class="headerlink" title="充血模型"></a>充血模型</h2><p>**充血模型中包含了所有的业务逻辑，包括依赖于持久层的业务逻辑。所以，使用充血模型的领域层是依赖于持久层。</p>
<p>层次表示：</p>
<blockquote>
<p>UI -&gt; Control -&gt; Service -&gt; domain object &lt;–&gt; DAO</p>
</blockquote>
<ul>
<li>Service 层被减轻，不和DAO打交道，只包含业务逻辑。</li>
<li>领域对象 和 DAO 双向依赖。</li>
<li>优点<ul>
<li>减轻了Service层。</li>
</ul>
</li>
<li>缺点<ul>
<li>Service 将直接依赖于领域对象。 领域对象同样具备部分业务，可能会造成职责混乱，或者使领域对象不具备业务I行为</li>
<li>领域对象与DAO双向依赖，部分职责容易混响。</li>
</ul>
</li>
</ul>
<h2 id="胀血模型"><a href="#胀血模型" class="headerlink" title="胀血模型"></a>胀血模型</h2><p><strong>胀血模型就是把和业务逻辑不想关的其他应用逻辑（如授权、事务等）都放到领域模型中。我感觉胀血模型反而是另外一种的失血模型，因为服务层消失了，领域层干了服务层的事，到头来还是什么都没变。</strong></p>
<p>层次表示：</p>
<blockquote>
<p>UI -&gt; Control -&gt; domain object &lt;–&gt; DAO</p>
</blockquote>
<ul>
<li>没有了服务层，领域对象包含所有业务逻辑，并双向依赖与持久化层。</li>
<li>优点<ul>
<li>分层极其简单</li>
</ul>
</li>
<li>缺点<ul>
<li>领域对象职责过多，挤压严重，极其不稳定，不易维护。</li>
<li>控制层访问领域对象能够看到不必要的行为。</li>
</ul>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>失血模型和胀血模型并不被提倡，主要原因：领域模型内聚职责过少，或者过多。<br>关于贫血模型和充血模型的选型，其实跟语言架构有关（Robin提出）：</p>
<ul>
<li>如果使用Spring，必须贫血模型。</li>
<li>如果使用RoR，直接充血模型。</li>
</ul>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="http://blog.csdn.net/always_my_fault/article/details/2063612" target="_blank" rel="external">http://blog.csdn.net/always_my_fault/article/details/2063612</a><br><a href="http://www.oschina.net/question/54100_10400" target="_blank" rel="external">http://www.oschina.net/question/54100_10400</a><br><a href="http://www.360doc.com/content/12/0423/03/9318309_205785083.shtml" target="_blank" rel="external">http://www.360doc.com/content/12/0423/03/9318309_205785083.shtml</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/12/09/2013/软件版本周期/" itemprop="url">
                  软件版本周期
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-12-09T17:50:00+08:00" content="2013-12-09">
              2013-12-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Software-Engineering/" itemprop="url" rel="index">
                    <span itemprop="name">Software Engineering</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/12/09/2013/软件版本周期/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/12/09/2013/软件版本周期/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>软件版本周期过程</strong></p>
<img src="/2013/12/09/2013/软件版本周期/2013-12-09.png" alt="软件版本周期过程" title="软件版本周期过程">
<ul>
<li>base<br>表示软件开始阶段，base 是一种标示，标示软件开始到软件第一次发布这一过程（base -&gt; Alpha）</li>
<li>Pre-alpha<br>有时候软件会在Alpha或Beta版本前先发布Pre-alpha版本。一般而言相对于Alpha或Beta版本，Pre-alpha版本是一个功能不完整的版本。</li>
<li>Alpha<pre><code>Alpha是内部测试版,一般不向外部发布,会有很多Bug.除非你也是测试人员,否则不建议使用.是希腊字母的第一位,表示最初级的版本，alpha 就是α，此版本表示该软件在此阶段主要是以实现软件功能为主，该版本软件的Bug较多，需要继续修改。(大多数是内部小组测试，基于软件功能测试，寻找其Bug)
</code></pre><strong>预览版，基于内部测试，未发布</strong></li>
<li>Beta<br> beta 就是β ，alpha 版就是比beta还早的测试版，一般都是内部测试的版本。,该版本相对于α版已有了很大的改进，消除了严重的错误，但还是存在着一缺陷，需要经过多次测试来进一步消除。这个阶段的版本会一直加入新的功能。该版本相对于α版已有了很大的改进，消除了严重的错误，但还是存在着一些缺陷，需要经过多次测试来进一步消除，此版本主要的修改对像是软件的UI。<br><strong>公开测试版，对外发布，主要是给“部落”用户和忠实用户测试用的，该版本任然存 在很多BUG，但是相对alpha版要稳定一些。这个阶段版本的软件还会不断增加新功能。</strong></li>
<li>RC：(Release Candidate)<br>Candidate是候选人的意思，用在软件上就是候选版本。Release.Candidate.就是发行候选版本。和Beta版最大的差别在于Beta阶段会一直加入新的功能，但是到了RC版本，几乎就不会加入新的功能了，而主要着重于除错!  RC版本是最终发放给用户的最接近正式版的版本，发行后改正bug就是正式版了，就是正式版之前的最后一个测试版<br><strong>候选版本，版本又较beta版更进一步了，该版本功能不再增加，和最终发布版功能一样。这个版本有点像最终发行版之前的一个类似 预览版，这个的发布就标明离最终发行版不远了。</strong>该版本已经相当成熟了，基本上不存在导致错误的BUG，与即将发行的正式版相差无几。</li>
<li>GA：（general availability）<br>比如：Apache Struts 2 GA这是Apache Struts 2首次发行稳定的版本，GA意味着General Availability，也就是官方开始推荐广泛使用了</li>
<li>Release:<br> 该版本意味“最终版本”，在前面版本的一系列测试版之后，终归会有一个正式版本，是最终交付用户使用的一个版本。该版本有时也称为标准版。一般情况下，Release不会以单词形式出现在软件封面上，取而代之的是符号(R)。该版本意味“最终版本”，在前面版本的一系列测试版之后，终归会有一个正式版本，是最终交付用户使用的一个版本。该版本有时也称为标准版。一般情况下，Release不会以单词形式出现在软件封面上，取而代之的是符号(R)。</li>
</ul>
<blockquote>
<p>其他：stable版：稳定版。在开源软件中，都有stable版，这个就是开源软件的最终发行版，用户可以放心大胆的用了。另外，对于商业软件，还有一下版本：RTM版：全称为Release to Manufacture。工厂版。改版程序已经固定，就差工厂包装、光盘印图案等工作了。OEM版：厂商定制版。EVAL版：评估版。就是有30或者60天等使用期限的版本。RTL版：Retail.(零售版)，这个版本就是真正发售的版本，有漂亮的包装、光盘、说明书等东西和高昂的价格。final：最终版。</p>
</blockquote>
<h4 id="软件版本阶段说明"><a href="#软件版本阶段说明" class="headerlink" title="软件版本阶段说明"></a>软件版本阶段说明</h4><p>Alpha版: 此版本表示该软件在此阶段主要是以实现软件功能为主，通常只在软件开发者内部交流，一般而言，该版本软件的Bug较多，需要继续修改。<br>Beta版: 该版本相对于α版已有了很大的改进，消除了严重的错误，但还是存在着一些缺陷，需要经过多次测试来进一步消除，此版本主要的修改对像是软件的UI。<br>RC版: 该版本已经相当成熟了，基本上不存在导致错误的BUG，与即将发行的正式版相差无几。<br>Release版: 该版本意味“最终版本”，在前面版本的一系列测试版之后，终归会有一个正式版本，是最终交付用户使用的一个版本。该版本有时也称为标准版。一般情况下，Release不会以单词形式出现在软件封面上，取而代之的是符号(R)。</p>
<h4 id="版本命名规范"><a href="#版本命名规范" class="headerlink" title="版本命名规范"></a>版本命名规范</h4><p>软件版本号由四部分组成：<br>第一个1为主版本号，<br>第二个1为子版本号，<br>第三个1为阶段版本号，<br>第四部分为日期版本号加希腊字母版本号，希腊字母版本号共有5种，分别为：base、alpha、beta、RC、release。例如：1.1.1.051021_beta。<br>软件版本号由四部分组成，第一个1为主版本号，第二个1为子版本号，第三个1为阶段版本号，第四部分为日期版本号加希腊字母版本号，希腊字母版本号共有5种，分别为：base、alpha、beta、RC、release。例如：1.1.1.051021_beta。</p>
<h4 id="版本号定修改规则"><a href="#版本号定修改规则" class="headerlink" title="版本号定修改规则"></a>版本号定修改规则</h4><ul>
<li>主版本号(1)：当功能模块有较大的变动，比如增加多个模块或者整体架构发生变化。此版本号由项目决定 是否修改。</li>
<li>子版本号(1)：当功能有一定的增加或变化，比如增加了对权限控制、增加自定义视图等功能。此版本号由项目决定 是否修改。</li>
<li>阶段版本号(1)：一般是 Bug 修复或是一些小的变动，要经常发布修订版，时间间隔不限，修复一个严重的bug即可发布一个修订版。此版本号由项目经理决定 是否修改。</li>
<li>日期版本号(051021):用于记录修改项目的当前日期，每天对项目的修改都需要更改日期版本号。此版本号由开发人员决定 是否修改。</li>
<li>希腊字母版本号(beta):此版本号用于标注当前版本的软件处于哪个开发阶段，当软件进入到另一个阶段时需要修改此版本号。此版本号由项目决定 是否修改。</li>
</ul>
<h4 id="文件命名规范"><a href="#文件命名规范" class="headerlink" title="文件命名规范"></a>文件命名规范</h4><p>文件名称由四部分组成：第一部分为项目名称，第二部分为文件的描述，第三部分为当前软件的版本号，第四部分为文件阶段标识加文件后缀，例如：项目外 包平台测试报告1.1.1.051021_beta_b.xls，此文件为项目外包平台的测试报告文档，版本号为：1.1.1.051021_beta。</p>
<p>如果是同一版本同一阶段的文件修改过两次以上，则在阶段标识后面加以数字标识，每次修改数字加1，项目外包平台测试报告1.1.1.051021_beta_b1.xls。<br>当有多人同时提交同一份文件时，可以在阶段标识的后面加入人名或缩写来区别，例如：项目外包平台测试报告 1.1.1.051021_beta_b_LiuQi.xls。当此文件再次提交时也可以在人名或人名缩写的后面加入序号来区别，例如：项目外包平台测试 报告1.1.1.051021_beta_b_LiuQi2.xls</p>
<h5 id="版本号的阶段标识"><a href="#版本号的阶段标识" class="headerlink" title="版本号的阶段标识"></a>版本号的阶段标识</h5><p>软件的每个版本中包括11个阶段，详细阶段描述如下：<br>阶段名称                            阶段标识<br>需求控制                               a<br>设计阶段                               b<br>编码阶段                               c<br>单元测试                               d<br>单元测试修改                           e<br>集成测试                               f<br>集成测试修改                           g<br>系统测试                               h<br>系统测试修改                           i<br>验收测试                               j<br>验收测试修改                           k</p>
<h4 id="版本变动说明规范"><a href="#版本变动说明规范" class="headerlink" title="版本变动说明规范"></a>版本变动说明规范</h4><p><strong>相对于上一个版本增加Version Blog 信息</strong></p>
<ul>
<li>修复说明</li>
<li>增加说明</li>
</ul>
<p>参考:<br><a href="https://zh.wikipedia.org/wiki/%E8%BB%9F%E4%BB%B6%E7%89%88%E6%9C%AC%E9%80%B1%E6%9C%9F" target="_blank" rel="external">https://zh.wikipedia.org/wiki/%E8%BB%9F%E4%BB%B6%E7%89%88%E6%9C%AC%E9%80%B1%E6%9C%9F</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/11/25/2013/Linux iptable 防火墙/" itemprop="url">
                  Linux iptable 防火墙
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-11-25T23:23:00+08:00" content="2013-11-25">
              2013-11-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Operating-System/" itemprop="url" rel="index">
                    <span itemprop="name">Operating System</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Operating-System/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/11/25/2013/Linux iptable 防火墙/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/11/25/2013/Linux iptable 防火墙/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>Linux 环境下，默认使用的防火墙都是用iptable，同样也是服务器名称</strong></p>
<h2 id="iptable-服务"><a href="#iptable-服务" class="headerlink" title="iptable 服务"></a>iptable 服务</h2><p><strong>iptable 基本服务命令</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">service  iptables  start           开启防火墙</span><br><span class="line">service  iptables  stop           关闭防火墙</span><br><span class="line">service  iptables  restart        重启防火墙</span><br><span class="line">service  iptables save            保持iptable 配置</span><br><span class="line">service  iptables  status        查看防火墙状态</span><br></pre></td></tr></table></figure></p>
<h2 id="iptable-基本语法"><a href="#iptable-基本语法" class="headerlink" title="iptable 基本语法"></a>iptable 基本语法</h2><h3 id="防火墙处理数据4中方式"><a href="#防火墙处理数据4中方式" class="headerlink" title="防火墙处理数据4中方式"></a>防火墙处理数据4中方式</h3><ul>
<li>ACCEPT<br>允许数据包通过</li>
<li>DROP<br>直接丢弃数据包，不给予响应</li>
<li>REJECT<br>拒绝数据包通过，给予响应</li>
<li>LOG<br><code>/var/log/messages</code>文件记录日志信息</li>
</ul>
<h3 id="iptable-参数"><a href="#iptable-参数" class="headerlink" title="iptable 参数"></a>iptable 参数</h3><table>
<thead>
<tr>
<th>参数缩写</th>
<th>参数全称</th>
<th>参数解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>-A</td>
<td>–append</td>
<td>在指定链的末尾添加一条新的规则</td>
</tr>
<tr>
<td>-D</td>
<td>–delete</td>
<td>删除指定链中的某一条规则，可以按规则序号和内容删除</td>
</tr>
<tr>
<td>-I</td>
<td>–insert</td>
<td>在指定链中插入一条新的规则，默认在第一行添加</td>
</tr>
<tr>
<td>-R</td>
<td>–replace</td>
<td>修改、替换指定链中的某一条规则，可以按规则序号和内容替换</td>
</tr>
<tr>
<td>-L</td>
<td>–list</td>
<td>列出指定链中所有的规则进行查看</td>
</tr>
<tr>
<td>-E</td>
<td>–rename-chain</td>
<td>重命名用户定义的链，不改变链本身</td>
</tr>
<tr>
<td>-F</td>
<td>–flush</td>
<td>清空</td>
</tr>
<tr>
<td>-N</td>
<td>–new-chain</td>
<td>新建一条用户自己定义的规则链</td>
</tr>
<tr>
<td>-X</td>
<td>–delete-chain</td>
<td>删除指定表中用户自定义的规则链</td>
</tr>
<tr>
<td>-P</td>
<td>–policy</td>
<td>设置指定链的默认策略</td>
</tr>
<tr>
<td>-Z</td>
<td>–zero</td>
<td>将所有表的所有链的字节和数据包计数器清零</td>
</tr>
<tr>
<td>-n</td>
<td>–numeric</td>
<td>使用数字形式显示输出结果</td>
</tr>
<tr>
<td>-v</td>
<td>–verbose</td>
<td>查看规则表详细信息的信息</td>
</tr>
<tr>
<td>-V</td>
<td>–version</td>
<td>查看版本</td>
</tr>
<tr>
<td>-h</td>
<td>–help</td>
<td>获取帮助</td>
</tr>
</tbody>
</table>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -n    // 查看防火墙配置</span><br><span class="line">iptables -nL --line-number  // 查看iptables规则及编号</span><br></pre></td></tr></table></figure>
<h3 id="开放一个端口"><a href="#开放一个端口" class="headerlink" title="开放一个端口"></a>开放一个端口</h3><p><strong>开启8000端口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -p tcp --dport 8000 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<h3 id="删除一个规则"><a href="#删除一个规则" class="headerlink" title="删除一个规则"></a>删除一个规则</h3><p>删除一个开放的端口规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -n --line-number     // 查看规则编号</span><br><span class="line"></span><br><span class="line">iptables -D INPUT 2  // 删除指定规则编号，如 2</span><br></pre></td></tr></table></figure></p>
<h3 id="只开放某个端口"><a href="#只开放某个端口" class="headerlink" title="只开放某个端口"></a>只开放某个端口</h3><p><strong>只开放80端口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp –dport 80 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p tcp –sport 80 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<h3 id="禁止某个IP地址"><a href="#禁止某个IP地址" class="headerlink" title="禁止某个IP地址"></a>禁止某个IP地址</h3><p><strong>禁止192.168.12.13访问</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -s 192.168.12.13 -j DROP</span><br></pre></td></tr></table></figure></p>
<h3 id="关闭所有的-INPUT-FORWARD-OUTPUT"><a href="#关闭所有的-INPUT-FORWARD-OUTPUT" class="headerlink" title="关闭所有的 INPUT FORWARD OUTPUT"></a>关闭所有的 INPUT FORWARD OUTPUT</h3><p>关闭所有的INPUT FORWARD、 OUTPUT的所有端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P FORWARD DROP</span><br><span class="line">iptables -P OUTPUT DROP</span><br></pre></td></tr></table></figure></p>
<h2 id="手工配置iptable"><a href="#手工配置iptable" class="headerlink" title="手工配置iptable"></a>手工配置iptable</h2><h3 id="iptable-配置文件"><a href="#iptable-配置文件" class="headerlink" title="iptable 配置文件"></a>iptable 配置文件</h3><p>iptable配置文件默认地址为：<code>/etc/sysconfig/iptables</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure></p>
<p>执行如上命令显示如下iptables配置信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Firewall configuration written by system-config-firewall</span><br><span class="line"># Manual customization of this file is not recommended.</span><br><span class="line">*filter</span><br><span class="line">:INPUT ACCEPT [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 6379 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 7474 -j ACCEPT</span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure></p>
<h3 id="开放特定端口"><a href="#开放特定端口" class="headerlink" title="开放特定端口"></a>开放特定端口</h3><p>如下开放1517端口，将其复制到iptable 配置文件中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 1517 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<p>然后执行如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">serivce iptables save       保持防火墙设置</span><br><span class="line">service iptables restart     重启防火墙</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/11/16/2013/Maven 服务器插件Jetty/" itemprop="url">
                  Maven 服务器插件Jetty
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-11-16T08:54:00+08:00" content="2013-11-16">
              2013-11-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Project-Build/" itemprop="url" rel="index">
                    <span itemprop="name">Project Build</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Project-Build/Maven/" itemprop="url" rel="index">
                    <span itemprop="name">Maven</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/11/16/2013/Maven 服务器插件Jetty/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/11/16/2013/Maven 服务器插件Jetty/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一个常规的Java Web 你需要部署到Tomcat中，使用Maven构建Web项目使用Jetty 容器，使运行Java Web项目更加方便。</p>
<h2 id="Jetty-完整性配置"><a href="#Jetty-完整性配置" class="headerlink" title="Jetty 完整性配置"></a>Jetty 完整性配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;webapp.port&gt;8083&lt;/webapp.port&gt;</span><br><span class="line">    &lt;webapp.stopPort&gt;9090&lt;/webapp.stopPort&gt;</span><br><span class="line">    &lt;webapp.path&gt;/&lt;/webapp.path&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jetty-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;8.1.13.v20130916&lt;/version&gt;</span><br><span class="line">    &lt;configuration&gt;</span><br><span class="line">        &lt;webAppConfig&gt;</span><br><span class="line">            &lt;contextPath&gt;$&#123;webapp.path&#125;&lt;/contextPath&gt;</span><br><span class="line">            &lt;defaultsDescriptor&gt;webdefault.xml&lt;/defaultsDescriptor&gt;</span><br><span class="line">        &lt;/webAppConfig&gt;</span><br><span class="line">        &lt;connectors&gt;</span><br><span class="line">            &lt;connector implementation=&quot;org.eclipse.jetty.server.nio.SelectChannelConnector&quot;&gt;</span><br><span class="line">                &lt;port&gt;$&#123;webapp.port&#125;&lt;/port&gt;</span><br><span class="line">                &lt;maxIdleTime&gt;60000&lt;/maxIdleTime&gt;</span><br><span class="line">            &lt;/connector&gt;</span><br><span class="line">        &lt;/connectors&gt;</span><br><span class="line">        &lt;reload&gt;automatic&lt;/reload&gt;</span><br><span class="line">        &lt;scanIntervalSeconds&gt;0&lt;/scanIntervalSeconds&gt;</span><br><span class="line">        &lt;!-- stopPort&gt;$&#123;webapp.stopPort&#125;&lt;/stopPort --&gt;</span><br><span class="line">        &lt;systemProperties&gt;</span><br><span class="line">            &lt;systemProperty&gt;</span><br><span class="line">                &lt;name&gt;org.mortbay.util.URI.charset&lt;/name&gt;</span><br><span class="line">                &lt;value&gt;UTF-8&lt;/value&gt;</span><br><span class="line">            &lt;/systemProperty&gt;</span><br><span class="line">        &lt;/systemProperties&gt;</span><br><span class="line">        &lt;jvmArgs&gt;-Xmx512m -XX:PermSize=128m -XX:MaxPermSize=256m</span><br><span class="line">            -Dfile.encoding=UTF-8&lt;/jvmArgs&gt;</span><br><span class="line">    &lt;/configuration&gt;</span><br><span class="line">    &lt;executions&gt;</span><br><span class="line">        &lt;execution&gt;</span><br><span class="line">            &lt;id&gt;start-jetty&lt;/id&gt;</span><br><span class="line">            &lt;phase&gt;pre-integration-test&lt;/phase&gt;</span><br><span class="line">            &lt;goals&gt;</span><br><span class="line">                &lt;goal&gt;run&lt;/goal&gt;</span><br><span class="line">            &lt;/goals&gt;</span><br><span class="line">            &lt;configuration&gt;</span><br><span class="line">                &lt;scanIntervalSeconds&gt;0&lt;/scanIntervalSeconds&gt;</span><br><span class="line">                &lt;daemon&gt;true&lt;/daemon&gt;</span><br><span class="line">            &lt;/configuration&gt;</span><br><span class="line">        &lt;/execution&gt;</span><br><span class="line">        &lt;execution&gt;</span><br><span class="line">            &lt;id&gt;stop-jetty&lt;/id&gt;</span><br><span class="line">            &lt;phase&gt;post-integration-test&lt;/phase&gt;</span><br><span class="line">            &lt;goals&gt;</span><br><span class="line">                &lt;goal&gt;stop&lt;/goal&gt;</span><br><span class="line">            &lt;/goals&gt;</span><br><span class="line">        &lt;/execution&gt;</span><br><span class="line">    &lt;/executions&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>运行命令 <code>jetty:run</code></li>
<li>停止运行<code>jetty:stop</code></li>
</ul>
<h2 id="Jetty-可配置参数"><a href="#Jetty-可配置参数" class="headerlink" title="Jetty 可配置参数"></a>Jetty 可配置参数</h2><ul>
<li>scanIntervalSeconds 表示扫时间，避免重复运行，它会自动检测是否修改项目文件</li>
<li>jvmArgs JVM 堆栈大小</li>
<li>port 端口号</li>
<li>contextPath 项目路径</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/08/12/2013/Java项目开发中的简称/" itemprop="url">
                  Java项目开发中的简称
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-08-12T14:13:00+08:00" content="2013-08-12">
              2013-08-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming-Language/" itemprop="url" rel="index">
                    <span itemprop="name">Programming Language</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Programming-Language/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/08/12/2013/Java项目开发中的简称/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/08/12/2013/Java项目开发中的简称/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Java项目开发中的简称，这些简称尤其应用到Java项目分层上。 传统的MVC，可以能只是三层架构。分为View、Control、Model。 有些简写的分层，在看别人代码的时候，可能一下反应不过来它是干什么的？ 这里仔细总结一下，我觉得非常有用，它使我们的代码结构更加清晰。</p>
<p>大部分的缩写源于： 领域模型驱动（DDD）。</p>
<p>大致如下缩写：</p>
<ul>
<li>POJO (Plain Ordinary Java Object) 简单java对象</li>
<li>DAO (Data Access Object) 数据访问对象</li>
<li>DTO (Data Transfer Object) 数据传输对象</li>
<li>VO (View Object) 值对象</li>
<li>BO (Business Object) 业务对象</li>
<li>PO (Persistant Object) 持久化对象</li>
</ul>
<p>参考了一些文章，加上自己的理解</p>
<p>首先要理解什么是JavaBean 、Model、Entity</p>
<ul>
<li>JavaBean<br><strong>JavaBean是一种规范，也即包含一组set和get方法的Java对象。Model、Entity、POJO、DTO、BO都属于JavaBean，因为他们符合这种规范。</strong><br><strong>JavaBean分为业务Bean和数据Bean。数据Bean其实就Entity(实体对象)，业务Bean 就是（BO 业务对象）</strong></li>
<li>Model<br><strong>Model是MVC概念之一。也就是Model层用于存储实体对象（Entity）。Model通常 等价于Entity 用DAO层持久化对象</strong></li>
<li>Entity<br><strong>Entity 为实体对象。你把它就做POJO、Model、JavaBean，也没人敢说你一定错误。他主要作用为数据（数据库数据）做持久化。 一旦将数据库中的一条数据存储Entity中，你把它叫做PO对象，也是对的。他只是 领域模型驱动中的概念之一</strong></li>
</ul>
<h2 id="简单java对象-POJO"><a href="#简单java对象-POJO" class="headerlink" title="简单java对象 (POJO)"></a>简单java对象 (POJO)</h2><p>普通的Java对象，对于属性一般实现了JavaBean的标准，另外还可以包含一些简单的业务逻辑(方法)。</p>
<p>一个POJO持久化以后就是PO<br>直接用它传递、传递过程中就是DTO<br>直接用来对应表示层就是VO</p>
<h2 id="数据访问对象-DAO"><a href="#数据访问对象-DAO" class="headerlink" title="数据访问对象 (DAO)"></a>数据访问对象 (DAO)</h2><ul>
<li>DAO 数据访问对象，主要用于封装数据库的访问，通过它可以把POJO持久化为PO，用PO组装出来VO、DTO。</li>
<li>我们还会把DAO叫做持久化层。</li>
</ul>
<h2 id="数据传输对象-DTO"><a href="#数据传输对象-DTO" class="headerlink" title="数据传输对象 (DTO)"></a>数据传输对象 (DTO)</h2><p>Data Transfer Object数据传输对象</p>
<ul>
<li>DTO的概念是J2EE提出，主要用于分布式应用，用于服务之间的数据传输。</li>
<li>分布式应用（JSONP、RCP、RMI等 远程方法或过程调用）之间的数据传输对象使用DTO。</li>
<li>单系统中用于展示层与服务层之间的数据传输</li>
</ul>
<h2 id="值对象-VO"><a href="#值对象-VO" class="headerlink" title="值对象 (VO)"></a>值对象 (VO)</h2><p>ViewObject表现层对象 （展示层）</p>
<ul>
<li>主要对应界面显示的数据值对象。它包含了界面（Web、Mobile、PC）所请求的数据信息。</li>
<li>VO的数据值可以是一个或多个Model的子集或交集，主要目的构成响应（Response）所要展示的内容信息。</li>
<li>VO值对象会转换为JSON、XML、HTML等格式返回给请求者。</li>
</ul>
<h2 id="业务对象-BO"><a href="#业务对象-BO" class="headerlink" title="业务对象 (BO)"></a>业务对象 (BO)</h2><p>business object业务对象</p>
<ul>
<li>主要作用是把业务逻辑封装为一个对象。这个对象可以包括一个或多个其它的对象。<br>eg:<br>比如一个简历，有教育经历、工作经历、社会关系等等。<br>我们可以把教育经历对应一个PO，工作经历对应一个PO，社会关系对应一个PO。<br>建立一个对应简历的BO对象处理简历，每个BO包含这些PO。<br>这样处理业务逻辑时，我们就可以针对BO去处理。</li>
</ul>
<h2 id="持久化对象-PO"><a href="#持久化对象-PO" class="headerlink" title="持久化对象 (PO)"></a>持久化对象 (PO)</h2><ul>
<li>最形象的理解就是一个PO就是数据库中的一条记录。 （好处是可以把一条记录作为一个对象处理，可以方便的转为其它对象。）</li>
</ul>
<img src="/2013/08/12/2013/Java项目开发中的简称/2013-02-12-java.png" alt="整体的结构图" title="整体的结构图">
<p>总结：</p>
<ul>
<li>领域模型可以使得责任更加明确。</li>
<li>有时候避免过度设计<br>不要陷入过度设计，大可不必为了设计而设计一定要在代码中区分各个对象,一句话技术是为应用服务的。</li>
</ul>
<p>参考</p>
<p><a href="http://www.blogjava.net/vip01/archive/2007/01/08/92430.html" target="_blank" rel="external">http://www.blogjava.net/vip01/archive/2007/01/08/92430.html</a><br><a href="http://b-l-east.iteye.com/blog/1142800" target="_blank" rel="external">http://b-l-east.iteye.com/blog/1142800</a><br><a href="http://www.blogjava.net/johnnylzb/archive/2010/05/27/321968.html" target="_blank" rel="external">http://www.blogjava.net/johnnylzb/archive/2010/05/27/321968.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/05/17/2013/Mysql 异常及其解决方案/" itemprop="url">
                  Mysql 异常及其解决方案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-05-17T12:53:00+08:00" content="2013-05-17">
              2013-05-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Data-Base-Management-System/" itemprop="url" rel="index">
                    <span itemprop="name">Data Base Management System</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Data-Base-Management-System/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/05/17/2013/Mysql 异常及其解决方案/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/05/17/2013/Mysql 异常及其解决方案/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>记录遇到过的Mysql错误，及其解决方案，持续更新</strong></p>
<h2 id="ERROR-1130"><a href="#ERROR-1130" class="headerlink" title="ERROR 1130"></a>ERROR 1130</h2><p><strong>本地链接远程Mysql 数据库异常</strong></p>
<h3 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1130: Host 192.168.12.153 is not allowed to connect to this MySQL server</span><br></pre></td></tr></table></figure>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>开启远程访问权限</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p -h localhost -P 3306</span><br><span class="line"></span><br><span class="line">use mysql</span><br><span class="line"></span><br><span class="line">// 所有IP，均可访问</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos;IDENTIFIED BY &apos;123456&apos; WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line">// 如下指定特定IP，同样可以指定用户，及其密码</span><br><span class="line">// GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;192.168.10.72&apos;IDENTIFIED BY &apos;123456&apos; WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line">// 所有IP</span><br><span class="line">//GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos;WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>参看doc：<a href="http://dev.mysql.com/doc/refman/5.1/en/adding-users.html" target="_blank" rel="external">http://dev.mysql.com/doc/refman/5.1/en/adding-users.html</a><br><a href="http://dev.mysql.com/doc/refman/5.7/en/grant.html" target="_blank" rel="external">http://dev.mysql.com/doc/refman/5.7/en/grant.html</a></p>
</blockquote>
<h2 id="ERROR-1045"><a href="#ERROR-1045" class="headerlink" title="ERROR 1045"></a>ERROR 1045</h2><h3 id="错误信息-1"><a href="#错误信息-1" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>使用root 且密码正确，无法登陆，</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1045 (28000): Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: YES)</span><br></pre></td></tr></table></figure></p>
<h3 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>由于是root用户无法登陆，需要先打开无密码登陆</strong></p>
<ul>
<li>解决1045错误<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update user set authentication_string=PASSWORD(&apos;123456&apos;) where user=&apos;root&apos; and host=&apos;localhost&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="ERROR-1406-22001-和ERROR-1366-HY000"><a href="#ERROR-1406-22001-和ERROR-1366-HY000" class="headerlink" title="ERROR 1406 (22001)和ERROR 1366 (HY000)`"></a>ERROR 1406 (22001)<code>和</code>ERROR 1366 (HY000)`</h2><h3 id="错误信息-2"><a href="#错误信息-2" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>导入数据出现<code>ERROR 1406 (22001):</code>和<code>ERROR 1366 (HY000)</code> 错误</strong></p>
<img src="/2013/05/17/2013/Mysql%20异常及其解决方案/e8a266cd-6e44-4a0b-967d-4cd707c1f23e.png" alt="错误详情" title="错误详情">
<h3 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h3><p>命令行窗口默认为GBK编码,而SQL文件为UTF-8,进行数据导入，它并不买账。 即便你使用”set names utf8;”,也是无效的,这是系统编码问题。有如下两种解决方案。</p>
<ul>
<li>使用图形化界面进行SQL导入，非常容易。（sqlyog之类的图形工具）</li>
<li>进行如下操作<ul>
<li>启动CMD(Window 命令行工具) -&gt; 输入chcp 65001 -&gt; 它将进入utf-8模式。</li>
<li>mysql -u root -p  进行SQL 控制台 -&gt; source f:/xx/xx.sql 进行数据导入</li>
<li>如果你想在改为GBK模式。 输入:chcp 936</li>
</ul>
</li>
</ul>
<img src="/2013/05/17/2013/Mysql%20异常及其解决方案/dd1f2b82-0c9c-49fe-885d-f5e20619c8f1.png" alt="执行成功信息" title="执行成功信息">
<h2 id="ERROR-1045-28000"><a href="#ERROR-1045-28000" class="headerlink" title="ERROR 1045 (28000)"></a>ERROR 1045 (28000)</h2><h3 id="错误信息-3"><a href="#错误信息-3" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1045 (28000): Access denied for user &apos;root&apos;@&apos;localhost&apos;</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-2"><a href="#解决方案-2" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>如果不是root用户出现1045，直接使用root 对象该用户进行授权即可</strong></p>
<ul>
<li><p>使用 mysql -u root 无密码登陆。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 关闭mysql</span><br><span class="line">service mysqld stop</span><br><span class="line">vi /etc/my.cnf</span><br><span class="line">// 将skip-grant-tables 添加至末尾,并保存</span><br><span class="line">service mysqld start</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新设置密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//选择数据库</span><br><span class="line">use mysql</span><br><span class="line">// 设置密码。  5.7 相比5.5 user表中password字段改为authentication_string。如下</span><br><span class="line">update user set authentication_string=PASSWORD(&apos;123456&apos;) where user=&apos;root&apos; and host=&apos;localhost&apos;;</span><br><span class="line">//更新权限表</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭无密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 关闭数据库</span><br><span class="line">//删除skip-grant-tables </span><br><span class="line">//开启数据库</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="ERROR-1820-HY000"><a href="#ERROR-1820-HY000" class="headerlink" title="ERROR 1820 (HY000)"></a>ERROR 1820 (HY000)</h2><h3 id="错误信息-4"><a href="#错误信息-4" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-3"><a href="#解决方案-3" class="headerlink" title="解决方案"></a>解决方案</h3><p>重设密码，如下：localhost<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD = PASSWORD(&apos;localhost&apos;);</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="cmp-cc" />
          <p class="site-author-name" itemprop="name">cmp-cc</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">67</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">44</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cmp-cc" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cmp-cc</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"cmp-cc"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();


  </script>

  
    
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  

 <script type="text/javascript">
  window.onload = function(){setTimeout(function(){/*无登陆账户*/if(!document.getElementsByClassName("ds-account-control")[0]){var cmp_cc_blog_user=localStorage.getItem("cmp-cc_blog_user");var author_name_value = cmp_cc_blog_user?'value="'+cmp_cc_blog_user+'"':'';var i = '<div class="ds-control-group" style="float:right;padding:6px;"><input type="text" '+author_name_value+'id="author_name_proxy" id="ds-dialog-name"  class="custom_input" style="color:#777;width=80%;font-size:13px;border:1px solid #ccc;height:25px;box-shadow: inset 0 1px 1px;padding: 2px 0px 0px 8px;" placeholder="昵称 or 登陆" required></div>';/*展开一个回复，再关闭。 多说没有参数配置啊~ 让人觉得不优雅*/var $last_ds_post_reply = $(".ds-post-reply:last");$last_ds_post_reply.click().click();$(".ds-post-options.ds-gradient-bg").append(i);$(".ds-post-button").click(function(){$(this).submit();$("#ds-wrapper").hide();var author_name = $("#author_name_proxy").val();$("#ds-wrapper #ds-dialog-name").val(author_name);$("#ds-wrapper form").submit();/*www.cmp-cc.github.com*/localStorage.setItem("cmp-cc_blog_user",author_name);$(".custom_input").val(author_name);});}},300);} 
 </script>





  
  
  

  

  
<script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js">
</script>


</body>
</html>
