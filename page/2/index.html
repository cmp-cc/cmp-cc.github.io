<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="I am cmp-cc" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="I am cmp-cc">
<meta property="og:url" content="http://cmp-cc.github.io/page/2/index.html">
<meta property="og:site_name" content="I am cmp-cc">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="I am cmp-cc">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> I am cmp-cc </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?0fb6f1a75a76726c10a144a8257465e3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">I am cmp-cc</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">一直在打杂，从未被超越。</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/04/02/Mybatis井号和$的区别/" itemprop="url">
                  Mybatis ${}和#{} 区别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-04-02T12:53:00+08:00" content="2014-04-02">
              2014-04-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-Web/" itemprop="url" rel="index">
                    <span itemprop="name">Java Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/04/02/Mybatis井号和$的区别/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/04/02/Mybatis井号和$的区别/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这两个标示符均会出现在MyBatis XML SQL 映射文件中。</p>
<ul>
<li>参照理解：<ul>
<li><code>#{}</code>  相当于 PrepareStatement 类<br><strong>以占位符的形式进行数值传递，有效的防止SQL注入</strong></li>
<li><code>${}</code> 相当于 Statement 类<br><strong>值传递，不能能防止SQL注入</strong></li>
</ul>
</li>
</ul>
<blockquote>
<p>需要理解JDBC中的PrepareStatement 和 Statement 的关系。</p>
</blockquote>
<h2 id="占位符替换，能够防止SQL-注入问题。"><a href="#占位符替换，能够防止SQL-注入问题。" class="headerlink" title="#{} 占位符替换，能够防止SQL 注入问题。"></a><code>#{}</code> 占位符替换，能够防止SQL 注入问题。</h2><p>如下Mapper.xml SQL映射语句。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=&quot;insertSample&quot; parameterType=&quot;Sample&quot;&gt;</span><br><span class="line">     INSERT INTO SAMPLE(ID,NAME,EMAIL, TYPE) VALUES(#&#123;Id&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;type&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure></p>
<p>它将会翻译为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO SAMPLE(ID,NAME,EMAIL, TYPE) VALUES ?,?,?,?</span><br></pre></td></tr></table></figure></p>
<p><strong>?会对应顺序的数值进行赋值传递，并检查数值的合法性.(这里有个预编译阶段，用于检验SQL)</strong></p>
<h2 id="值传递，不能防止SQL注入"><a href="#值传递，不能防止SQL注入" class="headerlink" title="${} 值传递，不能防止SQL注入"></a><code>${}</code> 值传递，不能防止SQL注入</h2><p>如下Mapper.xml SQL映射语句。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=&quot;insertSample&quot; parameterType=&quot;Sample&quot;&gt;</span><br><span class="line">     INSERT INTO SAMPLE(ID,NAME,EMAIL, TYPE) VALUES($&#123;Id&#125;,$&#123;name&#125;,$&#123;email&#125;,$&#123;type&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure></p>
<p>它将会翻译为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO SAMPLE(ID,NAME,EMAIL, TYPE) VALUES 4,飞车,baiwoyidao@163.com,游戏</span><br></pre></td></tr></table></figure></p>
<p><strong>直接的SQL生成，没有预编译阶段。</strong></p>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>使用<code>#{}</code>替代<code>${}</code><ul>
<li><code>#{}</code>更加安全</li>
<li><code>#{}</code> 性能好一些（部分数据库会对预编译语句进行性能优化）</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/04/02/MyBatis Boostrap/" itemprop="url">
                  MyBatis Boostrap
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-04-02T10:44:00+08:00" content="2014-04-02">
              2014-04-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-Web/" itemprop="url" rel="index">
                    <span itemprop="name">Java Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/04/02/MyBatis Boostrap/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/04/02/MyBatis Boostrap/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SqlSessionFactory 是MyBatis的核心对象，用于获取SqlSession，并执行映射的 SQL 语句。<br>可以通过基于 XML 的配置信息或者 Java API 创建。</p>
<p>我们将探索各种 MaBatis 配置元素，如 dataSource，environments,全局参数设置,typeAlias，typeHandlers，<br>SQL 映射；接着我们将实例化 SqlSessionFactory。</p>
<ul>
<li>使用 XML 配置 MyBatis</li>
<li>使用 Java API 配置 MyBatis</li>
<li>自定义 MyBatis 日志</li>
</ul>
<h2 id="使用-XML-配置-MyBatis"><a href="#使用-XML-配置-MyBatis" class="headerlink" title="使用 XML 配置 MyBatis"></a>使用 XML 配置 MyBatis</h2><p><strong>构建 SqlSessionFactory 最常见的方式是基于 XML 配置（的构造方式）。下面的 mybatis-config.xml 展示了一个<br>典型的 MyBatis 配置文件的样子：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">	&lt;properties resource=&quot;application.properties&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;username&quot; value=&quot;db_user&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;password&quot; value=&quot;verysecurepwd&quot; /&gt;</span><br><span class="line">	&lt;/properties&gt;</span><br><span class="line">	&lt;settings&gt;</span><br><span class="line">		&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">	&lt;/settings&gt;</span><br><span class="line">	&lt;typeAliases&gt;</span><br><span class="line">		&lt;typeAlias alias=&quot;Tutor&quot; type=&quot;com.mybatis3.domain.Tutor&quot; /&gt;</span><br><span class="line">		&lt;package name=&quot;com.mybatis3.domain&quot; /&gt;</span><br><span class="line">	&lt;/typeAliases&gt;</span><br><span class="line">	&lt;typeHandlers&gt;</span><br><span class="line">		&lt;typeHandler handler=&quot;com.mybatis3.typehandlers. PhoneTypeHandler&quot; /&gt;</span><br><span class="line">		&lt;package name=&quot;com.mybatis3.typehandlers&quot; /&gt;</span><br><span class="line">	&lt;/typeHandlers&gt;</span><br><span class="line">	&lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">		&lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">			&lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">			&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">				&lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driverClassName&#125;&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</span><br><span class="line">			&lt;/dataSource&gt;</span><br><span class="line">		&lt;/environment&gt;</span><br><span class="line">		&lt;environment id=&quot;production&quot;&gt;</span><br><span class="line">			&lt;transactionManager type=&quot;MANAGED&quot; /&gt;</span><br><span class="line">			&lt;dataSource type=&quot;JNDI&quot;&gt;</span><br><span class="line">				&lt;property name=&quot;data_source&quot; value=&quot;java:comp/jdbc/MyBatisDemoDS&quot; /&gt;</span><br><span class="line">			&lt;/dataSource&gt;</span><br><span class="line">		&lt;/environment&gt;</span><br><span class="line">	&lt;/environments&gt;</span><br><span class="line">	&lt;mappers&gt;</span><br><span class="line">		&lt;mapper resource=&quot;com/mybatis3/mappers/StudentMapper.xml&quot; /&gt;</span><br><span class="line">		&lt;mapper url=&quot;file:///D:/mybatisdemo/mappers/TutorMapper.xml&quot; /&gt;</span><br><span class="line">		&lt;mapper class=&quot;com.mybatis3.mappers.TutorMapper&quot; /&gt;</span><br><span class="line">	&lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>下面让我们逐个讨论上述配置文件的组成部分</strong></p>
<h3 id="environment-环境"><a href="#environment-环境" class="headerlink" title="environment (环境)"></a>environment (环境)</h3><p>MyBatis 支持配置多个 dataSource 环境，可以将应用部署到不同的环境上， DEV(开发环境)，如TEST（测试换将），<br>QA（质量评估环境）,UAT(用户验收环境),PRODUCTION（生产环境），可以通过将默认 environment 值设置成想要的<br>environment id 值。<br>在上述的配置中，默认的环境 environment 被设置成 development。当需要将程序部署到生产服务器上时，你不需<br>要修改什么配置，只需要将默认环境 environment 值设置成生产环境的<br>明细；使用 REPORTS 数据库存储订单明细的合计，用作报告。<br>如果你的应用需要连接多个数据库，你需要将每个数据库配置成独立的环境，并且为每一个数据库创建一个<br>SqlSessionFactory。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;environments default=&quot;shoppingcart&quot;&gt;</span><br><span class="line">	&lt;environment id=&quot;shoppingcart&quot;&gt;</span><br><span class="line">		&lt;transactionManager type=&quot;MANAGED&quot; /&gt;</span><br><span class="line">		&lt;dataSource type=&quot;JNDI&quot;&gt;</span><br><span class="line">			&lt;property name=&quot;data_source&quot; value=&quot;java:comp/jdbc/ ShoppingcartDS&quot; /&gt;</span><br><span class="line">		&lt;/dataSource&gt;</span><br><span class="line">	&lt;/environment&gt;</span><br><span class="line">	&lt;environment id=&quot;reports&quot;&gt;</span><br><span class="line">		&lt;transactionManager type=&quot;MANAGED&quot; /&gt;</span><br><span class="line">		&lt;dataSource type=&quot;JNDI&quot;&gt;</span><br><span class="line">			&lt;property name=&quot;data_source&quot; value=&quot;java:comp/jdbc/ReportsDS&quot; /&gt;</span><br><span class="line">		&lt;/dataSource&gt;</span><br><span class="line">	&lt;/environment&gt;</span><br><span class="line">&lt;/environments&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>我们可以通过如下，为每一个环境创建一个SqlSessionFactory</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inputStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">defaultSqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">cartSqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream, &quot;shoppingcart&quot;);</span><br><span class="line">reportSqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream, &quot;reports&quot;);</span><br></pre></td></tr></table></figure></p>
<p>创建 SqlSessionFactory 时，如果没有明确指定环境 environment id，则会使用默认的环境 environment 来创<br>建。在上述的源码中，默认的 SqlSessionFactory 便是使用 shoppingcart 环境设置创建的。<br>对于每个环境 environment,我们需要配置 dataSource 和 transactionManager 元素。</p>
<h3 id="DataSource-数据源"><a href="#DataSource-数据源" class="headerlink" title="DataSource (数据源)"></a>DataSource (数据源)</h3><p>dataSource 元素被用来配置数据库连接属性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">	&lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driverClassName&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</span><br><span class="line">	&lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</span><br><span class="line">&lt;/dataSource&gt;</span><br></pre></td></tr></table></figure></p>
<p>dataSource 的类型可以配置成其内置类型之一，如 UNPOOLED，POOLED，JNDI。</p>
<ul>
<li>如果将类型设置成 UNPOOLED，MyBatis 会为每一个数据库操作创建一个新的连接，并关闭它。该方式适用于只有小规模数量并发用户的简单应用程序上。</li>
<li>如果将属性设置成 POOLED，MyBatis 会创建一个数据库连接池，连接池中的一个连接将会被用作数据库操作。一旦数据库操作完成，MyBatis 会将此连接返回给连接池。在开发或测试环境中，经常使用此种方式。</li>
<li>如果将类型设置成 JNDI，MyBatis 从在应用服务器向配置好的 JNDI 数据源 dataSource 获取数据库连接。在生产环境中，优先考虑这种方式。</li>
</ul>
<h3 id="TransactionManager-事务管理器"><a href="#TransactionManager-事务管理器" class="headerlink" title="TransactionManager(事务管理器)"></a>TransactionManager(事务管理器)</h3><ul>
<li>MyBatis 支持两种类型的事务管理器： JDBC and MANAGED.<ul>
<li>JDBC 事务管理器被用作当应用程序负责管理数据库连接的生命周期（提交、回退等等）的时候。当你将TransactionManager 属性设置成 JDBC，MyBatis 内部将使用 JdbcTransactionFactory 类创建TransactionManager。例如，部署到 Apache Tomcat 的应用程序，需要应用程序自己管理事务。</li>
<li>MANAGED 事 务 管 理 器 是 当 由 应 用 服 务 器 负 责 管 理 数 据 库 连 接 生 命 周 期 的 时 候 使 用 。 当 你将TransactionManager 属性设置成 MANAGED 时，MyBatis 内部使用 ManagedTransactionFactory 类创建事务管理器TransactionManager。例如，当一个 JavaEE 的应用程序部署在类似 JBoss，WebLogic，GlassFish 应用服务器上时，它们会使用 EJB 进行应用服务器的事务管理能力。在这些管理环境中，你可以使用 MANAGED 事务管理器。<blockquote>
<p>Managed 是托管的意思，即是应用本身不去管理事务，而是把事务管理交给应用所在的服务器进行管理。</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="Properties-属性"><a href="#Properties-属性" class="headerlink" title="Properties(属性)"></a>Properties(属性)</h3><p>属性配置元素可以将配置值具体化到一个属性文件中，，并且使用属性文件的 key 名作为占位符。在上述的配置中，我们将数据库连接属性具体化到了 application.properties 文件中，并且为 driver，URL 等属性使用了占位符。</p>
<p><strong>1. 在 applications.properties 文件中配置数据库连接参数，如下所示：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localhost:3306/mybatisdemo</span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=admin</span><br></pre></td></tr></table></figure></p>
<p><strong>2. 在 mybatis-config.xml 文件中，为属性使用 application.properties 文件中定义的占位符：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties resource=&quot;application.properties&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;jdbc.username&quot; value=&quot;db_user&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;jdbc.password&quot; value=&quot;verysecurepwd&quot; /&gt;</span><br><span class="line">&lt;/properties&gt;</span><br><span class="line">&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driverClassName&#125;&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</span><br><span class="line">&lt;/dataSource&gt;</span><br></pre></td></tr></table></figure></p>
<p>并且，你可以在<properties>元素中配置默认参数的值。如果<properties>中定义的元素和属性文件定义元素的 key<br>值相同，它们会被属性文件中定义的值覆盖。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties resource=&quot;application.properties&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;jdbc.username&quot; value=&quot;db_user&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;jdbc.password&quot; value=&quot;verysecurepwd&quot; /&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure></properties></properties></p>
<p>这里，如果 application.properties 文件包含值 jdbc.username 和 jdbc.password，则上述定义的 username 和<br>password 的值 db_user 和 verysecurepwd 将会被 application.properties 中定义的对应的 jdbc.username 和<br>jdbc.password 值覆盖。</p>
<h3 id="typeAliases-类型别名"><a href="#typeAliases-类型别名" class="headerlink" title="typeAliases(类型别名)"></a>typeAliases(类型别名)</h3><p>在 SQLMapper 配置文件中，对于 resultType 和 parameterType 属性值，我们需要使用 JavaBean 的完全限定名。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;int&quot; resultType=&quot;com.mybatis3.domain.Student&quot;&gt;</span><br><span class="line">       SELECT STUD_ID AS ID, NAME, EMAIL, DOB FROM STUDENTS WHERE STUD_ID=#&#123;Id&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">&lt;update id=&quot;updateStudent&quot; parameterType=&quot;com.mybatis3.domain. Student&quot;&gt;</span><br><span class="line">       UPDATE STUDENTS SET NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;, DOB=#&#123;dob&#125; WHERE STUD_ID=#&#123;id&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></p>
<p>这里我们为 resultType 和 parameterType 属性值设置为 Student 类型的完全限定名： com.mybatis3.domain.Student</p>
<p>我们可以为完全限定名取一个别名（alias），然后其需要使用完全限定名的地方使用别名，而不是到处使用完全限定<br>名。如下例子所示，为完全限定名起一个别名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;typeAliases&gt;</span><br><span class="line">    &lt;typeAlias alias=&quot;Student&quot; type=&quot;com.mybatis3.domain.Student&quot; /&gt;</span><br><span class="line">    &lt;typeAlias alias=&quot;Tutor&quot; type=&quot;com.mybatis3.domain.Tutor&quot; /&gt;</span><br><span class="line">    &lt;package name=&quot;com.mybatis3.domain&quot; /&gt;</span><br><span class="line">&lt;/typeAliases&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后在 SQL Mapper 映射文件中, 如下使用 Student 的别名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;int&quot; resultType=&quot;Student&quot;&gt;</span><br><span class="line">    SELECT STUD_ID AS ID, NAME, EMAIL, DOB FROM STUDENTS WHERE STUD_ID=#&#123;id&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">&lt;update id=&quot;updateStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">    UPDATE STUDENTS SET NAME=#&#123;name&#125;, EMAIL=#&#123;email&#125;, DOB=#&#123;dob&#125; WHERE STUD_ID=#&#123;id&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></p>
<p>你可以不用为每一个 JavaBean 单独定义别名, 你可以为提供需要取别名的 JavaBean 所在的包(package)，MyBatis<br>会自动扫描包内定义的 JavaBeans，然后分别为 JavaBean 注册一个小写字母开头的非完全限定的类名形式的别名。如下所<br>示，提供一个需要为 JavaBeans 起别名的包名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;typeAliases&gt;</span><br><span class="line">    &lt;package name=&quot;com.mybatis3.domain&quot; /&gt;</span><br><span class="line">&lt;/typeAliases&gt;</span><br></pre></td></tr></table></figure></p>
<p>如果 Student.java 和 Tutor.java Bean 定义在 com.mybatis3.domain 包中，则 com.mybatis3.domain.Student<br>的别名会被注册为 student。而 com.mybatis3.domain.Tutor 别名将会被注册为 tutor。示例如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;typeAliases&gt;</span><br><span class="line">    &lt;typeAlias alias=&quot;Student&quot; type=&quot;com.mybatis3.domain.Student&quot; /&gt;</span><br><span class="line">    &lt;typeAlias alias=&quot;Tutor&quot; type=&quot;com.mybatis3.domain.Tutor&quot; /&gt;</span><br><span class="line">    &lt;package name=&quot;com.mybatis3.domain&quot; /&gt;</span><br><span class="line">    &lt;package name=&quot;com.mybatis3.webservices.domain&quot; /&gt;</span><br><span class="line">&lt;/typeAliases&gt;</span><br></pre></td></tr></table></figure></p>
<p>还有另外一种方式为 JavaBeans 起别名，使用注解@Alias:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Alias(&quot;StudentAlias&quot;)</span><br><span class="line">public class Student&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>@Alias 注解将会覆盖配置文件中的<typealiases>定义。</typealiases></p>
<h3 id="typeHandlers-类型处理器"><a href="#typeHandlers-类型处理器" class="headerlink" title="typeHandlers ( 类型处理器)"></a>typeHandlers ( 类型处理器)</h3><p>如上一章已经讨论过，MyBatis 通过抽象 JDBC 来简化了数据持久化逻辑的实现。MyBatis 在其内部使用 JDBC，提供<br>了更简洁的方式实现了数据库操作。<br>当 MyBatis 将一个 Java 对象作为输入参数执行 INSERT 语句操作时，它会创建一个 PreparedStatement 对象，并且<br>使用 setXXX()方式对占位符设置相应的参数值。<br>这里，XXX 可以是 Int，String，Date 等 Java 对象属性类型的任意一个。示例如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">    INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,DOB) VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;dob&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>为执行这个语句，MyBatis 将采取以下一系列动作：</strong><br><strong>1. 创建一个有占位符的 PreparedStatement 接口，如下：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement pstmt = connection.prepareStatement</span><br><span class="line">(&quot;INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,DOB) VALUES(?,?,?,?)&quot;);</span><br></pre></td></tr></table></figure></p>
<p><strong>检查 Student 对象的属性 studId 的类型，然后使用合适 setXXX 方法去设置参数值。这里 studId 是 integer<br>类型，所以会使用 setInt()方法：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pstmt.setInt(1,student.getStudId());</span><br></pre></td></tr></table></figure></p>
<p><strong>3. 类似地，对于 name 和 email 属性都是 String 类型，MyBatis 使用 setString()方法设置参数。</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pstmt.setString(2, student.getName());</span><br><span class="line">pstmt.setString(3, student.getEmail());</span><br></pre></td></tr></table></figure></p>
<p><strong>4. 至于 dob 属性, MyBatis 会使用 setDate() 方法设置 dob 处占位符位置的值。</strong></p>
<p><strong>5. MyBaits 会将 java.util.Date 类型转换为 into java.sql.Timestamp 并设值：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pstmt.setTimestamp(4, new Timestamp((student.getDob()).getTime()));</span><br></pre></td></tr></table></figure></p>
<p>   厉害！ MyBatis 是怎么知道对于 Integer 类型属性使用 setInt() 和 String 类型属性使用 setString()方法呢？但<br>其实 MyBatis 是通过使用类型处理器（type handlers）来决定这么做的。</p>
<p>  MyBatis 对 于 以 下 的 类 型 使 用 内 建 的 类 型 处 理 器 ： 所 有 的 基 本 数 据 类 型 、 基 本 类 型 的 包 裹 类 型 、 byte[] 、<br>java.util.Date、java.sql.Date、java,sql.Time、java.sql.Timestamp、java 枚举类型等。所以当 MyBatis 发现<br>属性的类型属于上述类型，他会使用对应的类型处理器将值设置到 PreparedStatement 中，同样地，当从 SQL 结果集构<br>建 JavaBean 时，也有类似的过程。</p>
<p>   那如果我们给了一个自定义的对象类型，来存储存储到数据库呢？示例如下：<br>   假设表 STUDENTS 有一个 PHONE 字段，类型为 VARCHAR(15)，而 JavaBean Student 有一个 PhoneNumber 类定义类<br>型的 phoneNumber 属性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">public class PhoneNumber</span><br><span class="line">&#123;</span><br><span class="line">private String countryCode;</span><br><span class="line">private String stateCode;</span><br><span class="line">private String number;</span><br><span class="line">public PhoneNumber()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">public PhoneNumber(String countryCode, String stateCode, String</span><br><span class="line">number)</span><br><span class="line">&#123;</span><br><span class="line">this.countryCode = countryCode;</span><br><span class="line">this.stateCode = stateCode;</span><br><span class="line">this.number = number;</span><br><span class="line">&#125;</span><br><span class="line">public PhoneNumber(String string)</span><br><span class="line">&#123;</span><br><span class="line">if(string != null)</span><br><span class="line">&#123;</span><br><span class="line">String[] parts = string.split(&quot;-&quot;);</span><br><span class="line">if(parts.length &gt; 0) this.countryCode = parts[0];</span><br><span class="line">if(parts.length &gt; 1) this.stateCode = parts[1];</span><br><span class="line">if(parts.length &gt; 2) this.number = parts[2];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">public String getAsString()</span><br><span class="line">&#123;</span><br><span class="line">return countryCode + &quot;-&quot; + stateCode + &quot;-&quot; + number;</span><br><span class="line">&#125;</span><br><span class="line">// Setters and getters</span><br><span class="line">&#125;</span><br><span class="line">public class Student</span><br><span class="line">&#123;</span><br><span class="line">private Integer id;</span><br><span class="line">private String name;</span><br><span class="line">private String email;</span><br><span class="line">private PhoneNumber phone;</span><br><span class="line">// Setters and getters</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">	insert into students(name,email,phone) values(#&#123;name&#125;,#&#123;email&#125;,#&#123;phone&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>
<p>   这里，phone 参数需要传递给#{phone}；而 phone 对象是 PhoneNumber 类型。然而，MyBatis 并不知道该怎样来处<br>理这个类型的对象。</p>
<p>   为了让 MyBatis 明白怎样处理这个自定义的 Java 对象类型，如 PhoneNumber，我们可以创建一个自定义的类型处理<br>器，如下所示：</p>
<p><strong>1. MyBatis 提供了抽象类 BaseTypeHandler<t> ，我们可以继承此类创建自定义类型处理器。</t></strong></p>
<p><strong>域模型对象PhoneNumber</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.domain;</span><br><span class="line">public class PhoneNumber </span><br><span class="line">&#123;</span><br><span class="line">	private String countryCode;</span><br><span class="line">	private String stateCode;</span><br><span class="line">	private String number;</span><br><span class="line">	</span><br><span class="line">	public PhoneNumber() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public PhoneNumber(String countryCode, String stateCode, String number) &#123;</span><br><span class="line">		super();</span><br><span class="line">		this.countryCode = countryCode;</span><br><span class="line">		this.stateCode = stateCode;</span><br><span class="line">		this.number = number;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public PhoneNumber(String string) &#123;</span><br><span class="line">		if(string != null)&#123;</span><br><span class="line">			String[] parts = string.split(&quot;-&quot;);</span><br><span class="line">			if(parts.length&gt;0) this.countryCode=parts[0];</span><br><span class="line">			if(parts.length&gt;1) this.stateCode=parts[1];</span><br><span class="line">			if(parts.length&gt;2) this.number=parts[2];</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return this.getAsString();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public String getCountryCode() &#123;</span><br><span class="line">		return countryCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setCountryCode(String countryCode) &#123;</span><br><span class="line">		this.countryCode = countryCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getStateCode() &#123;</span><br><span class="line">		return stateCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setStateCode(String stateCode) &#123;</span><br><span class="line">		this.stateCode = stateCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getNumber() &#123;</span><br><span class="line">		return number;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setNumber(String number) &#123;</span><br><span class="line">		this.number = number;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getAsString() &#123;</span><br><span class="line">		return countryCode+&quot;-&quot;+stateCode+&quot;-&quot;+number;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>定义格式转换类 PhoneTypeHandler</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package org.freecode.typehandlers;</span><br><span class="line"></span><br><span class="line">import java.sql.CallableStatement;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.type.BaseTypeHandler;</span><br><span class="line">import org.apache.ibatis.type.JdbcType;</span><br><span class="line">import org.freecode.domain.PhoneNumber;</span><br><span class="line"></span><br><span class="line">public class PhoneTypeHandler extends BaseTypeHandler&lt;PhoneNumber&gt;&#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void setNonNullParameter(PreparedStatement ps, int i,</span><br><span class="line">			PhoneNumber parameter, JdbcType jdbcType) throws SQLException &#123;</span><br><span class="line">		ps.setString(i, parameter.getAsString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public PhoneNumber getNullableResult(ResultSet rs, String columnName)</span><br><span class="line">			throws SQLException &#123;</span><br><span class="line">		return new PhoneNumber(rs.getString(columnName));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public PhoneNumber getNullableResult(ResultSet rs, int columnIndex)</span><br><span class="line">			throws SQLException &#123;</span><br><span class="line">		return new PhoneNumber(rs.getString(columnIndex));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public PhoneNumber getNullableResult(CallableStatement cs, int columnIndex)</span><br><span class="line">			throws SQLException &#123;</span><br><span class="line">		return new PhoneNumber(cs.getString(columnIndex));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>我们使用 ps.setString()和 rs.getString()方法是因为 phone 列是 VARCHAR 类型。</p>
</li>
<li><p>一旦我们实现了自定义的类型处理器，我们需要在 mybatis-config.xml 中注册它：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;properties resource=&quot;application.properties&quot; /&gt;</span><br><span class="line">&lt;typeHandlers&gt;</span><br><span class="line">&lt;typeHandler handler=&quot;com.mybatis3.typehandlers. PhoneTypeHandler&quot; /&gt;</span><br><span class="line">&lt;/typeHandlers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>注册 PhoneTypeHandler 后, MyBatis 就能够将 Phone 类型的对象值存储到 VARCHAR 类型的列上。</p>
<h3 id="Settings-全局参数设置"><a href="#Settings-全局参数设置" class="headerlink" title="Settings(全局参数设置)"></a>Settings(全局参数设置)</h3><p>为满足应用特定的需求，MyBatis 默认的全局参数设置可以被覆盖(overridden)掉，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;settings&gt;</span><br><span class="line">&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;multipleResultSetsEnabled&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;useColumnLabel&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;useGeneratedKeys&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;autoMappingBehavior&quot; value=&quot;PARTIAL&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;defaultExecutorType&quot; value=&quot;SIMPLE&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;defaultStatementTimeout&quot; value=&quot;25000&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;safeRowBoundsEnabled&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;localCacheScope&quot; value=&quot;SESSION&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;OTHER&quot; /&gt;</span><br><span class="line">&lt;setting name=&quot;lazyLoadTriggerMethods&quot; value=&quot;equals,clone,hashCode ,toString&quot; /&gt;</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Mappers-SQL-映射定义"><a href="#Mappers-SQL-映射定义" class="headerlink" title="Mappers(SQL 映射定义)"></a>Mappers(SQL 映射定义)</h3><p>Mapper XML 文件中包含的 SQL 映射语句将会被应用通过使用其 statementid 来执行。我们需要在 mybatis-<br>config.xml 文件中配置 SQL Mapper 文件的位置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;mappers&gt;</span><br><span class="line">&lt;mapper resource=&quot;com/mybatis3/mappers/StudentMapper.xml&quot; /&gt;</span><br><span class="line">&lt;mapper url=&quot;file:///D:/mybatisdemo/app/mappers/TutorMapper.xml&quot; /&gt;</span><br><span class="line">&lt;mapper class=&quot;com.mybatis3.mappers.TutorMapper&quot; /&gt;</span><br><span class="line">&lt;package name=&quot;com.mybatis3.mappers&quot; /&gt;</span><br><span class="line">&lt;/mappers&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上每一个<mapper> 标签的属性有助于从不同类型的资源中加载映射 mapper：</mapper></p>
<ul>
<li>resource 属性用来指定在 classpath 中的 mapper 文件。</li>
<li>url 属性用来通过完全文件系统路径或者 web URL 地址来指向 mapper 文件</li>
<li>class 属性用来指向一个 mapper 接口</li>
<li>package 属性用来指向可以找到 Mapper 接口的包名</li>
</ul>
<h2 id="使用-Java-API-配置-MyBatis"><a href="#使用-Java-API-配置-MyBatis" class="headerlink" title="使用 Java API 配置 MyBatis"></a>使用 Java API 配置 MyBatis</h2><h2 id="自定义MyBatis-日志"><a href="#自定义MyBatis-日志" class="headerlink" title="自定义MyBatis 日志"></a>自定义MyBatis 日志</h2><p>   MyBatis 使用其内部 LoggerFactory 作为真正的日志类库使用的门面。其内部的 LaggerFactory 会将日志记录任务<br>委托给如下的所示某一个日志实现，日志记录优先级由上到下顺序递减：</p>
<ul>
<li>SLF4J</li>
<li>Apache Commons Logging</li>
<li>Log4j 2</li>
<li>Log4j</li>
<li>JDK logging</li>
</ul>
<p>如果 MyBatis 未发现上述日志记录实现，则 MyBatis 的日志记录功能无效。<br>如果你的运行环境中，在 classpath 中有多个可用的日志类库，并且你希望 MyBaits 使用某个特定的日志实现，你可以通过调用以下其中一个方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">org.apache.ibatis.logging.LogFactory.useSlf4jLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useLog4JLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useLog4J2Logging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useJdkLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useCommonsLogging();</span><br><span class="line">org.apache.ibatis.logging.LogFactory.useStdOutLogging();</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>如果你想自定义 MyBatis 日志记录，你应该在调用任何其它方法之前调用以上的其中一个方法。如果你想切换到的日志记录类库在运行时期无效，MyBatis 将会忽略这一请求。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/04/01/MyBatis 入门/" itemprop="url">
                  MyBatis 入门
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-04-01T23:44:00+08:00" content="2014-04-01">
              2014-04-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-Web/" itemprop="url" rel="index">
                    <span itemprop="name">Java Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/04/01/MyBatis 入门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/04/01/MyBatis 入门/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Hibernate 太过于庞大，作为同样的持久化ORM 框架Mybatis 就显得非常小巧灵活。</p>
<p>MyBatis 同样是简单易用的。</p>
<p>Java数据库持久化层主要两个部分：</p>
<ul>
<li>将从数据库查询到的数据生成所需要的 Java 对象</li>
<li>将 Java 对象中的数据通过 SQL 持久化到数据库中。</li>
</ul>
<h2 id="为什么-选择MyBatis"><a href="#为什么-选择MyBatis" class="headerlink" title="为什么 选择MyBatis ?"></a>为什么 选择MyBatis ?</h2><h3 id="消除大量JDBC冗余代码"><a href="#消除大量JDBC冗余代码" class="headerlink" title="消除大量JDBC冗余代码"></a>消除大量JDBC冗余代码</h3><ul>
<li>无需关注重复性JDBC操作 (不再与connection，statement，resultSet 重复性对象打交道)，MyBatis 会处理这些底层工作<blockquote>
<p>创建 Connection 连接，创建一个 Statement 对象，设置输入参数，关闭资源</p>
</blockquote>
</li>
<li>需要配置数据库连接属性和 SQL 语句。 （POJO &lt;–&gt; SQL Table）<ul>
<li>Mybatis 准备需要被执行的 SQL statement 对象并且将 Java 对象作为输入数据传递给 statement 对象的任务</li>
<li>MyBatis 自动化了将从输入的 Java 对象中的属性设置成查询参数、从 SQL 结果集上生成 Java 对象</li>
</ul>
</li>
</ul>
<p><strong>实例说明</strong><br><strong>1. 在 SQL Mapper 映射配置文件中配置 SQL 语句，假定为 StudentMapper.xml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findStudentById&quot; parameterType=&quot;int&quot; resultType=&quot;Student&quot;&gt;</span><br><span class="line">     SELECT STUD_ID AS studId, NAME, EMAIL, DOB FROM STUDENTS WHERE STUD_ID=#&#123;Id&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">     INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,DOB) VALUES(#&#123;studId&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;dob&#125;)</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>
<p><strong>2. 创建一个 StudentMapper 接口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface StudentMapper &#123;</span><br><span class="line">           Student findStudentById(Integer id);</span><br><span class="line">           void insertStudent(Student student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>3. 在 Java 代码中，你可以使用如下代码触发 SQL 语句：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = getSqlSessionFactory().openSession();</span><br><span class="line">StudentMapper mapper = session.getMapper(StudentMapper.class);</span><br><span class="line"><span class="comment">// Select Student by Id</span></span><br><span class="line">Student student = mapper.selectStudentById(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//To insert a Student record</span></span><br><span class="line">mapper.insertStudent(student);</span><br></pre></td></tr></table></figure>
<p><strong>编码完成</strong></p>
<h3 id="低学习曲线"><a href="#低学习曲线" class="headerlink" title="低学习曲线"></a>低学习曲线</h3><p><strong>你需要熟悉Java 和 SQL 即可</strong></p>
<h3 id="能够很好地与传统数据库协同工作"><a href="#能够很好地与传统数据库协同工作" class="headerlink" title="能够很好地与传统数据库协同工作"></a>能够很好地与传统数据库协同工作</h3><p>Hibernate将 Java 对象静态地映射到数据库的表上<br>MyBatis 是将查询的结果与 Java 对象映射起来。你可以根据面相对象的模型创建 Java 域对象，执行传统数据库的查询，然后将结果映射到对应的 Java 对象上。</p>
<h3 id="接受-SQL"><a href="#接受-SQL" class="headerlink" title="接受 SQL"></a>接受 SQL</h3><p>Hibernate鼓励使用实体对象（Entity Objects）和在其底层自动产生 SQL 语句。这种<br>的 SQL 生成方式，我们有可能不能够利用到数据库的一些特有的特性。Hibernate 允许执行本地 SQL，但是这样会打破持<br>久层和数据库独立的原则。</p>
<p>MyBatis 框架接受 SQL 语句，而不是将其对开发人员隐藏起来。由于 MyBatis 不会产生任何的 SQL 语句，所以开发<br>人员就要准备 SQL 语句，这样就可以充分利用数据库特有的特性并且可以准备自定义的查询。另外，MyBatis 对存储过程<br>也提供了支持。</p>
<h3 id="与Spring-集成"><a href="#与Spring-集成" class="headerlink" title="与Spring 集成"></a>与Spring 集成</h3><p>MyBatis 提供了与 流行的依赖注入框架 Spring 和 Guice 的开包即用的集成支持，这将进一步简化 MyBatis 的使用</p>
<h3 id="与第三方缓存类库的集成支持"><a href="#与第三方缓存类库的集成支持" class="headerlink" title="与第三方缓存类库的集成支持"></a>与第三方缓存类库的集成支持</h3><p>MyBatis 有内建的 SqlSession 级别的缓存机制，用于缓存 Select 语句查询出来的结果。除此之外，MyBatis 提供<br>了与多种第三方缓存类库的集成支持，如 EHCache，OSCache，Hazelcast。</p>
<h3 id="良好的性能"><a href="#良好的性能" class="headerlink" title="良好的性能"></a>良好的性能</h3><ul>
<li>MyBatis 支持数据库连接池，消除了为每一个请求创建一个数据库连接的开销</li>
<li>MyBatis 提供了内建的缓存机制，在 SqlSession 级别提供了对 SQL 查询结果的缓存。即:如果你调用了相同的select 查询，MyBatis会将放在缓存的结果返回，而不会去再查询数据库。</li>
<li>MyBatis 框架并没有大量地使用代理机制2，因此对于其他的过度地使用代理的 ORM 框架而言，MyBatis 可以获得更<br>好的性能。</li>
</ul>
<p><strong>如果你的应用是以面向对象模型，并且向动态生成 SQL 语句，那么 MyBatis可能就不符合你的要求。另外，如果你想让你的应用有一个传递性的缓存机制的话（保存父对象时也应该保存关联的子对象），Hibernate 会更适合你。</strong></p>
<h2 id="Mybatis-入门"><a href="#Mybatis-入门" class="headerlink" title="Mybatis 入门"></a>Mybatis 入门</h2><ul>
<li>Mybatis 入门   <ul>
<li>新建表 STUDENTS，插入样本数据</li>
<li>新建一个 Maven 项目，pom.xml 添加相关依赖</li>
<li>新建建 MyBatisSqlSessionFactory 单例模式类</li>
<li>新建映射器 StudentMapper 接口和 StudentService 类</li>
<li>新建一个 JUnit 测试类来测试 StudentService</li>
</ul>
</li>
</ul>
<h3 id="新建表-STUDENTS，插入样本数据"><a href="#新建表-STUDENTS，插入样本数据" class="headerlink" title="新建表 STUDENTS，插入样本数据"></a>新建表 STUDENTS，插入样本数据</h3><p><strong>使用以下 SQL 脚本往 MySQL 数据库中创建 STUDENTS 表插入样本数据：</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> STUDENTS</span><br><span class="line">(</span><br><span class="line">stud_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">email <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">dob <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (stud_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=latin1;</span><br><span class="line"><span class="comment">/*Sample Data for the students table */</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stud_id,<span class="keyword">name</span>,email,dob)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>,<span class="string">'Student1'</span>,<span class="string">'student1@gmail.com'</span>,<span class="string">'1983-06-25'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students(stud_id,<span class="keyword">name</span>,email,dob)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">2</span>,<span class="string">'Student2'</span>,<span class="string">'student2@gmail.com'</span>,<span class="string">'1983-06-25'</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="新建一个-Maven-项目，pom-xml-添加相关依赖"><a href="#新建一个-Maven-项目，pom-xml-添加相关依赖" class="headerlink" title="新建一个 Maven 项目，pom.xml 添加相关依赖"></a>新建一个 Maven 项目，pom.xml 添加相关依赖</h3><ul>
<li>创建一个名为 mybatis-demo的Maven 项目</li>
<li><p>在 pom.xml 中添加以下依赖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;3.2.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;5.1.30&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.7.5&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.7.5&lt;/version&gt;</span><br><span class="line">	&lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.2.17&lt;/version&gt;</span><br><span class="line">	&lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;4.11&lt;/version&gt;</span><br><span class="line">	&lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 log4j.properties 文件，添加到 <code>src/main/resources</code> (classpath下) 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d [%-5p] %c - %m%n</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="新建-mybatis-config-xml-和映射器-StudentMapper-xml-配置文件"><a href="#新建-mybatis-config-xml-和映射器-StudentMapper-xml-配置文件" class="headerlink" title="新建 mybatis-config.xml 和映射器 StudentMapper.xml 配置文件"></a>新建 mybatis-config.xml 和映射器 StudentMapper.xml 配置文件</h3><ul>
<li><p><strong><code>mybatis-config.xml</code> 为MyBatis的主要配置文件，其中包括数据库连接信息、类型别名等,创建并添加classpath下</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">	&lt;typeAliases&gt;</span><br><span class="line">		&lt;typeAlias alias=&quot;Student&quot; type=&quot;org.freecode.domain.Student&quot; /&gt;</span><br><span class="line">	&lt;/typeAliases&gt;</span><br><span class="line">	&lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">		&lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">			&lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">			&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">				&lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">				&lt;property name=&quot;password&quot; value=&quot;123456&quot; /&gt;</span><br><span class="line">			&lt;/dataSource&gt;</span><br><span class="line">		&lt;/environment&gt;</span><br><span class="line">	&lt;/environments&gt;</span><br><span class="line">	&lt;mappers&gt;</span><br><span class="line">		&lt;mapper resource=&quot;or/freecode/mappers/StudentMapper.xml&quot; /&gt;</span><br><span class="line">	&lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><code>StudentMapper.xml</code> 实体映射SQL语句文件，并将其放入自定义mapper目录下。（org.freecode.mappers）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;org.freecode.mappers.StudentMapper&quot;&gt;</span><br><span class="line">	&lt;resultMap type=&quot;Student&quot; id=&quot;StudentResult&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;studId&quot; column=&quot;stud_id&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;name&quot; column=&quot;name&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;email&quot; column=&quot;email&quot; /&gt;</span><br><span class="line">		&lt;result property=&quot;dob&quot; column=&quot;dob&quot; /&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">	&lt;select id=&quot;findAllStudents&quot; resultMap=&quot;StudentResult&quot;&gt;</span><br><span class="line">		SELECT * FROM STUDENTS</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;select id=&quot;findStudentById&quot; parameterType=&quot;int&quot; resultType=&quot;Student&quot;&gt;</span><br><span class="line">		SELECT STUD_ID AS STUDID, NAME, EMAIL, DOB</span><br><span class="line">		FROM STUDENTS WHERE STUD_ID=#&#123;Id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;insert id=&quot;insertStudent&quot; parameterType=&quot;Student&quot;&gt;</span><br><span class="line">		INSERT INTO STUDENTS(STUD_ID,NAME,EMAIL,DOB)</span><br><span class="line">		VALUES(#&#123;studId &#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;dob&#125;)</span><br><span class="line">	&lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="新建-MyBatisSqlSessionFactory-单例类"><a href="#新建-MyBatisSqlSessionFactory-单例类" class="headerlink" title="新建 MyBatisSqlSessionFactory 单例类"></a>新建 MyBatisSqlSessionFactory 单例类</h3><p><strong>新建 MyBatisSqlSessionFactory.java 类文件，实例化它，使其持有一个 SqlSessionFactory 单例对象：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.util;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line">public class MyBatisSqlSessionFactory &#123;</span><br><span class="line"></span><br><span class="line">	private static SqlSessionFactory sqlSessionFactory;</span><br><span class="line">	public static SqlSessionFactory getSqlSessionFactory()&#123;</span><br><span class="line">		if(sqlSessionFactory == null)&#123;</span><br><span class="line">			InputStream inputStream;</span><br><span class="line">			try&#123;</span><br><span class="line">				inputStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">				</span><br><span class="line">				sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">			&#125;catch(IOException e)&#123;</span><br><span class="line">				throw new RuntimeException(e.getCause());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return sqlSessionFactory;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public static SqlSession openSession()&#123;</span><br><span class="line">		return getSqlSessionFactory().openSession();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>上述的代码段中，我们创建了一个 SqlSessionFactory 对象，我们将使用它来获得 SqlSession 对象和执行映射的SQL 语句。</strong></p>
<h3 id="新建-StudentMapper-接口和-StudentService-类"><a href="#新建-StudentMapper-接口和-StudentService-类" class="headerlink" title="新建 StudentMapper 接口和 StudentService 类"></a>新建 StudentMapper 接口和 StudentService 类</h3><p>让我们创建一个 StudentMapper 接口，其定义的方法名和在 Mapper XML 配置文件定义的 SQL 映射语句名称相同；<br>在创建一个 StudentService.java 类，包含了一些业务操作的实现。</p>
<ul>
<li><p>首先，创建JavaBean Student.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.domain;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">public class Student &#123;</span><br><span class="line">	private Integer studId;</span><br><span class="line">	private String name;</span><br><span class="line">	private String email;</span><br><span class="line">	private Date dob;</span><br><span class="line">	public Integer getStudId() &#123;</span><br><span class="line">		return studId;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setStudId(Integer studId) &#123;</span><br><span class="line">		this.studId = studId;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getName() &#123;</span><br><span class="line">		return name;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setName(String name) &#123;</span><br><span class="line">		this.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getEmail() &#123;</span><br><span class="line">		return email;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setEmail(String email) &#123;</span><br><span class="line">		this.email = email;</span><br><span class="line">	&#125;</span><br><span class="line">	public Date getDob() &#123;</span><br><span class="line">		return dob;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setDob(Date dob) &#123;</span><br><span class="line">		this.dob = dob;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public String toString() &#123;</span><br><span class="line">		return &quot;Student [studId=&quot; + studId + &quot;, name=&quot; + name + &quot;, email=&quot;</span><br><span class="line">				+ email + &quot;, dob=&quot; + dob + &quot;]&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建映射器 Mapper 接口 StudentMapper.java 其方法签名和 StudentMapper.xml 中定义的 SQL 映射定义名相同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.mappers;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line">import org.freecode.domain.Student;</span><br><span class="line"></span><br><span class="line">public interface StudentMapper &#123;</span><br><span class="line">	List&lt;Student&gt; findAllStudents();</span><br><span class="line">	Student findStudentById(Integer id);</span><br><span class="line">	void insertStudent(Student student);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 StudentService.java 实现对表 STUDENTS 的数据库操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.services;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.freecode.domain.Student;</span><br><span class="line">import org.freecode.mappers.StudentMapper;</span><br><span class="line">import org.freecode.util.MyBatisSqlSessionFactory;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class StudentService &#123;</span><br><span class="line">	private Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line">	</span><br><span class="line">	public List&lt;Student&gt; findAllStudents()&#123;</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		try&#123;</span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			return studentMapper.findAllStudents();</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			// 如果sqlSession 没有关闭， 数据库连接不会返回到连接池(pool)中</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public Student findStudentById(Integer studId)&#123;</span><br><span class="line">		logger.debug(&quot;Select Student By ID :&#123;&#125;&quot;,studId);</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		try&#123;</span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			return studentMapper.findStudentById(studId);</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public void createStudent(Student student)&#123;</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		try&#123;</span><br><span class="line">			StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line">			studentMapper.insertStudent(student);</span><br><span class="line">			sqlSession.commit();</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/**</span><br><span class="line">	 * 你也可以不通过Mapper接口执行映射的SQL语句,如下。（并不推荐）</span><br><span class="line">	 * @param studId</span><br><span class="line">	 * @return</span><br><span class="line">	 */</span><br><span class="line">	public Student findStudentById2(Integer studId)&#123;</span><br><span class="line">		SqlSession sqlSession = MyBatisSqlSessionFactory.openSession();</span><br><span class="line">		try&#123;</span><br><span class="line">			return (Student)sqlSession.selectOne(&quot;org.freecode.mappers.StudentMapper.findStudentById&quot;,studId);</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			sqlSession.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="新建一个-JUnit-测试类来测试-StudentService"><a href="#新建一个-JUnit-测试类来测试-StudentService" class="headerlink" title="新建一个 JUnit 测试类来测试 StudentService"></a>新建一个 JUnit 测试类来测试 StudentService</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">package org.freecode.services;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.freecode.domain.Student;</span><br><span class="line">import org.junit.AfterClass;</span><br><span class="line">import org.junit.Assert;</span><br><span class="line">import org.junit.BeforeClass;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">public class StudentServiceTest &#123;</span><br><span class="line"></span><br><span class="line">	private static StudentService studentService;</span><br><span class="line">	</span><br><span class="line">	@BeforeClass</span><br><span class="line">	public static void setup()&#123;</span><br><span class="line">		studentService = new StudentService();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@AfterClass</span><br><span class="line">	public static void teardown()&#123;</span><br><span class="line">		studentService = null;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testFindAllStudents()&#123;</span><br><span class="line">		List&lt;Student&gt; students = studentService.findAllStudents();</span><br><span class="line">		Assert.assertNotNull(students);</span><br><span class="line">		for (Student student : students)&#123;</span><br><span class="line">			System.out.println(student);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testFindStudentById()&#123;</span><br><span class="line">		Student student = studentService.findStudentById(3);</span><br><span class="line">		Assert.assertNotNull(student);</span><br><span class="line">		System.out.println(student);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testCreateStudent()&#123;</span><br><span class="line">		Student student = new Student();</span><br><span class="line">		int id = 3;</span><br><span class="line">		student.setStudId(id);</span><br><span class="line">		student.setName(&quot;student_&quot; + id);</span><br><span class="line">		student.setEmail(&quot;student_&quot; + id + &quot;gmail.com&quot;);</span><br><span class="line">		student.setDob(new Date());</span><br><span class="line">		studentService.createStudent(student);</span><br><span class="line">		Student newStudent = studentService.findStudentById(id);</span><br><span class="line">		Assert.assertNotNull(newStudent);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="它是怎么工作的？"><a href="#它是怎么工作的？" class="headerlink" title="它是怎么工作的？"></a>它是怎么工作的？</h3><ul>
<li>首先，我们配置了 MyBatis 最主要的配置文件-mybatis-config.xml,里面包含了 JDBC 连接参数；配置了映射器Mapper XML 配置文件文件，里面包含了 SQL 语句的映射。</li>
<li>我 们 使 用 mybatis-config.xml 内 的 信 息 创 建 了 SqlSessionFactory 对 象 。 每 个 数 据 库 环 境 应 该 就 一 个SqlSessionFactory 对象实例，所以我们使用了单例模式只创建一个 SqlSessionFactory 实例。</li>
<li>我们创建了一个映射器 Mapper 接口-StudentMapper，其定义的方法签名和在 StudentMapper.xml 中定义的完全一样（即映射器 Mapper 接口中的方法名跟 StudentMapper.xml 中的 id 的值相同）。注意 StudentMapper.xml 中namespace 的值被设置成 org.freecode.mappers.StudentMapper，是 StudentMapper 接口的完全限定名。这使我们可以使用接口来调用映射的 SQL 语句。</li>
<li>在 StudentService.java 中，我们在每一个方法中创建了一个新的 SqlSession，并在方法功能完成后关闭SqlSession。每一个线程应该有它自己的 SqlSession 实例。SqlSession 对象实例不是线程安全的，并且不被共享。所以 SqlSession 的作用域最好就是其所在方法的作用域。从 Web 应用程序角度上看，SqlSession 应该存在于 request 级别作用域上。</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/03/11/Git 遇到的异常/" itemprop="url">
                  Git 遇到的异常
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-03-11T22:53:00+08:00" content="2014-03-11">
              2014-03-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/版本控制/" itemprop="url" rel="index">
                    <span itemprop="name">版本控制</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/03/11/Git 遇到的异常/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/03/11/Git 遇到的异常/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>更新于 ：2015-12-14 17:50:00</strong></p>
<p><strong>总结 在使用Git 进行版本控制遇到错误及其相关解决方案，并持续更新</strong></p>
<h2 id="1-Everything-is-update"><a href="#1-Everything-is-update" class="headerlink" title="1.Everything is update"></a>1.Everything is update</h2><h3 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>git push origin master 的时候出现Everything is update</strong></p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>使用git commit -am “xxxx”</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git commit -am &quot;modify of part&quot;</span><br><span class="line">git origin master</span><br></pre></td></tr></table></figure></p>
<h2 id="2-Note-about-fast-forwards-rejected"><a href="#2-Note-about-fast-forwards-rejected" class="headerlink" title="2.Note about fast-forwards (! [rejected])"></a>2.Note about fast-forwards (! [rejected])</h2><h3 id="错误信息-1"><a href="#错误信息-1" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin hexo</span><br><span class="line">To git@github.com:cmp-cc/cmp-cc.github.io.git</span><br><span class="line"> ! [rejected]        hexo -&gt; hexo (fetch first)</span><br><span class="line">error: failed to push some refs to &apos;git@github.com:cmp-cc/cmp-cc.github.io.git&apos;</span><br><span class="line">hint: Updates were rejected because the remote contains work that you do</span><br><span class="line">hint: not have locally. This is usually caused by another repository pushing</span><br><span class="line">hint: to the same ref. You may want to first integrate the remote changes</span><br><span class="line">hint: (e.g., &apos;git pull ...&apos;) before pushing again.</span><br><span class="line">hint: See the &apos;Note about fast-forwards&apos; in &apos;git push --help&apos; for details.</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>一、使用强制push的方法 （不推荐）：</strong><br>这样会使远程修改丢失，一般是不可取的，尤其是多人协作开发的时候，单人协助无所谓。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master -f</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>二、老老实实的merge 分支。（推荐）</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git pull origin master</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>三、使用<code>git pull --rebase</code> 将本地与远程进行同步（等价于第二种）</strong><br><strong><code>git push --rebase</code> 的含义</strong></p>
<ul>
<li>把本地 repo. 从上次 pull 之后的变更暂存起來</li>
<li>恢复到上次 pull 时的状态</li>
<li>合并远端的变更到本地</li>
<li>最后再合并刚刚暂存下來的本地变更</li>
</ul>
<h2 id="3-push之后不能访问文件-文件状态为灰色"><a href="#3-push之后不能访问文件-文件状态为灰色" class="headerlink" title="3.push之后不能访问文件(文件状态为灰色)"></a>3.push之后不能访问文件(文件状态为灰色)</h2><h3 id="错误信息-2"><a href="#错误信息-2" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>如下，处于不可打开状态，如果你把整个项目clone下来，你会发现文件为空</strong></p>
<img src="/2014/03/11/Git%20遇到的异常/4D44727A1CED48A6AF27443A6F1A36D7.png" alt="文件显示状态" title="文件显示状态">
<h3 id="解决方案-2"><a href="#解决方案-2" class="headerlink" title="解决方案"></a>解决方案</h3><p>你可能需要了解一下<code>git submodule</code>的使用,就知道问题所在了。(git项目中的子目录存在一个git仓库)</p>
<ul>
<li>将子目录中的<code>.git</code>目录删掉</li>
<li>删除子模块子目录</li>
<li>再执行<code>git push</code> 操作<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached ./themes/next</span><br><span class="line">git add --all</span><br><span class="line">git commit -m &quot;delete child module&quot;</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>可参考：<a href="http://stackoverflow.com/questions/19584255/what-does-a-grey-icon-in-remote-github-mean" target="_blank" rel="external">http://stackoverflow.com/questions/19584255/what-does-a-grey-icon-in-remote-github-mean</a></p>
<h2 id="pull没有更新（-See-git-pull-1-for-details-）"><a href="#pull没有更新（-See-git-pull-1-for-details-）" class="headerlink" title="pull没有更新（ See git-pull(1) for details ）"></a>pull没有更新（ See git-pull(1) for details ）</h2><h3 id="错误信息-3"><a href="#错误信息-3" class="headerlink" title="错误信息"></a>错误信息</h3><p><strong>这个算不上错误，问题是这样的：你有两个分支A 和 B。当前分支为B，你执行git pull 操作，他却pull了A而不是B</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ git pull</span><br><span class="line">remote: Counting objects: 174, done.</span><br><span class="line">remote: Compressing objects: 100% (95/95), done.</span><br><span class="line">remote: Total 174 (delta 61), reused 0 (delta 0), pack-reused 0</span><br><span class="line">Receiving objects: 100% (174/174), 251.93 KiB | 206.00 KiB/s, done.</span><br><span class="line">Resolving deltas: 100% (61/61), done.</span><br><span class="line">   69cc25b..1b24763  master     -&gt; origin/master</span><br><span class="line">There is no tracking information for the current branch.</span><br><span class="line">Please specify which branch you want to merge with.</span><br><span class="line">See git-pull(1) for details</span><br><span class="line"></span><br><span class="line">    git pull &lt;remote&gt; &lt;branch&gt;</span><br><span class="line"></span><br><span class="line">If you wish to set tracking information for this branch you can do so with:</span><br><span class="line"></span><br><span class="line">    git branch --set-upstream-to=origin/&lt;branch&gt; stream</span><br></pre></td></tr></table></figure></p>
<h3 id="解决方案-3"><a href="#解决方案-3" class="headerlink" title="解决方案"></a>解决方案</h3><p><strong>进行本地分支和远程分支关联</strong><br><code>git branch --set-upstream-to=origin/&lt;branch&gt; master</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch --set-upstream-to=origin/stream stream</span><br></pre></td></tr></table></figure></p>
<p>参考：<a href="http://www.tbdazhe.com/archives/238" target="_blank" rel="external">http://www.tbdazhe.com/archives/238</a></p>
<h2 id="Unlink-of-file-‘xxx’-failed-Should-I-try-again"><a href="#Unlink-of-file-‘xxx’-failed-Should-I-try-again" class="headerlink" title="Unlink of file ‘xxx’ failed. Should I try again?"></a>Unlink of file ‘xxx’ failed. Should I try again?</h2><h3 id="错误信息-4"><a href="#错误信息-4" class="headerlink" title="错误信息"></a>错误信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error: refusing to lose untracked file at &apos;stream/next/bower.json&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/_config.yml&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/README.md&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.jshintrc&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.javascript_ignore&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.hound.yml&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.gitignore&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.editorconfig&apos;</span><br><span class="line">error: refusing to lose untracked file at &apos;stream/next/.bowerrc&apos;</span><br><span class="line">Unlink of file &apos;stream/next&apos; failed. Should I try again? (y/n)</span><br></pre></td></tr></table></figure>
<h3 id="解决方案-4"><a href="#解决方案-4" class="headerlink" title="解决方案"></a>解决方案</h3><p>出现这种问题，通常意味这有一个进程仍在使用特定的文件，急需要关闭其它程序，然后在尝试执行<code>git pull</code></p>
<p>参考：<a href="http://stackoverflow.com/questions/10181057/unlink-of-file-failed" target="_blank" rel="external">http://stackoverflow.com/questions/10181057/unlink-of-file-failed</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/03/HTML5 语义化标签/" itemprop="url">
                  HTML5 语义化标签
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-01-03T16:43:00+08:00" content="2014-01-03">
              2014-01-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/01/03/HTML5 语义化标签/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/03/HTML5 语义化标签/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间看了一本《HTML5 实战》 ，也只是为了关注一下HTML5的发展和趋势。</p>
<p>看的我头大，这本书只是做个了HTML5的介绍，算不上实战，很多例子含糊不清。</p>
<p>HTML5 中新的语义化标签，还是让我眼前一亮。</p>
<h2 id="HTML5-中的新特性"><a href="#HTML5-中的新特性" class="headerlink" title="HTML5 中的新特性"></a>HTML5 中的新特性</h2><p><strong>HTML5 中的核心特性，先记录一下,方便日后查阅</strong></p>
<ul>
<li>新的语义化标签</li>
<li>表单与表单API</li>
<li>Canvas API</li>
<li>拖放 API</li>
<li>地理位置 API</li>
<li>WEB存储 API</li>
<li>IndexedDB API</li>
<li>文件</li>
<li>通信API</li>
<li>WEB workers API</li>
<li>历史 API</li>
<li>脱机 API</li>
</ul>
<h2 id="HTML5-语义化标签"><a href="#HTML5-语义化标签" class="headerlink" title="HTML5 语义化标签"></a>HTML5 语义化标签</h2><h3 id="HTML-结构语义"><a href="#HTML-结构语义" class="headerlink" title="HTML 结构语义"></a>HTML 结构语义</h3><p><strong>HTML 整体结构所需的标签语义</strong></p>
<table>
<thead>
<tr>
<th>标签</th>
<th>语义</th>
</tr>
</thead>
<tbody>
<tr>
<td>header</td>
<td>这个元素表示一组介绍性的内容，适用于文档的不同节，他既可以包含节标题，也可以包含索引、搜索表单、logo等</td>
</tr>
<tr>
<td>nav</td>
<td>这个元素表示包含导航链接的节，如菜单或索引，并非所有的网页链接都要加<nav>元素中，只有主要的导航块才需要加到元素中。</nav></td>
</tr>
<tr>
<td>section</td>
<td>这个元素表示文档中的普通的节，通常，它可用于创建多个内容块（如：列） 从而对具有特定主题的内容进行分组，如图书的章</td>
</tr>
<tr>
<td>aside</td>
<td>这个元素表示与内容相关但不属于它的内容，如：引用，边侧栏，广告</td>
</tr>
<tr>
<td>footer</td>
<td>这个元素表示与父级元素相关的额外信息。</td>
</tr>
<tr>
<td>article</td>
<td>这个元素表示重要信息的独立部分–例如，报纸上或博客中的文章，<article>可以嵌套，也可以用于在相关项列表中显示一个</article></td>
</tr>
<tr>
<td>hgroup</td>
<td>如果有多级标题，请使用。</td>
</tr>
<tr>
<td>figure</td>
<td>这个元素表示主内容引用内容独立部分(图像，图表，视频)，这个信息可以从主内容删除，而不会影响其常规流。</td>
</tr>
<tr>
<td>figcaption</td>
<td>这个元素可以用于显示表题，或者与figure 一起用，例如： 图形的描述信息。</td>
</tr>
<tr>
<td>mark</td>
<td>这个元素可以突出显示特殊情况下的重要文字，或者是对应的用户输入。</td>
</tr>
<tr>
<td>small</td>
<td>这个元素表示边侧评论，如附属细则(负责声明，法律限制，版权)</td>
</tr>
<tr>
<td>cite</td>
<td>这个元素可以用于显示作品标题(图书、电影、诗歌)</td>
</tr>
<tr>
<td>address</td>
<td>显示article或者整个文档的合同信息，且应该位于footer中。</td>
</tr>
<tr>
<td>time</td>
<td>显示人和机器可读的日期和时间。 datetime属性，pubdate表示出版日期</td>
</tr>
</tbody>
</table>
<h3 id="HTML-文档语义"><a href="#HTML-文档语义" class="headerlink" title="HTML 文档语义"></a>HTML 文档语义</h3><p><strong>HTML 作用于文本标签语义</strong></p>
<table>
<thead>
<tr>
<th>标签</th>
<th>语义</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>定义日期或时间</td>
</tr>
<tr>
<td>em</td>
<td>强调</td>
</tr>
<tr>
<td>strong</td>
<td>重要</td>
</tr>
<tr>
<td>small</td>
<td>旁注</td>
</tr>
<tr>
<td>cite</td>
<td>作品引用 （标题）</td>
</tr>
<tr>
<td>q</td>
<td>引用</td>
</tr>
<tr>
<td>dfn</td>
<td>举例</td>
</tr>
<tr>
<td>abbr</td>
<td>缩写</td>
</tr>
<tr>
<td>code</td>
<td>计算机代码</td>
</tr>
<tr>
<td>var</td>
<td>变量</td>
</tr>
<tr>
<td>samp</td>
<td>计算机输出</td>
</tr>
<tr>
<td>kbd</td>
<td>用户输入</td>
</tr>
<tr>
<td>sub</td>
<td>下标</td>
</tr>
<tr>
<td>sup</td>
<td>上标</td>
</tr>
<tr>
<td>i</td>
<td>备选项 大部分用于发言、技术短语等情况。</td>
</tr>
<tr>
<td>b</td>
<td>关键字 表示在不增加额外重要性的同时将词或短语高亮显示</td>
</tr>
<tr>
<td>mart</td>
<td>高亮</td>
</tr>
<tr>
<td>ruby、rb、rt、rp</td>
<td>注释 [一种排版注释系统(位于横排文本上方的简短文字)]</td>
</tr>
<tr>
<td>bdi</td>
<td>文本方向间离</td>
</tr>
<tr>
<td>bdo</td>
<td>文本方向格式</td>
</tr>
<tr>
<td>span</td>
<td>其他</td>
</tr>
<tr>
<td>br</td>
<td>换行</td>
</tr>
<tr>
<td>wbr</td>
<td>可选折行 [长单词的破择号 (让浏览器决定是否换行)]</td>
</tr>
<tr>
<td>h1 ~ h6</td>
<td>一级标题 至 六级标题</td>
</tr>
<tr>
<td>figure、figcaption</td>
<td>figure 独立的流（图片、图像、图表）figcaption 标题</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/12/14/贫血模型和充血模型/" itemprop="url">
                  贫血模型和充血模型
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-12-14T16:53:00+08:00" content="2013-12-14">
              2013-12-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/架构设计/" itemprop="url" rel="index">
                    <span itemprop="name">架构设计</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/12/14/贫血模型和充血模型/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/12/14/贫血模型和充血模型/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>大多数情况下，我忍不住赋予Model行为，我并不知道它是否合理，了解一下领域模型中的贫血模型和充血模型，无意中发现还有胀血模型和失血模型。 如下是自己（cmp-cc）的理解：</p>
<h2 id="模型-（Model）"><a href="#模型-（Model）" class="headerlink" title="模型 （Model）"></a>模型 （Model）</h2><ul>
<li>无论是贫血模型还是充血模型，他们都符合POJO （也可以认为JavaBean）。<br><strong>Model包含属性的<code>get</code>、<code>set</code>方法</strong></li>
<li>模型的本质充当数据容器（保存状态，传递状态）。<br><strong>模型是一种特殊的数据结构</strong></li>
</ul>
<h2 id="失血模型"><a href="#失血模型" class="headerlink" title="失血模型"></a>失血模型</h2><p><strong>失血模型就是POJO对象，模型仅仅包含数据的定义和getter/setter方法，业务逻辑和应用逻辑都放到服务层（Service）中。</strong> </p>
<p>层次表示：</p>
<blockquote>
<p>UI(视图层) -&gt; Control(控制层) -&gt; Service（服务层） -&gt; DAO （持久化层） -&gt;domain object （领域对象 Model ）</p>
</blockquote>
<ul>
<li>领域对象不具备任何行为（仅仅是一个POJO对象），所有的行为都在Service层。</li>
<li>领域对象的作用。<ul>
<li>充当数据容器。</li>
<li>对象关系映射（ORM）</li>
</ul>
</li>
<li>这种模型很容易理解和掌握。</li>
<li>优点<ul>
<li>层次结构清晰，单项依赖，易于维护。</li>
</ul>
</li>
<li>缺点<ul>
<li>Service 层挤压严重。（业务逻辑职责） </li>
<li>部分与数据操作相关的行为，必须通过Service层进行修改。</li>
</ul>
</li>
</ul>
<h2 id="贫血模型"><a href="#贫血模型" class="headerlink" title="贫血模型"></a>贫血模型</h2><p><strong>贫血模型中包含了一些业务逻辑，但不包含依赖持久层的业务逻辑。这部分依赖于持久层的业务逻辑将会放到服务层中。</strong></p>
<p>层次表示：</p>
<blockquote>
<p>UI(视图层) -&gt; Control(控制层) -&gt; Service（服务层） -&gt; DAO （持久化层） -&gt;domain object （Model）</p>
</blockquote>
<ul>
<li>继承失血模型特性</li>
<li>领域对象具备简单行为，如下特点。<ul>
<li>行为不具备持久化特性。（不与数据库打交道，也就是不依赖于DAO层）</li>
<li>具备与数据相关的业务行为。（部分Service行为 移至 Model）</li>
</ul>
</li>
<li>同样与失血模型同样的痛处<ul>
<li>系统越复杂，维护成本越高，Service层（业务逻辑）挤压严重。</li>
</ul>
</li>
</ul>
<h2 id="充血模型"><a href="#充血模型" class="headerlink" title="充血模型"></a>充血模型</h2><p>**充血模型中包含了所有的业务逻辑，包括依赖于持久层的业务逻辑。所以，使用充血模型的领域层是依赖于持久层。</p>
<p>层次表示：</p>
<blockquote>
<p>UI -&gt; Control -&gt; Service -&gt; domain object &lt;–&gt; DAO</p>
</blockquote>
<ul>
<li>Service 层被减轻，不和DAO打交道，只包含业务逻辑。</li>
<li>领域对象 和 DAO 双向依赖。</li>
<li>优点<ul>
<li>减轻了Service层。</li>
</ul>
</li>
<li>缺点<ul>
<li>Service 将直接依赖于领域对象。 领域对象同样具备部分业务，可能会造成职责混乱，或者使领域对象不具备业务I行为</li>
<li>领域对象与DAO双向依赖，部分职责容易混响。</li>
</ul>
</li>
</ul>
<h2 id="胀血模型"><a href="#胀血模型" class="headerlink" title="胀血模型"></a>胀血模型</h2><p><strong>胀血模型就是把和业务逻辑不想关的其他应用逻辑（如授权、事务等）都放到领域模型中。我感觉胀血模型反而是另外一种的失血模型，因为服务层消失了，领域层干了服务层的事，到头来还是什么都没变。</strong></p>
<p>层次表示：</p>
<blockquote>
<p>UI -&gt; Control -&gt; domain object &lt;–&gt; DAO</p>
</blockquote>
<ul>
<li>没有了服务层，领域对象包含所有业务逻辑，并双向依赖与持久化层。</li>
<li>优点<ul>
<li>分层极其简单</li>
</ul>
</li>
<li>缺点<ul>
<li>领域对象职责过多，挤压严重，极其不稳定，不易维护。</li>
<li>控制层访问领域对象能够看到不必要的行为。</li>
</ul>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>失血模型和胀血模型并不被提倡，主要原因：领域模型内聚职责过少，或者过多。<br>关于贫血模型和充血模型的选型，其实跟语言架构有关（Robin提出）：</p>
<ul>
<li>如果使用Spring，必须贫血模型。</li>
<li>如果使用RoR，直接充血模型。</li>
</ul>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="http://blog.csdn.net/always_my_fault/article/details/2063612" target="_blank" rel="external">http://blog.csdn.net/always_my_fault/article/details/2063612</a><br><a href="http://www.oschina.net/question/54100_10400" target="_blank" rel="external">http://www.oschina.net/question/54100_10400</a><br><a href="http://www.360doc.com/content/12/0423/03/9318309_205785083.shtml" target="_blank" rel="external">http://www.360doc.com/content/12/0423/03/9318309_205785083.shtml</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/11/25/Linux iptable 防火墙/" itemprop="url">
                  Linux iptable 防火墙
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-11-25T23:23:00+08:00" content="2013-11-25">
              2013-11-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/操作系统/" itemprop="url" rel="index">
                    <span itemprop="name">操作系统</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/11/25/Linux iptable 防火墙/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/11/25/Linux iptable 防火墙/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>Linux 环境下，默认使用的防火墙都是用iptable，同样也是服务器名称</strong></p>
<h2 id="iptable-服务"><a href="#iptable-服务" class="headerlink" title="iptable 服务"></a>iptable 服务</h2><p><strong>iptable 基本服务命令</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">service  iptables  start           开启防火墙</span><br><span class="line">service  iptables  stop           关闭防火墙</span><br><span class="line">service  iptables  restart        重启防火墙</span><br><span class="line">service  iptables save            保持iptable 配置</span><br><span class="line">service  iptables  status        查看防火墙状态</span><br></pre></td></tr></table></figure></p>
<h2 id="iptable-基本语法"><a href="#iptable-基本语法" class="headerlink" title="iptable 基本语法"></a>iptable 基本语法</h2><h3 id="防火墙处理数据4中方式"><a href="#防火墙处理数据4中方式" class="headerlink" title="防火墙处理数据4中方式"></a>防火墙处理数据4中方式</h3><ul>
<li>ACCEPT<br>允许数据包通过</li>
<li>DROP<br>直接丢弃数据包，不给予响应</li>
<li>REJECT<br>拒绝数据包通过，给予响应</li>
<li>LOG<br><code>/var/log/messages</code>文件记录日志信息</li>
</ul>
<h3 id="iptable-参数"><a href="#iptable-参数" class="headerlink" title="iptable 参数"></a>iptable 参数</h3><table>
<thead>
<tr>
<th>参数缩写</th>
<th>参数全称</th>
<th>参数解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>-A</td>
<td>–append</td>
<td>在指定链的末尾添加一条新的规则</td>
</tr>
<tr>
<td>-D</td>
<td>–delete</td>
<td>删除指定链中的某一条规则，可以按规则序号和内容删除</td>
</tr>
<tr>
<td>-I</td>
<td>–insert</td>
<td>在指定链中插入一条新的规则，默认在第一行添加</td>
</tr>
<tr>
<td>-R</td>
<td>–replace</td>
<td>修改、替换指定链中的某一条规则，可以按规则序号和内容替换</td>
</tr>
<tr>
<td>-L</td>
<td>–list</td>
<td>列出指定链中所有的规则进行查看</td>
</tr>
<tr>
<td>-E</td>
<td>–rename-chain</td>
<td>重命名用户定义的链，不改变链本身</td>
</tr>
<tr>
<td>-F</td>
<td>–flush</td>
<td>清空</td>
</tr>
<tr>
<td>-N</td>
<td>–new-chain</td>
<td>新建一条用户自己定义的规则链</td>
</tr>
<tr>
<td>-X</td>
<td>–delete-chain</td>
<td>删除指定表中用户自定义的规则链</td>
</tr>
<tr>
<td>-P</td>
<td>–policy</td>
<td>设置指定链的默认策略</td>
</tr>
<tr>
<td>-Z</td>
<td>–zero</td>
<td>将所有表的所有链的字节和数据包计数器清零</td>
</tr>
<tr>
<td>-n</td>
<td>–numeric</td>
<td>使用数字形式显示输出结果</td>
</tr>
<tr>
<td>-v</td>
<td>–verbose</td>
<td>查看规则表详细信息的信息</td>
</tr>
<tr>
<td>-V</td>
<td>–version</td>
<td>查看版本</td>
</tr>
<tr>
<td>-h</td>
<td>–help</td>
<td>获取帮助</td>
</tr>
</tbody>
</table>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -n    // 查看防火墙配置</span><br><span class="line">iptables -nL --line-number  // 查看iptables规则及编号</span><br></pre></td></tr></table></figure>
<h3 id="开放一个端口"><a href="#开放一个端口" class="headerlink" title="开放一个端口"></a>开放一个端口</h3><p><strong>开启8000端口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -p tcp --dport 8000 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<h3 id="删除一个规则"><a href="#删除一个规则" class="headerlink" title="删除一个规则"></a>删除一个规则</h3><p>删除一个开放的端口规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -n --line-number     // 查看规则编号</span><br><span class="line"></span><br><span class="line">iptables -D INPUT 2  // 删除指定规则编号，如 2</span><br></pre></td></tr></table></figure></p>
<h3 id="只开放某个端口"><a href="#只开放某个端口" class="headerlink" title="只开放某个端口"></a>只开放某个端口</h3><p><strong>只开放80端口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp –dport 80 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p tcp –sport 80 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<h3 id="禁止某个IP地址"><a href="#禁止某个IP地址" class="headerlink" title="禁止某个IP地址"></a>禁止某个IP地址</h3><p><strong>禁止192.168.12.13访问</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -s 192.168.12.13 -j DROP</span><br></pre></td></tr></table></figure></p>
<h3 id="关闭所有的-INPUT-FORWARD-OUTPUT"><a href="#关闭所有的-INPUT-FORWARD-OUTPUT" class="headerlink" title="关闭所有的 INPUT FORWARD OUTPUT"></a>关闭所有的 INPUT FORWARD OUTPUT</h3><p>关闭所有的INPUT FORWARD、 OUTPUT的所有端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P FORWARD DROP</span><br><span class="line">iptables -P OUTPUT DROP</span><br></pre></td></tr></table></figure></p>
<h2 id="手工配置iptable"><a href="#手工配置iptable" class="headerlink" title="手工配置iptable"></a>手工配置iptable</h2><h3 id="iptable-配置文件"><a href="#iptable-配置文件" class="headerlink" title="iptable 配置文件"></a>iptable 配置文件</h3><p>iptable配置文件默认地址为：<code>/etc/sysconfig/iptables</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure></p>
<p>执行如上命令显示如下iptables配置信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Firewall configuration written by system-config-firewall</span><br><span class="line"># Manual customization of this file is not recommended.</span><br><span class="line">*filter</span><br><span class="line">:INPUT ACCEPT [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 6379 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 7474 -j ACCEPT</span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure></p>
<h3 id="开放特定端口"><a href="#开放特定端口" class="headerlink" title="开放特定端口"></a>开放特定端口</h3><p>如下开放1517端口，将其复制到iptable 配置文件中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 1517 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<p>然后执行如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">serivce iptables save       保持防火墙设置</span><br><span class="line">service iptables restart     重启防火墙</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/10/16/Maven 服务器插件Jetty/" itemprop="url">
                  Maven 服务器插件Jetty
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-10-16T08:54:00+08:00" content="2013-10-16">
              2013-10-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/项目构建/" itemprop="url" rel="index">
                    <span itemprop="name">项目构建</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/10/16/Maven 服务器插件Jetty/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/10/16/Maven 服务器插件Jetty/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一个常规的Java Web 你需要部署到Tomcat中，使用Maven构建Web项目使用Jetty 容器，使运行Java Web项目更加方便。</p>
<h2 id="Jetty-完整性配置"><a href="#Jetty-完整性配置" class="headerlink" title="Jetty 完整性配置"></a>Jetty 完整性配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;webapp.port&gt;8083&lt;/webapp.port&gt;</span><br><span class="line">    &lt;webapp.stopPort&gt;9090&lt;/webapp.stopPort&gt;</span><br><span class="line">    &lt;webapp.path&gt;/&lt;/webapp.path&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jetty-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;8.1.13.v20130916&lt;/version&gt;</span><br><span class="line">    &lt;configuration&gt;</span><br><span class="line">        &lt;webAppConfig&gt;</span><br><span class="line">            &lt;contextPath&gt;$&#123;webapp.path&#125;&lt;/contextPath&gt;</span><br><span class="line">            &lt;defaultsDescriptor&gt;webdefault.xml&lt;/defaultsDescriptor&gt;</span><br><span class="line">        &lt;/webAppConfig&gt;</span><br><span class="line">        &lt;connectors&gt;</span><br><span class="line">            &lt;connector implementation=&quot;org.eclipse.jetty.server.nio.SelectChannelConnector&quot;&gt;</span><br><span class="line">                &lt;port&gt;$&#123;webapp.port&#125;&lt;/port&gt;</span><br><span class="line">                &lt;maxIdleTime&gt;60000&lt;/maxIdleTime&gt;</span><br><span class="line">            &lt;/connector&gt;</span><br><span class="line">        &lt;/connectors&gt;</span><br><span class="line">        &lt;reload&gt;automatic&lt;/reload&gt;</span><br><span class="line">        &lt;scanIntervalSeconds&gt;0&lt;/scanIntervalSeconds&gt;</span><br><span class="line">        &lt;!-- stopPort&gt;$&#123;webapp.stopPort&#125;&lt;/stopPort --&gt;</span><br><span class="line">        &lt;systemProperties&gt;</span><br><span class="line">            &lt;systemProperty&gt;</span><br><span class="line">                &lt;name&gt;org.mortbay.util.URI.charset&lt;/name&gt;</span><br><span class="line">                &lt;value&gt;UTF-8&lt;/value&gt;</span><br><span class="line">            &lt;/systemProperty&gt;</span><br><span class="line">        &lt;/systemProperties&gt;</span><br><span class="line">        &lt;jvmArgs&gt;-Xmx512m -XX:PermSize=128m -XX:MaxPermSize=256m</span><br><span class="line">            -Dfile.encoding=UTF-8&lt;/jvmArgs&gt;</span><br><span class="line">    &lt;/configuration&gt;</span><br><span class="line">    &lt;executions&gt;</span><br><span class="line">        &lt;execution&gt;</span><br><span class="line">            &lt;id&gt;start-jetty&lt;/id&gt;</span><br><span class="line">            &lt;phase&gt;pre-integration-test&lt;/phase&gt;</span><br><span class="line">            &lt;goals&gt;</span><br><span class="line">                &lt;goal&gt;run&lt;/goal&gt;</span><br><span class="line">            &lt;/goals&gt;</span><br><span class="line">            &lt;configuration&gt;</span><br><span class="line">                &lt;scanIntervalSeconds&gt;0&lt;/scanIntervalSeconds&gt;</span><br><span class="line">                &lt;daemon&gt;true&lt;/daemon&gt;</span><br><span class="line">            &lt;/configuration&gt;</span><br><span class="line">        &lt;/execution&gt;</span><br><span class="line">        &lt;execution&gt;</span><br><span class="line">            &lt;id&gt;stop-jetty&lt;/id&gt;</span><br><span class="line">            &lt;phase&gt;post-integration-test&lt;/phase&gt;</span><br><span class="line">            &lt;goals&gt;</span><br><span class="line">                &lt;goal&gt;stop&lt;/goal&gt;</span><br><span class="line">            &lt;/goals&gt;</span><br><span class="line">        &lt;/execution&gt;</span><br><span class="line">    &lt;/executions&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>运行命令 <code>jetty:run</code></li>
<li>停止运行<code>jetty:stop</code></li>
</ul>
<h2 id="Jetty-可配置参数"><a href="#Jetty-可配置参数" class="headerlink" title="Jetty 可配置参数"></a>Jetty 可配置参数</h2><ul>
<li>scanIntervalSeconds 表示扫时间，避免重复运行，它会自动检测是否修改项目文件</li>
<li>jvmArgs JVM 堆栈大小</li>
<li>port 端口号</li>
<li>contextPath 项目路径</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/08/12/Java项目开发中的简称/" itemprop="url">
                  Java项目开发中的简称
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-08-12T14:13:00+08:00" content="2013-08-12">
              2013-08-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/架构设计/" itemprop="url" rel="index">
                    <span itemprop="name">架构设计</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/08/12/Java项目开发中的简称/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/08/12/Java项目开发中的简称/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Java项目开发中的简称，这些简称尤其应用到Java项目分层上。 传统的MVC，可以能只是三层架构。分为View、Control、Model。 有些简写的分层，在看别人代码的时候，可能一下反应不过来它是干什么的？ 这里仔细总结一下，我觉得非常有用，它使我们的代码结构更加清晰。</p>
<p>大部分的缩写源于： 领域模型驱动（DDD）。</p>
<p>大致如下缩写：</p>
<ul>
<li>POJO (Plain Ordinary Java Object) 简单java对象</li>
<li>DAO (Data Access Object) 数据访问对象</li>
<li>DTO (Data Transfer Object) 数据传输对象</li>
<li>VO (View Object) 值对象</li>
<li>BO (Business Object) 业务对象</li>
<li>PO (Persistant Object) 持久化对象</li>
</ul>
<p>参考了一些文章，加上自己的理解</p>
<p>首先要理解什么是JavaBean 、Model、Entity</p>
<ul>
<li>JavaBean<br><strong>JavaBean是一种规范，也即包含一组set和get方法的Java对象。Model、Entity、POJO、DTO、BO都属于JavaBean，因为他们符合这种规范。</strong><br><strong>JavaBean分为业务Bean和数据Bean。数据Bean其实就Entity(实体对象)，业务Bean 就是（BO 业务对象）</strong></li>
<li>Model<br><strong>Model是MVC概念之一。也就是Model层用于存储实体对象（Entity）。Model通常 等价于Entity 用DAO层持久化对象</strong></li>
<li>Entity<br><strong>Entity 为实体对象。你把它就做POJO、Model、JavaBean，也没人敢说你一定错误。他主要作用为数据（数据库数据）做持久化。 一旦将数据库中的一条数据存储Entity中，你把它叫做PO对象，也是对的。他只是 领域模型驱动中的概念之一</strong></li>
</ul>
<h2 id="简单java对象-POJO"><a href="#简单java对象-POJO" class="headerlink" title="简单java对象 (POJO)"></a>简单java对象 (POJO)</h2><p>普通的Java对象，对于属性一般实现了JavaBean的标准，另外还可以包含一些简单的业务逻辑(方法)。</p>
<p>一个POJO持久化以后就是PO<br>直接用它传递、传递过程中就是DTO<br>直接用来对应表示层就是VO</p>
<h2 id="数据访问对象-DAO"><a href="#数据访问对象-DAO" class="headerlink" title="数据访问对象 (DAO)"></a>数据访问对象 (DAO)</h2><ul>
<li>DAO 数据访问对象，主要用于封装数据库的访问，通过它可以把POJO持久化为PO，用PO组装出来VO、DTO。</li>
<li>我们还会把DAO叫做持久化层。</li>
</ul>
<h2 id="数据传输对象-DTO"><a href="#数据传输对象-DTO" class="headerlink" title="数据传输对象 (DTO)"></a>数据传输对象 (DTO)</h2><p>Data Transfer Object数据传输对象</p>
<ul>
<li>DTO的概念是J2EE提出，主要用于分布式应用，用于服务之间的数据传输。</li>
<li>分布式应用（JSONP、RCP、RMI等 远程方法或过程调用）之间的数据传输对象使用DTO。</li>
<li>单系统中用于展示层与服务层之间的数据传输</li>
</ul>
<h2 id="值对象-VO"><a href="#值对象-VO" class="headerlink" title="值对象 (VO)"></a>值对象 (VO)</h2><p>ViewObject表现层对象 （展示层）</p>
<ul>
<li>主要对应界面显示的数据值对象。它包含了界面（Web、Mobile、PC）所请求的数据信息。</li>
<li>VO的数据值可以是一个或多个Model的子集或交集，主要目的构成响应（Response）所要展示的内容信息。</li>
<li>VO值对象会转换为JSON、XML、HTML等格式返回给请求者。</li>
</ul>
<h2 id="业务对象-BO"><a href="#业务对象-BO" class="headerlink" title="业务对象 (BO)"></a>业务对象 (BO)</h2><p>business object业务对象</p>
<ul>
<li>主要作用是把业务逻辑封装为一个对象。这个对象可以包括一个或多个其它的对象。<br>eg:<br>比如一个简历，有教育经历、工作经历、社会关系等等。<br>我们可以把教育经历对应一个PO，工作经历对应一个PO，社会关系对应一个PO。<br>建立一个对应简历的BO对象处理简历，每个BO包含这些PO。<br>这样处理业务逻辑时，我们就可以针对BO去处理。</li>
</ul>
<h2 id="持久化对象-PO"><a href="#持久化对象-PO" class="headerlink" title="持久化对象 (PO)"></a>持久化对象 (PO)</h2><ul>
<li>最形象的理解就是一个PO就是数据库中的一条记录。 （好处是可以把一条记录作为一个对象处理，可以方便的转为其它对象。）</li>
</ul>
<img src="/2013/08/12/Java项目开发中的简称/2013-02-12-java.png" alt="整体的结构图" title="整体的结构图">
<p>总结：</p>
<ul>
<li>领域模型可以使得责任更加明确。</li>
<li>有时候避免过度设计<br>不要陷入过度设计，大可不必为了设计而设计一定要在代码中区分各个对象,一句话技术是为应用服务的。</li>
</ul>
<p>参考</p>
<p><a href="http://www.blogjava.net/vip01/archive/2007/01/08/92430.html" target="_blank" rel="external">http://www.blogjava.net/vip01/archive/2007/01/08/92430.html</a><br><a href="http://b-l-east.iteye.com/blog/1142800" target="_blank" rel="external">http://b-l-east.iteye.com/blog/1142800</a><br><a href="http://www.blogjava.net/johnnylzb/archive/2010/05/27/321968.html" target="_blank" rel="external">http://www.blogjava.net/johnnylzb/archive/2010/05/27/321968.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/03/05/JSPServlet3.0总结/" itemprop="url">
                  JSP/Servlet3.0总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-03-05T19:53:00+08:00" content="2013-03-05">
              2013-03-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-Web/" itemprop="url" rel="index">
                    <span itemprop="name">Java Web</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/03/05/JSPServlet3.0总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/03/05/JSPServlet3.0总结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>总结下一JSP/Servlet3.0，记性不好，记录一下，容易反查。</p>
<h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><h3 id="JSP-注释"><a href="#JSP-注释" class="headerlink" title="JSP 注释"></a>JSP 注释</h3><h4 id="一种显示注释和三种隐式注释"><a href="#一种显示注释和三种隐式注释" class="headerlink" title="一种显示注释和三种隐式注释"></a>一种显示注释和三种隐式注释</h4><p>JSP中有两种注释方式：</p>
<ul>
<li><p>显示注释<br><strong>显示注释就是HTML注释方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 注释内容 --&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>隐式注释<br><strong>JSP 注释方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- 注释内容 --%&gt;</span><br></pre></td></tr></table></figure>
<p><strong>单行注释</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">// 注释内容</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p><strong>多行注释</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">/*</span><br><span class="line">1.注释内容</span><br><span class="line">2.注释内容</span><br><span class="line">*/</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="显示注释和隐式注释的区别"><a href="#显示注释和隐式注释的区别" class="headerlink" title="显示注释和隐式注释的区别"></a>显示注释和隐式注释的区别</h4><p>Servlet渲染页面的过程如下：</p>
<blockquote>
<p>JSP -&gt; Servlet -&gt; HTML</p>
</blockquote>
<p>显示注释和隐式注释的区别:<br><strong>渲染为HTML页面后，显示注释的内容会显示到页面中，而隐式注释不会显示到页面中。</strong></p>
<h3 id="Scriptle-脚本片段"><a href="#Scriptle-脚本片段" class="headerlink" title="Scriptle 脚本片段"></a>Scriptle 脚本片段</h3><p>我们将JSP中写Java代码片段（代码块）理解为Scriptle 脚本片段 。Scriptle 脚本片段我们考虑如下三种情况：</p>
<ul>
<li><p>局部代码块<br><strong>通过<code>&lt;% Java %&gt;</code> 进行局部代码编写</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">StringBuffer sb = new StringBuffer();</span><br><span class="line">// TODO</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>全局变量和方法<br><strong>通过<code>&lt;%！ Java %&gt;</code> 进行全局代码编写</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">String user = &quot;root&quot;;</span><br><span class="line">String password = &quot;123456&quot;;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>输出<br><strong>这里的输出要理解为渲染，它并不是将内容输出到控制台，而是渲染到页面上。  （特别说明）</strong><br><strong>输出有两种方式</strong></p>
<ul>
<li><p>通过<code>&lt;%= 内容 %&gt;</code> 进行内容输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%=</span><br><span class="line">&quot;&lt;p&gt;cmp-cc.github.io 是一个Blog &lt;/p&gt;&quot;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过<code>&lt;% out.println(&quot;内容&quot;) %&gt;</code> 进行内容输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;% </span><br><span class="line">out.println(&quot;cmp-cc.github.io 是一个Blog&quot;);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="Scriptlet-标签"><a href="#Scriptlet-标签" class="headerlink" title="Scriptlet 标签"></a>Scriptlet 标签</h3><p>HTML 中有Tag标签，每一标签有它特殊的含义和用途，JSP同样可以引入标签，我们称为：Scriptlet 标签 。<br>Scriptlet 标签是用来取代&lt;%%&gt; 这种形式，使得页面展示更加友好。</p>
<p>吧啦吧啦！！！！  （一大堆使用Scriptlet 标签 取代 &lt;%%&gt; 的好处）。</p>
<p>Scriptlet 标签基本写法：<br><strong>这里是JSP标签，很多标签的写法是一致的</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:scriptle&gt;</span><br><span class="line">            </span><br><span class="line">&lt;/jsp:scriptle&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h3><p>  JSP指令用来设置与整个JSP页面相关的属性，它并不直接产生任何可见的输出,而只是告诉引擎如何处理其余JSP页面。</p>
<p>其一般语法形式为：  &lt;%@ 指令名称 属性=”值” %&gt;</p>
<p>三种命令指令分别是</p>
<ul>
<li>page<br><strong>设定整个JSP网页的静态属性</strong></li>
<li>include<br><strong>include指令用来向当前页面插入一个静态文件的内容。这个文件可以是JSP、HTML、文本或是Java程序</strong></li>
<li>taglib<br><strong>使用标签库定义新的自定义标签，在JSP页面中启用定制行为</strong></li>
</ul>
<h4 id="page-指令-（页面指令）"><a href="#page-指令-（页面指令）" class="headerlink" title="page 指令 （页面指令）"></a>page 指令 （页面指令）</h4><p>作用： 设定整个JSP网页的静态属性<br>语法：键值对，空格分割。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot;</span><br><span class="line">    pageEncoding=&quot;utf-8&quot;%&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>page指令属性</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>autoFlush</td>
<td>满缓冲刷新，否异常 默认true</td>
</tr>
<tr>
<td>buffer</td>
<td>指定输出模式缓冲流，none 无，指定数值，大于此值，与上一起用，默认大于8kb</td>
</tr>
<tr>
<td>contentType</td>
<td>定义字符编码和页面响应MIME类型：contentType=”text/html;charset=GBK”</td>
</tr>
<tr>
<td>errorPage</td>
<td>错误跳转页面errorPage=”error.jsp” 与isErrorPage同用</td>
</tr>
<tr>
<td>extends</td>
<td>定义JSP页面产生的Servlet 类的扩展， extends=””</td>
</tr>
<tr>
<td>import</td>
<td>import=”java.util.*”</td>
</tr>
<tr>
<td>info</td>
<td>此JSP信息 info=”info.exe”</td>
</tr>
<tr>
<td>isErrorPage</td>
<td>设置true或false</td>
</tr>
<tr>
<td>isThreadSafe</td>
<td>此页面是否是线程安全的，true，表示一个JSP页面可以处理多个用户，false， 一次只能处理一个用户。</td>
</tr>
<tr>
<td>language</td>
<td>用来定义使用的脚本语言, language=”java”</td>
</tr>
<tr>
<td>pageEncoding</td>
<td>JSP页面的字节编码 pageEncoding=”utf-8”</td>
</tr>
<tr>
<td>session</td>
<td>指定所在页面是否参与HTTP对话，默认:true</td>
</tr>
</tbody>
</table>
<p><strong>实例代码</strong></p>
<ul>
<li>引入ArrayList 和 StringTokenizer<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot;</span><br><span class="line">    pageEncoding=&quot;utf-8&quot;%&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.util.ArrayList,java.util.StringTokenizer;&quot; %&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="include-（包含指令）"><a href="#include-（包含指令）" class="headerlink" title="include （包含指令）"></a>include （包含指令）</h4><p><strong>包含指令的用法非常简单，因为它只有一个属性</strong><br>作用： include指令用来向当前页面插入一个静态文件的内容。这个文件可以是JSP、HTML、文本或是Java程序<br>语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@include file=&quot;文件路径&quot;%&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>注意：</strong><br>1、include 属于静态包含。（先包含后处理）<br>2、如果直接以文件名开头,指的是正在使用的JSP文件所在的路径,如果以/开头,指的是正在使用的JSP文件上下的路径关系(相对于WEB应用的根目录。)</p>
<p><strong>实例</strong></p>
<ul>
<li>index.jsp 引入 home.jsp<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ include file=&quot;home.jsp&quot;%&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="taglib-（标签指令）"><a href="#taglib-（标签指令）" class="headerlink" title="taglib （标签指令）"></a>taglib （标签指令）</h4><p>当页面引用了用户自定义标签时，taglib指令用于引用自定义标签库，并指定标签的前缀。<br>JSP内置的标签，我们称为JSP标签。</p>
<p>作用：使用标签库定义新的自定义标签，在JSP页面中启用定制行为。<br>语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=&quot;URIToTagLibrary&quot; prefix=&quot;tagPrefix&quot; %&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>taglib 指令属性</strong><br>属性 | 说明<br>— | —<br>uri | 定位标签库描述符的位置。唯一标识和前缀相关的标签库描述符，可以使用绝对或相对URL。<br>tagDir | 指示前缀将被用于标识在WEV-INF/tags目录下的标签文件。<br>prefix | 标签的前缀，区分多个自定义标签。不可以使用保留前缀和空前缀，遵循XML命名空间的命名约定。</p>
<p><strong>实例</strong></p>
<ul>
<li>引入JSTL 标签库<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;taglib uri=&quot;http://java.sun.com /jsp/jstl/core&quot; prefix=&quot;c&quot; /&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="JSP-内置标签"><a href="#JSP-内置标签" class="headerlink" title="JSP 内置标签"></a>JSP 内置标签</h3><p><strong>JSP 一共有13个内置标签，他们用于完成不同的功能</strong><br><strong>暂略</strong></p>
<h4 id="静态包含和动态包含的区别"><a href="#静态包含和动态包含的区别" class="headerlink" title="静态包含和动态包含的区别"></a>静态包含和动态包含的区别</h4><ul>
<li><p>写法</p>
<ul>
<li><p>静态包含<br>静态包含就是使用包含指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@include file=&quot;文件路径&quot;%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>动态包含<br>使用JSP标签 <jsp:include></jsp:include></p>
</li>
</ul>
</li>
<li><p>区别：</p>
<ul>
<li>静态包含<br><strong>执行时间是在编译阶段执行，引入的内容为静态文件，在编译成servlet时就和包含者融合到一起,最后生成HTML</strong></li>
<li>动态包含<br><strong>执行时间是在请求阶段执行，引入的内容在执行页面时被请求时动态生成再包含到页面中。</strong></li>
</ul>
</li>
</ul>
<h3 id="JSP-内置对象"><a href="#JSP-内置对象" class="headerlink" title="JSP 内置对象"></a>JSP 内置对象</h3><h4 id="JSP-九种内置对象"><a href="#JSP-九种内置对象" class="headerlink" title="JSP 九种内置对象"></a>JSP 九种内置对象</h4><p><strong>JSP 内置九种内置对象，你并不需要使用include 去引入它</strong></p>
<table>
<thead>
<tr>
<th>对象名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>pageContext</td>
<td>JSP的页面容器</td>
</tr>
<tr>
<td>request</td>
<td>得到用户的请求信息</td>
</tr>
<tr>
<td>response</td>
<td>服务器向用户的回应信息</td>
</tr>
<tr>
<td>session</td>
<td>用来保存内一个用户信息</td>
</tr>
<tr>
<td>application</td>
<td>表示所有用户的共享信息</td>
</tr>
<tr>
<td>config</td>
<td>服务器配置，可以去的初始值参数页面输出</td>
</tr>
<tr>
<td>out</td>
<td>页面输出</td>
</tr>
<tr>
<td>page</td>
<td>表示从页面中表示出来的一个Servlet实例</td>
</tr>
<tr>
<td>exception</td>
<td>表示JSP页面所发生异常，在错误页面才起作用</td>
</tr>
</tbody>
</table>
<h4 id="JSP-四种属性范围"><a href="#JSP-四种属性范围" class="headerlink" title="JSP 四种属性范围"></a>JSP 四种属性范围</h4><p><strong>这里涉及JSP页面请求的生命周期,  暂略</strong></p>
<table>
<thead>
<tr>
<th>作用范围名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>page</td>
<td>只在一个页面中保存属性，跳转之后无效。（使用pageContext表示）</td>
</tr>
<tr>
<td>request</td>
<td>再一次请求中保存属性，服务器跳转后依然有效。</td>
</tr>
<tr>
<td>session</td>
<td>再一次会话范围中保存，无论何种跳转都可以使用，但是新开浏览器无法使用。</td>
</tr>
<tr>
<td>application</td>
<td>在整个服务器上保存，所有用户都可以使用。</td>
</tr>
</tbody>
</table>
<h3 id="JSP-JavaBean"><a href="#JSP-JavaBean" class="headerlink" title="JSP JavaBean"></a>JSP JavaBean</h3><p><strong>JSP 使用使用JavaBean，除了可以使用&lt;%User user = new User();%&gt;的方式，大多数使用<code>&lt;jsp:useBean&gt;</code>标签</strong></p>
<ul>
<li><p>写法<br><strong>它会按照按名称完成自动匹配</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:useBean id=&quot;实例化对象名称&quot; scope=&quot;保存范围&quot; class=&quot;包.类名称&quot;/&gt;</span><br><span class="line">&lt;jsp:setProperty name=&quot;javabean对象&quot; property=&quot;*&quot;/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用参数 <jsp:property></jsp:property></p>
<ul>
<li><code>&lt;jsp:setProperty name=&quot;id&quot; property=&quot;*&quot;/&gt;</code>  </li>
<li><code>&lt;jsp:setProperty name=&quot;id&quot; property=&quot;属性名称&quot;/&gt;</code></li>
<li><code>&lt;jsp:setProperty name=&quot;id&quot; property=&quot;属性名称&quot; param=&quot;参数名称&quot;/&gt;</code></li>
<li><code>&lt;jsp:setProperty name=&quot;id&quot; property=&quot;属性名称&quot; param=&quot;参数名称&quot; value=&quot;内容&quot;/&gt;</code></li>
</ul>
</li>
<li><p>获得属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:getProperty name=&quot;实例化对象名称&quot; property=&quot;属性名称&quot;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>JavaBean的保存范围</p>
<ul>
<li>page </li>
<li>request </li>
<li>session </li>
<li>application</li>
</ul>
</li>
<li>JavaBean删除<br><strong>作用域范围.removeAttribute(JavaBean名称)，必须根据设置的范围删除</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pageContext.removeAttribute(&quot;javabean&quot;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h2><p><strong>这里简单总结</strong></p>
<h3 id="Servlet-基础"><a href="#Servlet-基础" class="headerlink" title="Servlet 基础"></a>Servlet 基础</h3><h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><p>Servlet 生命周期如下：</p>
<blockquote>
<p>加载 -&gt; 初始化 -&gt; 服务 -&gt; 销毁 -&gt; 卸载</p>
</blockquote>
<h4 id="内置方法"><a href="#内置方法" class="headerlink" title="内置方法"></a>内置方法</h4><table>
<thead>
<tr>
<th>方法名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>init()</td>
<td>Servlet初始化调用</td>
</tr>
<tr>
<td>init(ServletConfig)</td>
<td>Servlet初始化调用，ServletConfig读取配置信息</td>
</tr>
<tr>
<td>service()</td>
<td>Servlet服务，一般不会直接覆写此方法，而是使用doGet()或doPost()方法</td>
</tr>
<tr>
<td>destroy()</td>
<td>Servlet销毁时调用</td>
</tr>
</tbody>
</table>
<h4 id="web-xml-配置Servlet，并附加初始值"><a href="#web-xml-配置Servlet，并附加初始值" class="headerlink" title="web.xml 配置Servlet，并附加初始值"></a>web.xml 配置Servlet，并附加初始值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;                                         定义&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;xxxx&lt;/servlet-name&gt;             与servlet-mapping对应</span><br><span class="line">    &lt;servlet-class&gt;                               定义包.类名称</span><br><span class="line">    io.github.cmp-cc.xxxx</span><br><span class="line">  &lt;/servlet-class&gt;</span><br><span class="line">  &lt;init-param&gt;                                    配置参数，可配置多个</span><br><span class="line">    &lt;param-name&gt;ref&lt;/param-name&gt;                  参数名称</span><br><span class="line">    &lt;param-value&gt;值&lt;/param-value&gt;                 参数内容</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;                                 映射路径</span><br><span class="line">  &lt;servlet-name&gt;xxxx&lt;/servlet-name&gt;               与servlet相对应</span><br><span class="line">  &lt;url-pattern&gt;/xxx&lt;/url-pattern&gt;                 页面映射路径</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<p><strong>Servlet 获取初始值</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Congif.getinitParameter（&quot;ref&quot;）取出</span><br></pre></td></tr></table></figure></p>
<h4 id="获取HttpSession、ServletContext-实例"><a href="#获取HttpSession、ServletContext-实例" class="headerlink" title="获取HttpSession、ServletContext 实例"></a>获取HttpSession、ServletContext 实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getSession（）              // 返回当前session</span><br><span class="line">getSession（boolean）       // 返回当前session，是否新建。</span><br><span class="line">getServletContext（）       // 取得ServletContext对象</span><br></pre></td></tr></table></figure>
<h4 id="请求转发与重定向"><a href="#请求转发与重定向" class="headerlink" title="请求转发与重定向"></a>请求转发与重定向</h4><h5 id="请求转发与重定向的区别"><a href="#请求转发与重定向的区别" class="headerlink" title="请求转发与重定向的区别"></a>请求转发与重定向的区别</h5><ul>
<li>请求转发<br><strong>调用者与被调用者之间共享相同的request对象和response对象，他们属于同一个访问请求和响应过程，我们可以称之为<code>服务器跳转</code></strong></li>
<li>重定向<br><strong>调用者与被调用者,不共享属性和方法，等同于点击一个URL。 我们称之为<code>客户端跳转</code></strong><h5 id="请求转发与重定向的用法"><a href="#请求转发与重定向的用法" class="headerlink" title="请求转发与重定向的用法"></a>请求转发与重定向的用法</h5></li>
<li><p>重定向（客户点跳转）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect（&quot;success.jsp&quot;）;</span><br></pre></td></tr></table></figure>
</li>
<li><p>请求转发（服务端跳转）<br><strong>有两个方法用于请求转发</strong></p>
<ul>
<li><p>forward(req,res);        页面跳转    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.getRequestDispatcher(&quot;success.jsp&quot;).forward(request,response);</span><br></pre></td></tr></table></figure>
</li>
<li><p>include(req.res)       页面包含</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.getRequestDispatcher(&quot;main.jsp&quot;).include(request, response);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="forward-和-include-区别"><a href="#forward-和-include-区别" class="headerlink" title="forward 和 include 区别"></a>forward 和 include 区别</h4><ul>
<li>forward方法是把请求的内容转发到另外的一个servlet.</li>
<li>include是把另一个servlet处理过后的结果内容拿过来.<h3 id="Servlet-过滤器"><a href="#Servlet-过滤器" class="headerlink" title="Servlet 过滤器"></a>Servlet 过滤器</h3>Servlet 自定义过滤器需要两个步骤</li>
<li><p>1、实现Filter接口</p>
<ul>
<li><p>Filter 方法<br>方法名称 | 说明<br>— | —<br>init（FilterConfig）| 过滤器初始化<br>doFilter(req,res)  |  完成过滤操作，然后通过FilterChain传递<br>destroy() | 过滤器消亡，执行方法</p>
</li>
<li><p>实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  private String encodeString;</span><br><span class="line"></span><br><span class="line">//初始化方法</span><br><span class="line">@Override</span><br><span class="line">public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class="line">  // 获取Web.xml 中配置的属性值</span><br><span class="line">  encodeString=filterConfig.getInitParameter(&quot;encoding&quot;);</span><br><span class="line">&#125;</span><br><span class="line">  //filter 要实现的功能</span><br><span class="line">@Override</span><br><span class="line">public void doFilter(ServletRequest request, ServletResponse response,</span><br><span class="line">    FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">  System.out.println(&quot;begin&quot;);</span><br><span class="line">  // 设置字符集</span><br><span class="line">  request.setCharacterEncoding(encodeString);</span><br><span class="line">  </span><br><span class="line">  //继续向下执行，如果还有其他filter继续调用其他filter，没有的话将消息发送给服务器或客户端</span><br><span class="line">  chain.doFilter(request, response);</span><br><span class="line">  System.out.println(&quot;end&quot;);</span><br><span class="line">&#125;</span><br><span class="line">//Filter注销方法</span><br><span class="line">@Override</span><br><span class="line">public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>2、配置Web.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">    &lt;filter-name&gt;encodeFilter&lt;/filter-name&gt;</span><br><span class="line">    &lt;filter-class&gt;io.github.cmp-cc.filter.encodeFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">    &lt;filter-name&gt;encodeFilter&lt;/filter-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>url-pattern指定匹配模式</p>
</blockquote>
<h3 id="Servlet-监听器"><a href="#Servlet-监听器" class="headerlink" title="Servlet 监听器"></a>Servlet 监听器</h3><h4 id="监听器类型"><a href="#监听器类型" class="headerlink" title="监听器类型"></a>监听器类型</h4><table>
<thead>
<tr>
<th>类型</th>
<th>接口名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>application</td>
<td>ServletContextListener</td>
<td>上下文状态监听器：监听应用容器启动和消亡</td>
</tr>
<tr>
<td>application</td>
<td>ServletContextAttributeListener</td>
<td>上下文属性监听器：监听增删改变换</td>
</tr>
<tr>
<td>session</td>
<td>HttpSessionListener</td>
<td>状态监听器： 监听一次会话（Session）启动和消亡</td>
</tr>
<tr>
<td>session</td>
<td>HttpSessionAttributeListener</td>
<td>Session 属性监听：监听增删改变换</td>
</tr>
<tr>
<td>session</td>
<td>HttpSessionBindingListener</td>
<td>Session 对象绑定监听：Session绑定对象触发和消亡</td>
</tr>
<tr>
<td>request</td>
<td>ServletRequestListener</td>
<td>请求监听器：监听一个请求（Request）启动和消亡</td>
</tr>
<tr>
<td>request</td>
<td>ServletRequestAttributeListener</td>
<td>Request 属性监听：监听增删改变换</td>
</tr>
</tbody>
</table>
<h4 id="监听器的方法"><a href="#监听器的方法" class="headerlink" title="监听器的方法"></a>监听器的方法</h4><h5 id="application-监听"><a href="#application-监听" class="headerlink" title="application 监听"></a>application 监听</h5><p><strong>ServletContextListener </strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>contextInitialized(ServletContextEvent)</td>
<td>容器启动时触发</td>
</tr>
<tr>
<td>contextDestroyed（ServletContextEvent）</td>
<td>容器销毁时触发</td>
</tr>
</tbody>
</table>
<ul>
<li>ServletContextEvent<ul>
<li>getServletContext() 取得ServletContext对象</li>
</ul>
</li>
</ul>
<hr>
<p><strong>ServletContextAttributeListener </strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>attributeAdded（ServletContexArribute）</td>
<td>增加属性触发</td>
</tr>
<tr>
<td>attributeRemoved(ServletContexArribute)</td>
<td>删除属性触发</td>
</tr>
<tr>
<td>attributeReplaced(ServletContexArribute)</td>
<td>替换属性(重复设置)时触发</td>
</tr>
</tbody>
</table>
<ul>
<li>ServletContexArribute <ul>
<li>getName()取得设置属性名称</li>
<li>getValue()取得设置属性内容</li>
</ul>
</li>
</ul>
<hr>
<h5 id="session-监听"><a href="#session-监听" class="headerlink" title="session 监听"></a>session 监听</h5><p><strong>HttpSessionListener</strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>sessionCreated(HttpSessionEvent)</td>
<td>session创建时调用</td>
</tr>
<tr>
<td>sessionDestroyed(HttpSessionEvent)</td>
<td>session销毁时调用</td>
</tr>
</tbody>
</table>
<ul>
<li>HttpSessionAttributeListener<ul>
<li>getsession()取得当前session</li>
</ul>
</li>
</ul>
<hr>
<p><strong>HttpSessionAttributeListener</strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>attributeAdded(HttpSessionBindingEvent)</td>
<td>增加属性触发</td>
</tr>
<tr>
<td>attributeRemoved(HttpSessionBindingEvent)</td>
<td>删除属性触发</td>
</tr>
<tr>
<td>attributeReplaced(HttpSessionBindingEvent)</td>
<td>替换属性时触发</td>
</tr>
</tbody>
</table>
<ul>
<li>HttpSessionBindingListener<ul>
<li>getSession()取得session</li>
<li>getName()取得属性名称</li>
<li>getValue()取得属性的内容</li>
</ul>
</li>
</ul>
<hr>
<p><strong>HttpSessionBindingListener </strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>valueBound(HttpSessionBindingEvent)</td>
<td>绑定对象到session时触发</td>
</tr>
<tr>
<td>valueUnbound(HttpSessionBindingEvent)</td>
<td>从session中移除对象时触发</td>
</tr>
</tbody>
</table>
<hr>
<h5 id="request-监听"><a href="#request-监听" class="headerlink" title="request 监听"></a>request 监听</h5><p><strong>ServletRequestListener</strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>requestInitialized(ServletRequestEvent)</td>
<td>请求开始时调用</td>
</tr>
<tr>
<td>requestDestroyed(ServletRequestEvent)</td>
<td>请求结束时调用</td>
</tr>
</tbody>
</table>
<ul>
<li>ServletRequestEvent<ul>
<li>getServletRequest() 取得ServletRequest对象</li>
<li>getServletContext()取得ServletContext对象</li>
</ul>
</li>
</ul>
<hr>
<p><strong>ServletRequestAttributeListener</strong></p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>attributeAdded(ServletRequestAttributeEvent)</td>
<td>增加属性触发</td>
</tr>
<tr>
<td>attributeRemoved(ServletRequestAttributeEvent)</td>
<td>删除属性触发</td>
</tr>
<tr>
<td>attributeReplaced(ServletRequestAttributeEvent)</td>
<td>替换属性(重复设置)时触发</td>
</tr>
</tbody>
</table>
<ul>
<li>ServletRequestAttributeEvent<ul>
<li>getName()         取得属性名称</li>
<li>getValue()         取得属性的内容</li>
</ul>
</li>
</ul>
<hr>
<h4 id="监听器实例"><a href="#监听器实例" class="headerlink" title="监听器实例"></a>监听器实例</h4><h4 id="web-xml-配置监听器"><a href="#web-xml-配置监听器" class="headerlink" title="web.xml 配置监听器"></a>web.xml 配置监听器</h4><p><strong>如此简单</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;listener&gt;</span><br><span class="line">   &lt;listener-class&gt;io.github.cmp-cc.listener.RquestCountListener&lt;/listener-class&gt;</span><br><span class="line">&lt;/listener&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="EL-表达式"><a href="#EL-表达式" class="headerlink" title="EL 表达式"></a>EL 表达式</h2><p><strong>EL表达式可以理解为是JSP的一部分，把EL表达式单独拎出来，说是因为，它只是提供了一种更加简写操作内置对象的一种方式，就简单的总结一下。</strong></p>
<h3 id="语法结构"><a href="#语法结构" class="headerlink" title="语法结构"></a>语法结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;expression&#125;</span><br></pre></td></tr></table></figure>
<h3 id="与-运算符"><a href="#与-运算符" class="headerlink" title=".与  []  运算符"></a><code>.</code>与  <code>[]</code>  运算符</h3><p>这两个运算符都是用于取值操作，可能你已经习惯如果取值方式,他更符合你的编程习惯。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;sessionScope.user.username&#125;</span><br></pre></td></tr></table></figure></p>
<p>但是，要取值的key 为 $-3，怎么办?  ，你就需要使用<code>[]</code> 运算符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;sessionScope.user[$-3]&#125;</span><br><span class="line"></span><br><span class="line">$&#123;sessionScope.user.$-3&#125;   // 这是会报错的。</span><br></pre></td></tr></table></figure></p>
<p>如果你想忘掉<code>.</code>的方式也是可行的。</p>
<h3 id="EL表达式隐式对象"><a href="#EL表达式隐式对象" class="headerlink" title="EL表达式隐式对象"></a>EL表达式隐式对象</h3><p><strong>EL表达式有十一个隐式对象</strong></p>
<p><strong>四大作用域对象</strong></p>
<table>
<thead>
<tr>
<th>对象名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>pageScope</td>
<td>将页面范围的变量名称映射到其值。</td>
</tr>
<tr>
<td>requestScope</td>
<td>将请求范围的变量名称映射到其值。</td>
</tr>
<tr>
<td>sessionScope</td>
<td>将会话范围的变量名称映射到其值。该对象允许访问会话对象的属性。</td>
</tr>
<tr>
<td>applicationScope</td>
<td>将应用程序范围的变量名称映射到其值。该隐式对象允许访问应用程序范围的对象。</td>
</tr>
</tbody>
</table>
<p><strong>一个上下文对象</strong></p>
<table>
<thead>
<tr>
<th>对象名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>pageContext</td>
<td>javax.servlet.jsp.PageContext对象 将页面范围的变量名称映射到其值。用于访问 JSP 隐式对象，如请求、响应、会话、输出、servletContext</td>
</tr>
</tbody>
</table>
<p><strong>其他六个不同作用的隐式对象</strong></p>
<table>
<thead>
<tr>
<th>对象名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>param</td>
<td>接收传递到本页面的参数</td>
</tr>
<tr>
<td>paramValues</td>
<td>接收传递到本页面的一组参数</td>
</tr>
<tr>
<td>header</td>
<td>取得一个头信息数据</td>
</tr>
<tr>
<td>headerValues</td>
<td>取出一组头信息数据</td>
</tr>
<tr>
<td>cookie</td>
<td>取出cookie中的数据</td>
</tr>
<tr>
<td>initParam</td>
<td>将上下文初始化参数名称映射到单个值</td>
</tr>
</tbody>
</table>
<h3 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h3><table>
<thead>
<tr>
<th>术语</th>
<th>定义</th>
</tr>
</thead>
<tbody>
<tr>
<td>算术</td>
<td>+、- 、*、/、div、%、mod、–</td>
</tr>
<tr>
<td>逻辑</td>
<td>and、&amp;&amp;、or、ll、!、not</td>
</tr>
<tr>
<td>关系</td>
<td>==、eq、!=、ne、lt、gt、&lt;=、le、&gt;=、ge</td>
</tr>
<tr>
<td>空</td>
<td>empty </td>
</tr>
<tr>
<td>三目（条件）</td>
<td>A ?B :C</td>
</tr>
</tbody>
</table>
<h3 id="理解EL表达式的查找属性的顺序"><a href="#理解EL表达式的查找属性的顺序" class="headerlink" title="理解EL表达式的查找属性的顺序"></a>理解EL表达式的查找属性的顺序</h3><p><strong>你可以通过如下进行属性查找：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;username&#125;</span><br></pre></td></tr></table></figure></p>
<p>因为没有指定哪一个范围的username，所以它会依序从Page -&gt; Request -&gt; Session -&gt; Application范围查找,没有找到返回null。</p>
<h3 id="EL-其他"><a href="#EL-其他" class="headerlink" title="EL 其他"></a>EL 其他</h3><ul>
<li><p>接受请求参数</p>
<ul>
<li><p>单个参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;param.red&#125;     等价于      &lt;%=request.getparameter(&quot;red&quot;)%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>一组参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;paramValues.参数名称&#125;</span><br><span class="line">$&#123;paramValues.inst[0]&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>处理集合</p>
<ul>
<li>List   使用<code>${all[0]}</code></li>
<li>Map  使用<code>${all[&quot;key&quot;]}</code></li>
<li>Javabean 使用 <code>${all.名称}</code></li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="cmp-cc" />
          <p class="site-author-name" itemprop="name">cmp-cc</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">21</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cmp-cc" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cmp-cc</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"cmp-cc"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();


  </script>

  
    
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  

 <script type="text/javascript">
  window.onload = function(){setTimeout(function(){/*无登陆账户*/if(!document.getElementsByClassName("ds-account-control")[0]){var cmp_cc_blog_user=localStorage.getItem("cmp-cc_blog_user");var author_name_value = cmp_cc_blog_user?'value="'+cmp_cc_blog_user+'"':'';var i = '<div class="ds-control-group" style="float:right;padding:6px;"><input type="text" '+author_name_value+'id="author_name_proxy" id="ds-dialog-name"  class="custom_input" style="color:#777;width=80%;font-size:13px;border:1px solid #ccc;height:25px;box-shadow: inset 0 1px 1px;padding: 2px 0px 0px 8px;" placeholder="昵称 or 登陆" required></div>';/*展开一个回复，再关闭。 多说没有参数配置啊~ 让人觉得不优雅*/var $last_ds_post_reply = $(".ds-post-reply:last");$last_ds_post_reply.click().click();$(".ds-post-options.ds-gradient-bg").append(i);$(".ds-post-button").click(function(){$(this).submit();$("#ds-wrapper").hide();var author_name = $("#author_name_proxy").val();$("#ds-wrapper #ds-dialog-name").val(author_name);$("#ds-wrapper form").submit();/*www.cmp-cc.github.com*/localStorage.setItem("cmp-cc_blog_user",author_name);$(".custom_input").val(author_name);});}},300);} 
 </script>





  
  
  

  

  
<script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js">
</script>


</body>
</html>
